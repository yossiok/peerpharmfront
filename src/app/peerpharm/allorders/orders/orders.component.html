


<br>
<div class='mainDiv'>
    <!-- <div class='subContainer'>
      <div class='subHeader'>Ordered Last 7-Days</div>
      <div class='subMain'> 17 </div>
      <div class='subHeader'><br></div>
    </div>

    
    <div class='subContainer'>
        <div class='subHeader'>Orders Closed Last Month</div>
        <div class='subMain'> 12 </div>
        <div class='subHeader'><br></div>
    </div>


    <div class='subContainer'>
          <div class='subHeader'>Panding Orders</div>
          <div class='subMain'> 5  </div>
          <div class='subHeader'><br></div>
    </div> -->
    <!-- <button (click)="loadOrders()"  class='btn btn-info waves-effect waves-light' style='height:45px'> Load </button> &nbsp;&nbsp;&nbsp;
    <button (click)="loadOrdersItems()"  class='btn btn-info waves-effect waves-light' style='height:45px'> Show Items </button> -->
</div>
<br><br>
<input matInput class="searchInput" placeholder="Search Costumer By Name" (change)="changeText($event)"/>
<input matInput class="searchInput" placeholder="Search Costumer By Type" (change)="searchByType($event)"/>
 
    <button (click)="loadOrders()"  class='btn btn-info waves-effect waves-light ml-2' style='height:45px; box-shadow: 2px 2px 2px black'> Load </button> 
    <button (click)="loadOrdersItems()"  class='btn btn-info waves-effect waves-light ml-2' style='height:45px; box-shadow: 2px 2px 2px black'> Show Items </button>
  
<div class="stageTags" >
  <div class="stageStyle" style="background-color: white; " >
     חדש:  <span><b>{{stagesCount.new}}</b></span>
  </div>
  <div class="stageStyle" style="background-color: #ffa64d; " >
      רכיבים קיימים- חלקית:  <span><b>{{stagesCount.partialCmpt}}</b></span>
  </div>
  <div class="stageStyle" style="background-color: #ffff80; " >
      כל הרכיבים קיימים:  <span><b>{{stagesCount.allCmpt}}</b></span>
  </div>
  <div class="stageStyle" style="background-color: #b3ecff; " >
      נשלח לייצור:  <span><b>{{stagesCount.production}}</b></span>
  </div>
  <div class="stageStyle" style="background-color: #d9b3ff; " >
      עבר ייצור:  <span><b>{{stagesCount.prodFinish}}</b></span>
  </div>
  <div class="stageStyle" style="background-color: #9ae59a; " >
      הזמנה סגורה:  <span><b>{{stagesCount.done}}</b></span>
  </div>
</div>
  
<table class='table table-fixed'>
  <thead class='tableHeader text-white'  >
    <tr>
      <th style="width:3%;"></th>
      <th style="width:3%;">
          <input type="checkbox" [(ngModel)]="selectAllOrders" (change)="checkboxAllOrders($event)">
      </th>
      <th style="padding:5px">Order Number
        <i class="ti-exchange-vertical" (click)="sortOrdersByOrderNumber()" style="cursor:pointer" ></i>
      </th>
      <th style="width:20%; padding:5px">Costumer <select (change)="filterOrdersByArea($event)">
        <option></option>
        <option value="דרום">דרום</option>
        <option value="מרכז">מרכז</option>
        <option value="השרון">השרון</option>
        <option value="צפון מערבי">צפון מערבי</option>
        <option value="צפון מזרחי">צפון מזרחי</option>
        <option value="ירושלים">ירושלים</option>
      </select></th>
      <th style="padding:5px">Order date</th>
      <th style="padding:5px">Delivery Date</th>
      <th style="width:15%; padding:5px">Remarks</th>
      <th style="padding:5px ; width: 7%">Type</th>
      <th style="padding:5px">Stage
        <i class="ti-exchange-vertical" (click)="sortOrdersByStage()" style="cursor:pointer" ></i>
      </th>
      <th style="padding:5px ; width:11%">User's Order</th>
      <th style="width:4%;"></th>
      <th style="width:5%;"></th>
    </tr>
  </thead>
  <tbody class='table-hover'>  
    <tr  *ngFor="let order of orders; let i = index" style="height:10%;box-shadow: inset 1px -1px 2px 0px black; margin-top: 1px;" [style.background-color]="order.color" (blur)="saveEdit(false, '')" >
    <!-- <tr *ngFor="let order of orders; let i = index" [style.background-color]="order.color" (blur)="saveEdit(false, '')" > -->
          <td style="width:3%;">{{i+1}}</td>
          <td style="width:3%;" (click)="edit('')">
            <input type="checkbox" [(ngModel)]="order.isSelected"  name="orderSelect"> 
          </td>
          <td (click)="edit('')" >
            <a target="_blank"  routerLink='/peerpharm/allorders/orderitems/{{order.orderNumber}}' >
              <!-- <a routerLink="/orderitems/{{order._id}}">-->
              <!--<a  [routerLink]=['orderitems/{{order._id}}']>-->
              {{order.orderNumber}}
    
            </a>
          </td>
          <td style="width:20%;" *ngIf="order._id===EditRowId">
            <input #costumer type='text' [value]="order.costumer" style='width:170px'>
            <input [value]='order._id' #id type='hidden'>
            <input [value]='order.orderNumber' #orderNumber type='hidden'>
          </td>
          <td style="width:20%;" *ngIf="order._id!==EditRowId" (click)="edit(order._id)">{{order.costumer}}</td>
    
          <td *ngIf="order._id===EditRowId">
            <input #orderDate type='text' [value]="order.orderDate" style='width:170px'>
          </td>
          <td *ngIf="order._id!==EditRowId" (click)="edit(order._id)">{{order.orderDate}}</td>
    
          <td *ngIf="order._id===EditRowId">
            <input #deliveryDate type='text' [value]="order.deliveryDate" style='width:170px'>
          </td>
          <td *ngIf="order._id!==EditRowId" (click)="edit(order._id)">{{order.deliveryDate}}</td>

          <td style="width:15%;" *ngIf="order._id===EditRowId">
            <input #orderRemarks type='text' [value]="order.orderRemarks" style='width:170px'>
          </td>
          <td style="width: 15%; height: 100%; overflow-wrap: normal; overflow-y: auto;" 
          *ngIf="order._id!==EditRowId" (click)="edit(order._id)">{{order.orderRemarks}}</td>
    
          <!-- <td *ngIf="order._id===EditRowId">
              <input #orderType type='text' [value]="order.type" style='width:170px'>
            </td> -->
          <td style="width:7%;" *ngIf="order._id!==EditRowId">{{order.type}}</td>
          <td style="width:7%;" *ngIf="order._id===EditRowId">
              <select #orderType type='text' [value]="order.type" style='width:100px'>
                <option value="Make Up">Make Up</option>
                <option value="Cosmetic">Cosmetic</option>
                <option value="Cosmetic & MakeUp">Cosmetic & Make Up</option>
              </select>
            </td>

          <td *ngIf="order._id!==EditRowId" (click)="edit(order._id)"  style="box-shadow: inset 0px 0px 2px 1px black; text-align: center;  height: 100%;" [style.background-color]="order.stageColor">{{order.stage | orderStage}}</td>
          <td *ngIf="order._id===EditRowId">
            <select #stage style="width: 80%" [value]='order.stage' >
              <option value="new">חדש</option>
              <option value="partialCmpt">רכיבים קיימים- חלקית</option>
              <option value="allCmpt">כל הרכיבים קיימים</option>
              <option value="production">נשלח לייצור</option>
              <option value="prodFinish">עבר ייצור</option>
              <option value="done">הזמנה סגורה</option>
            </select>
          </td>

          <td *ngIf="order._id!==EditRowId">{{order.user}}</td>
          <td *ngIf="order._id===EditRowId" style="width:11%">
           
          </td>  
          <td style="width: 4%"></td>
          <td style="width: 5%" > 
            <!--<img *ngIf="order._id!==EditRowId" src='/assets/images/deleteBtn.png' style='width:40px' (click)="deleteOrder(order)">
            <img *ngIf="order._id!==EditRowId" src='/assets/images/aprroved.png' style='width:32px' (click)="saveEdit(true, order._id)">
            <img *ngIf="order._id===EditRowId" src='/assets/images/update2.png' style='width:30px; cursor: pointer' (click)="saveEdit()">-->
            <i class="ti-trash text-danger m-r-10" *ngIf="order._id!==EditRowId"  (click)="deleteOrder(order)" style="cursor:pointer" ></i>&nbsp;
            <i class="ti-check text-success m-r-10" *ngIf="order._id!==EditRowId"  (click)="saveEdit(true, order._id)" style="cursor:pointer" ></i>
            <i class="ti-save text-success m-r-10" *ngIf="order._id===EditRowId"  (click)="saveEdit(false, order._id)" style="cursor:pointer" ></i>
         </td>
    </tr>
  </tbody>
</table>
<ul class="cert-result">
</ul>