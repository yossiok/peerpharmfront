<div class="container-fluid text-center bg-white">
  <div class="row mt-3 p-1">
    <div class="col-2">
      <button (click)="newOrderModal = true" class="btn btn-info">F2 - הזמנה חדשה</button>
    </div>
    <div class="col-2"></div>
    <div class="col-4 bg-white">
      <h1 style="text-shadow: 2px 2px 4px #000000;" class="text-info">Open Orders</h1>
    </div>
    <div class="col-4"></div>
  </div>
  <hr>
  <div class="row mt-4">
    <div class="col-2">
      <button class="form-control border border-dark" style="background-color: white; ">
        חדש: <span><b>{{stagesCount.new}}</b></span>
      </button>
    </div>
    <div class="col-2">
      <button class="form-control border border-dark" style="background-color: #ffa64d; ">
        רכיבים קיימים- חלקית: <span><b>{{stagesCount.partialCmpt}}</b></span>
      </button>
    </div>
    <div class="col-2">
      <button class="form-control border border-dark" style="background-color: #ffff80; ">
        כל הרכיבים קיימים: <span><b>{{stagesCount.allCmpt}}</b></span>
      </button>
    </div>
    <div class="col-2">
      <button class="form-control border border-dark" style="background-color: #b3ecff; ">
        נשלח לייצור: <span><b>{{stagesCount.production}}</b></span>
      </button>
    </div>
    <div class="col-2">
      <button class="form-control border border-dark" style="background-color: #d9b3ff; ">
        עבר ייצור: <span><b>{{stagesCount.prodFinish}}</b></span>
      </button>
    </div>
    <div class="col-2">
      <button class="form-control border border-dark" style="background-color: #9ae59a; ">
        הזמנה סגורה: <span><b>{{stagesCount.done}}</b></span>
      </button>
    </div>
  </div>

  <div class="row mt-4">
    <div class="col-1"></div>
    <div class="col-2"></div>
    <div class="col-2">
      <input matInput class="form-control" placeholder="Search Costumer By Name"
        (change)="changeText($event)" />
    </div>
    <div class="col-2">
      <button (click)="loadOrders()" class='btn btn-info form-control'> Load </button>
    </div>
    <div class="col-2">
      <button (click)="loadOrdersItems()" class='btn btn-info form-control'> Show Items </button>
    </div>
    <div class="col-2"></div>
    <div class="col-1"></div>
    
  </div>

  <div class="row mt-4">
    <table class='table table-hover table-fixed'>
      <thead class='bg-info text-white'>
        <tr style="box-shadow: inset 0px 0px 4px 1px black;">
          <th style="width:3%;"></th>
          <th style="width:3%;">
            <input type="checkbox" [(ngModel)]="selectAllOrders" (change)="checkboxAllOrders($event)">
          </th>
          <th style="padding:5px">Order Number
            <i class="ti-exchange-vertical" (click)="sortOrdersByOrderNumber()" style="cursor:pointer"></i>
          </th>
          <th style="width:18%; padding:5px">Costumer <select style="display: inline-block;" class="form-control w-50" (change)="filterOrdersByArea($event)">
              <option></option>
              <option value="דרום">דרום</option>
              <option value="מרכז">מרכז</option>
              <option value="השרון">השרון</option>
              <option value="צפון מערבי">צפון מערבי</option>
              <option value="צפון מזרחי">צפון מזרחי</option>
              <option value="ירושלים">ירושלים</option>
            </select></th>
          <th style="padding:5px">Order date</th>
          <th style="padding:5px">Delivery Date</th>
          <th style="padding:5px">Customer Order</th>
          <th style="width:12%; padding:5px">Remarks</th>
          <th style="padding:5px ; width: 7%">
            <select style="display: inline-block;" class="form-control w-75"  (change)="searchByType($event)">
              <option value="">Type-All</option>
              <option value="Make Up">Make Up</option>
              <option value="Cosmetic">Cosmetic</option>
              <option value="Cosmetic & MakeUp">Cosmetic & MakeUp</option>
            </select></th>
          <th style="padding:5px">Stage
            <i class="ti-exchange-vertical" (click)="sortOrdersByStage()" style="cursor:pointer"></i>
          </th>
          <th style="padding:5px ; width:11%">User's Order</th>
          <th style="width:4%;"></th>
          <th style="width:5%;"></th>
        </tr>
      </thead>
      <tbody>
        <tr  style="box-shadow: inset 0px 0px 4px 1px black;" *ngFor="let order of orders; let i = index" [style.background-color]="order.color" (blur)="saveEdit(false, '')">
          <!-- <tr *ngFor="let order of orders; let i = index" [style.background-color]="order.color" (blur)="saveEdit(false, '')" > -->
          <td style="width:3%;">{{i+1}}</td>
          <td style="width:3%;" (click)="edit('')">
            <input type="checkbox" [(ngModel)]="order.isSelected" name="orderSelect">
          </td>
          <td (click)="edit('')">
            <a target="_blank" routerLink='/peerpharm/allorders/orderitems/{{order.orderNumber}}'>
              <!-- <a routerLink="/orderitems/{{order._id}}">-->
              <!--<a  [routerLink]=['orderitems/{{order._id}}']>-->
              {{order.orderNumber}}

            </a>
          </td>
          <td style="width:18%;" *ngIf="order._id===EditRowId">
            <input #costumer type='text' [value]="order.costumer" style='width:170px'>
            <input [value]='order._id' #id type='hidden'>
            <input [value]='order.orderNumber' #orderNumber type='hidden'>
          </td>
          <td style="width:18%;" *ngIf="order._id!==EditRowId" (click)="edit(order._id)">{{order.costumer}}</td>

          <td *ngIf="order._id===EditRowId">
            <input #orderDate type='text' [value]="order.orderDate" style='width:170px'>
          </td>
          <td *ngIf="order._id!==EditRowId" (click)="edit(order._id)">{{order.orderDate}}</td>

          <td *ngIf="order._id===EditRowId">
            <input #deliveryDate type='text' [value]="order.deliveryDate" style='width:170px'>
          </td>
          <td *ngIf="order._id!==EditRowId" (click)="edit(order._id)">{{order.deliveryDate}}</td>
          <td *ngIf="order._id!==EditRowId" (click)="edit(order._id)">{{order.customerOrderNum}}</td>
          <td style="width:10%;" *ngIf="order._id===EditRowId">
            <input #customerOrderNum type='text' [value]="order.customerOrderNum" style='width:170px'>
          </td>

          <td style="width:10%;" *ngIf="order._id===EditRowId">
            <input #orderRemarks type='text' [value]="order.orderRemarks" style='width:170px'>
          </td>
          <td style="width: 10%; height: 100%; overflow-wrap: normal; overflow-y: auto;" *ngIf="order._id!==EditRowId"
            (click)="edit(order._id)">{{order.orderRemarks}}</td>

          <!-- <td *ngIf="order._id===EditRowId">
              <input #orderType type='text' [value]="order.type" style='width:170px'>
            </td> -->
          <td style="width:7%;" *ngIf="order._id!==EditRowId">{{order.type}}</td>
          <td style="width:7%;" *ngIf="order._id===EditRowId">
            <select #orderType type='text' [value]="order.type" style='width:100px'>
              <option value="Make Up">Make Up</option>
              <option value="Cosmetic">Cosmetic</option>
              <option value="Cosmetic & MakeUp">Cosmetic & Make Up</option>
            </select>
          </td>

          <td *ngIf="order._id!==EditRowId" (click)="edit(order._id)"
            style="box-shadow: inset 0px 0px 1px 1px black; text-align: center;  height: 100%;"
            [style.background-color]="order.stageColor">{{order.stage | orderStage}}</td>
          <td *ngIf="order._id===EditRowId">
            <select #stage style="width: 80%" [value]='order.stage'>
              <option value="new">חדש</option>
              <option value="partialCmpt">רכיבים קיימים- חלקית</option>
              <option value="allCmpt">כל הרכיבים קיימים</option>
              <option value="production">נשלח לייצור</option>
              <option value="prodFinish">עבר ייצור</option>
              <option value="done">הזמנה סגורה</option>
            </select>
          </td>

          <td *ngIf="order._id!==EditRowId">{{order.user}}</td>
          <td *ngIf="order._id===EditRowId" style="width:11%">

          </td>
          <td style="width: 4%"></td>
          <td style="width: 5%">
            <!--<img *ngIf="order._id!==EditRowId" src='/assets/images/deleteBtn.png' style='width:40px' (click)="deleteOrder(order)">
            <img *ngIf="order._id!==EditRowId" src='/assets/images/aprroved.png' style='width:32px' (click)="saveEdit(true, order._id)">
            <img *ngIf="order._id===EditRowId" src='/assets/images/update2.png' style='width:30px; cursor: pointer' (click)="saveEdit()">-->
            <i class="ti-trash text-danger m-r-10" *ngIf="order._id!==EditRowId" (click)="deleteOrder(order)"
              style="cursor:pointer"></i>&nbsp;
            <i class="ti-check text-success m-r-10" *ngIf="order._id!==EditRowId" (click)="saveEdit(true, order._id)"
              style="cursor:pointer"></i>
            <i class="ti-save text-success m-r-10" *ngIf="order._id===EditRowId" (click)="saveEdit(false, order._id)"
              style="cursor:pointer"></i>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

</div>

<div *ngIf="newOrderModal == true"
    style="z-index: 1;top:150px !important;height: auto;border:2px 2px 2px blue;right:0px !important"
    class="border border-info bg-white container fixed-top mx-auto my-auto text-center">
    <app-neworder></app-neworder>
  </div>
