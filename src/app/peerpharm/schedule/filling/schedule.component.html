<div class="container-fluid text-center bg-white">
  <div class="row fixNoaStupidStuff">
    <div class="col-4 fixNoaStupidStuff">
      <button
        type="button"
        class="btn btn-success"
        printTitle="Filling Schedule"
        [printStyle]="{
          table: { 'border-collapse': 'collapse' },
          th: {
            border: 'solid 1px black',
            'font-size': '1.3rem',
            'font-weight': '700'
          },
          tr: { border: 'solid 2px black' },
          td: {
            border: 'solid 1px black',
            padding: '5px',
            'font-size': '1.2rem',
            'vertical-align': 'top',
            height: '200px'
          },
          '.remarks': { width: '200px' }
        }"
        printSectionId="print-schedule-section"
        ngxPrint
      >
        Print Schedule
      </button>
    </div>
    <div class="col-4 fixNoaStupidStuff">
      <h1 style="text-shadow: 2px 2px 4px #000000" class="text-info">
        Filling Schedule
      </h1>
      <h2>
        {{ today | date: "d/M/yy" }} <span *ngIf="time">{{ time }}</span>
      </h2>
    </div>
    <div class="col-4 fixNoaStupidStuff"></div>
  </div>

  <div class="row fixNoaStupidStuff">
    <div class="col-3"></div>
    <div class="col-1 font-weight-bold">Color index:</div>
    <div class="col-1">
      <div [style.background]="'yellow'" class="color-index pt-2">
        <span class="mt-4 font-weight-bold">Being Filled</span>
      </div>
    </div>
    <div class="col-1">
      <div [style.background]="'#CE90FF'" class="color-index pt-2">
        <span class="mt-4 font-weight-bold">Filled</span>
      </div>
    </div>
    <div class="col-1">
      <div [style.background]="'rgb(255, 114, 114)'" class="color-indexpt-2">
        <span class="mt-4 font-weight-bold">Partial Done</span>
      </div>
    </div>
    <div class="col-1">
      <div [style.background]="'Aquamarine'" class="color-index pt-2">
        <span class="mt-4 font-weight-bold">Done</span>
      </div>
    </div>
    <!-- <div class="col-1">
      <div [style.background]="'orange'" class="color-index pt-2">
        <span class="mt-4 font-weight-bold">Filled and Packed</span>
      </div>
    </div>
    <div class="col-1">
      <div [style.background]="'grey'" class="color-index pt-2">
        <span class="mt-4 font-weight-bold text-white">Missing Ingredients</span>
      </div>
    </div> -->
    <div class="col-1">
      <!-- <div [style.background]="'red'" class="color-index pt-2">
        <span class="mt-4 font-weight-bold"></span>
      </div> -->
    </div>
    <div class="col-2"></div>
  </div>

  <p
    *ngIf="showBatchesAlert"
    class="batchAlert"
    (click)="showBatchesList = true"
  >
    קיימות אצוות שלא משוייכות ללו"ז
  </p>
  <div *ngIf="showBatchesList" class="batchesList">
    <p (click)="showBatchesList = false" class="close">סגירה</p>
    <table class="styled-table">
      <thead>
        <tr>
          <th>#</th>
          <th>מספר אצווה</th>
          <th>מק"ט פריט</th>
          <th>מספר הזמנה</th>
          <th>תאריך ייצור</th>
          <th>תאריך תפוגה</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let batch of unscheduledBatches; index as i">
          <td>{{ i + 1 }}</td>
          <td>
            {{ batch.batchNumber }}
          </td>
          <td>
            <p *ngIf="batch.item && batch.item != ''">{{ batch.item }}</p>
            <p *ngIf="!(batch.item && batch.item != '')">---</p>
          </td>
          <td>
            <p *ngIf="batch.order && batch.order != ''">{{ batch.order }}</p>
            <p *ngIf="!(batch.order && batch.order != '')">---</p>
          </td>
          <td>{{ batch.produced | date: "dd/MM/yyyy" }}</td>
          <td>{{ batch.expration | date: "dd/MM/yyyy" }}</td>
        </tr>
      </tbody>
    </table>
  </div>

  <br />

  <div class="row mt-4 fixNoaStupidStuff">
    <div class="col-2 fixNoaStupidStuff">
      <input
        class="form-control"
        type="date"
        #date
        [(ngModel)]="today"
        (change)="dateChanged(date.value)"
      />
    </div>
    <div class="col-1 fixNoaStupidStuff">
      <button
        class="btn btn-info form-control border border-dark"
        (click)="dateChanged(date.value)"
      >
        Filter
      </button>
    </div>
    <div class="col-2"></div>
    <div class="col-2 fixNoaStupidStuff" *ngIf="scheduleDataCopy">
      <button class="btn btn-warning" (click)="getComponentsQty()">
        Components Report &nbsp;<i class="fas fa-list"></i>
      </button>
    </div>
  </div>

  <div class="row mt-2 fixNoaStupidStuff">
    <div class="col-2 fixNoaStupidStuff">
      <input
        class="form-control"
        type="text"
        placeholder="Search By Order"
        (change)="filterByOrder($event)"
      />
    </div>
    <div class="col-2 fixNoaStupidStuff"></div>
    <div class="col-2 fixNoaStupidStuff">
      <input
        class="form-control"
        type="text"
        placeholder="Search By Item"
        (change)="filterByItem($event)"
      />
    </div>
    <div class="col-2 fixNoaStupidStuff"></div>
    <div class="col-2 fixNoaStupidStuff">
      <input
        class="form-control"
        type="text"
        placeholder="Search By Line"
        (change)="filterByLine($event)"
      />
    </div>
    <div class="col-2 fixNoaStupidStuff">
      <img
        src="../../../../assets/images/excel.png"
        alt="export to excel"
        style="width: 40px"
        (click)="exportAsXLSX()"
      />
    </div>
  </div>

  <div class="row mt-4 fixNoaStupidStuff">
    <div class="col-1 fixNoaStupidStuff"></div>

    <div class="col-1 fixNoaStupidStuff">
      <div
        class="rounded"
        style="color: black; box-shadow: inset 0px 0px 4px 1px"
        (click)="setType('basic', this)"
        [ngStyle]="{ 'background-color': buttonColor }"
      >
        General
      </div>
    </div>

    <div class="col-1 fixNoaStupidStuff">
      <div
        style="color: black; box-shadow: inset 0px 0px 4px 1px"
        (click)="setType('tube', this)"
        [ngStyle]="{ 'background-color': buttonColor2 }"
      >
        Tubes
      </div>
    </div>

    <div class="col-1 fixNoaStupidStuff">
      <div
        style="color: black; box-shadow: inset 0px 0px 4px 1px"
        (click)="setType('mkp', this)"
        [ngStyle]="{ 'background-color': buttonColor3 }"
      >
        Make Up
      </div>
    </div>

    <div class="col-1 fixNoaStupidStuff">
      <div
        style="color: black; box-shadow: inset 0px 0px 4px 1px"
        (click)="setType('sachet', this)"
        [ngStyle]="{ 'background-color': buttonColor4 }"
      >
        Sachet
      </div>
    </div>

    <div class="col-1 fixNoaStupidStuff">
      <div
        style="color: black; box-shadow: inset 0px 0px 4px 1px"
        (click)="setType('laser', this)"
        [ngStyle]="{ 'background-color': buttonColor5 }"
      >
        Laser
      </div>
    </div>

    <div class="col-1 fixNoaStupidStuff">
      <div
        style="color: black; box-shadow: inset 0px 0px 4px 1px"
        (click)="setType('stickers', this)"
        [ngStyle]="{ 'background-color': buttonColor6 }"
      >
        Stickers
      </div>
    </div>

    <div class="col-1 fixNoaStupidStuff">
      <div
        style="color: black; box-shadow: inset 0px 0px 4px 1px"
        (click)="setType('mkp2', this)"
        [ngStyle]="{ 'background-color': buttonColor8 }"
      >
        Make Up2
      </div>
    </div>

    <div class="col-1 fixNoaStupidStuff">
      <div
        style="color: black; box-shadow: inset 0px 0px 4px 1px"
        (click)="setType('packaging', this)"
        [ngStyle]="{ 'background-color': buttonColor9 }"
      >
        Packaging
      </div>
    </div>

    <div class="col-1 fixNoaStupidStuff">
      <div
        style="color: black; box-shadow: inset 0px 0px 4px 1px"
        (click)="setType('cream', this)"
        [ngStyle]="{ 'background-color': buttonColor10 }"
      >
        Cream Production
      </div>
    </div>

    <div class="col-1 fixNoaStupidStuff"></div>
    <div class="col-1 fixNoaStupidStuff">
      <div
        style="color: black; box-shadow: inset 0px 0px 4px 1px"
        (click)="setType('unpacked', this)"
        [ngStyle]="{ 'background-color': buttonColor7 }"
      >
        UnPacked
      </div>
    </div>
  </div>

  <div class="row fixNoaStupidStuff">
    <div class="col-12 fixNoaStupidStuff">
      <table class="table table-striped table-hover">
        <thead
          style="box-shadow: inset 0px 0px 4px 1px black"
          class="bg-info text-white"
        >
          <tr>
            <th>
              <input (change)="selectAll()" type="checkbox" />
              <label> בחר הכל</label><br />
            </th>
            <th class="hideInTablet">
              <img
                (click)="makeFillingReport()"
                style="width: 50px"
                src="../../../../assets/images/stockUpdate.png"
              />
            </th>
            <th class="positionClass"><b>P</b></th>
            <!--1-->
            <th><b>Order</b></th>
            <!--2-->
            <th style="width: 10%"><b>Item</b></th>
            <!--3-->
            <th><b>Item Important Remark</b></th>
            <!--4-->
            <th><b>Customer</b></th>
            <!--5-->
            <th><b>Name of product</b></th>
            <!--6-->
            <th><b>Batch number</b></th>
            <!--7-->
            <th><b>Package</b></th>
            <!--8-->
            <th><b>Qty</b></th>
            <!--9-->
            <th><b>Remarks</b></th>
            <!--10-->
            <th><b>Date</b></th>
            <!--11-->
            <th class="mkpClass printlessTd"><b>shift</b></th>
            <!--12-->
            <th><input class="mkpClassInput form-control" value="MKP" /></th>
            <th></th>
            <th></th>
            <th class="hideInTablet"></th>
            <th class="hideInTablet">
              <img
                src="assets/images/24p.png"
                style="width: 55px; cursor: pointer"
                alt="Random second slide"
                (click)="moveAllOpenScedToToday()"
              />
            </th>
          </tr>
        </thead>

        <tr class="bg-white hideInTablet" id="inputTr" (click)="EditRowId = 0">
          <td></td>
          <td></td>
          <td class="positionClass">
            <input
              type="text"
              id="input_position"
              placeholder="Position"
              [(ngModel)]="scheduleLine.positionN"
              class="form-control"
            />
          </td>
          <td>
            <input
              type="number"
              id="input_order"
              placeholder="Order No."
              [(ngModel)]="scheduleLine.orderN"
              #orderN
              (focusout)="setOrderDetails(orderN.value)"
              class="form-control"
            />
          </td>
          <td>
            <input
              type="number"
              id="input_item"
              placeholder="Item No."
              [(ngModel)]="scheduleLine.item"
              #itemN
              (focusout)="setItemDetails(itemN.value)"
              class="form-control"
            />
          </td>
          <td>
            <input
              type="text"
              id="input_itemImpRemark"
              placeholder="remark"
              class="form-control"
              [(ngModel)]="scheduleLine.itemImpRemark"
              disabled
            />
          </td>
          <td>
            <input
              type="text"
              id="input_costumer"
              placeholder="Customer"
              [(ngModel)]="scheduleLine.costumer"
              class="form-control"
            />
          </td>
          <td>
            <input
              type="text"
              id="input_productName"
              placeholder="Name"
              class="form-control"
              [(ngModel)]="scheduleLine.productName"
            />
          </td>
          <td>
            <input
              type="text"
              id="input_batchN"
              placeholder="Batch No."
              [(ngModel)]="scheduleLine.batch"
              class="form-control"
            />
          </td>
          <td>
            <textarea
              rows="1"
              cols="20"
              id="input_package"
              placeholder="Package"
              [(ngModel)]="scheduleLine.packageP"
              class="form-control"
            ></textarea>
          </td>
          <td>
            <input
              type="number"
              id="input_Qty"
              placeholder="Quantity"
              [(ngModel)]="scheduleLine.qty"
              class="form-control"
            />
          </td>
          <td>
            <textarea
              rows="1"
              cols="30"
              id="input_marks"
              placeholder="remarks"
              [(ngModel)]="scheduleLine.marks"
              class="form-control"
            ></textarea>
          </td>
          <td>
            <input
              type="date"
              id="input_Date"
              placeholder="date"
              [(ngModel)]="scheduleLine.date"
              class="form-control"
            />
          </td>
          <td class="printlessTd">
            <select
              class="form-control"
              class="selectShiftClass"
              id="select_shift"
              [(ngModel)]="scheduleLine.shift"
            >
              <option value="Day">Day</option>
              <option value="Night">Night</option>
            </select>
          </td>
          <td class="printlessTd mkpClass">
            <input
              type="radio"
              name="type"
              value="basic"
              checked="checked"
              [(ngModel)]="scheduleLine.mkp"
            />Basic<br />
            <input
              type="radio"
              name="type"
              value="tube"
              [(ngModel)]="scheduleLine.mkp"
            />Tube<br />
            <input
              type="radio"
              name="type"
              value="mkp"
              [(ngModel)]="scheduleLine.mkp"
            />Mkp<br />
          </td>
          <td>
            <input
              type="radio"
              name="type"
              value="sachet"
              [(ngModel)]="scheduleLine.mkp"
            />Sachet<br />
            <input
              type="radio"
              name="type"
              value="laser"
              [(ngModel)]="scheduleLine.mkp"
            />Laser<br />
            <input
              type="radio"
              name="type"
              value="stickers"
              [(ngModel)]="scheduleLine.mkp"
            />Stickers<br />
          </td>
          <td>
            <input
              type="radio"
              name="type"
              value="mkp2"
              [(ngModel)]="scheduleLine.mkp"
            />MKP 2<br />
            <input
              type="radio"
              name="type"
              value="packaging"
              [(ngModel)]="scheduleLine.mkp"
            />Packaging<br />
            <input
              type="radio"
              name="type"
              value="cream"
              [(ngModel)]="scheduleLine.mkp"
            />Cream <br />
          </td>
          <td class="printlessTd"></td>
          <td class="printlessTd">
            <button
              [class.read-only]="checkPermission()"
              class="btn btn-info form-control border border-dark"
              (click)="writeScheduleData()"
            >
              Add</button
            ><br />
          </td>
        </tr>

        <tbody id="table_body">
          <tr
            style="box-shadow: inset 0px 0px 4px 1px black"
            *ngFor="let line of scheduleData"
            [style.background-color]="line.color"
          >
            <ng-container *ngIf="line !== undefined && line.mkp === typeShown">
              <td class="hideInTablet">
                <input
                  name="selectLine"
                  class="form-control"
                  type="checkbox"
                  (change)="isSelected($event, line)"
                />
              </td>
              <td></td>

              <td
                class="positionClass"
                *ngIf="line._id !== EditRowId"
                (click)="edit(line._id, line.mkp)"
              >
                {{ line.positionN }}
              </td>
              <td *ngIf="line._id === EditRowId">
                <input
                  #position
                  type="text"
                  [value]="line.positionN"
                  class="form-control"
                /><input #id type="hidden" [value]="line._id" />
              </td>
              <td
                *ngIf="line._id !== EditRowId"
                (click)="edit(line._id, line.mkp)"
              >
                <a
                  target="_blank"
                  routerLink="/peerpharm/allorders/orderitems/{{ line.orderN }}"
                >
                  {{ line.orderN }}
                </a>
              </td>
              <td *ngIf="line._id === EditRowId">
                <input
                  #orderNum
                  type="text"
                  [value]="line.orderN"
                  class="form-control"
                />
              </td>
              <td
                *ngIf="line._id !== EditRowId"
                (click)="edit(line._id, line.mkp)"
              >
                <a
                  target="_blank"
                  routerLink="/peerpharm/items/itemDetails/{{ line.item }}"
                >
                  {{ line.item }} </a
                ><br />
                components:
                <ul class="list">
                  <li *ngFor="let component of line.components">
                    {{ component.componentN }} - {{ component.type }}
                  </li>
                </ul>
              </td>
              <td *ngIf="line._id === EditRowId">
                <input
                  #item
                  type="text"
                  [value]="line.item"
                  class="form-control"
                />
              </td>

              <td
                *ngIf="line._id !== EditRowId"
                (click)="edit(line._id, line.mkp)"
                style="color: red; max-width: 12%; overflow-wrap: break-word"
              >
                {{ line.itemImpRemark }}
              </td>
              <td *ngIf="line._id === EditRowId">
                <input
                  #item
                  type="text"
                  [value]="line.itemImpRemark"
                  class="form-control"
                  style="color: red"
                  disabled
                />
              </td>

              <td
                *ngIf="line._id !== EditRowId"
                (click)="edit(line._id, line.mkp)"
              >
                {{ line.costumer | slice: 0:30 }}
              </td>
              <td *ngIf="line._id === EditRowId">
                <input
                  #costumer
                  type="text"
                  [value]="line.costumer"
                  class="form-control"
                />
              </td>
              <td
                *ngIf="line._id !== EditRowId"
                (click)="edit(line._id, line.mkp)"
              >
                {{ line.productName }}
              </td>
              <td *ngIf="line._id === EditRowId">
                <input
                  #productName
                  type="text"
                  [value]="line.productName"
                  class="form-control"
                />
              </td>
              <td
                *ngIf="line._id !== EditRowId"
                (click)="edit(line._id, line.mkp)"
              >
                <textarea
                  disabled
                  style="
                    height: 113px;
                    width: 84px;
                    box-shadow: none !important;
                  "
                  rows="2"
                  cols="10"
                >
 {{ line.batch }} </textarea
                >
              </td>
              <td *ngIf="line._id === EditRowId">
                <input
                  #batch
                  type="text"
                  [value]="line.batch"
                  class="form-control"
                />
              </td>
              <td
                *ngIf="line._id !== EditRowId"
                (click)="edit(line._id, line.mkp)"
              >
                {{ line.packageP | slice: 0:20 }}
              </td>
              <td *ngIf="line._id === EditRowId">
                <input
                  style="width: 100px"
                  #packageP
                  type="text"
                  [value]="line.packageP"
                />
              </td>
              <!-- <td *ngIf="line._id === EditRowId">
                <textarea
                  rows="1"
                  cols="30"
                  id="input_marks"
                  #packageP
                  [value]="line.packageP"
                  class="form-control"
                ></textarea>
              </td> -->
              <td
                *ngIf="line._id !== EditRowId"
                (click)="edit(line._id, line.mkp)"
              >
                {{ line.qtyProduced }} / {{ line.qty }}
              </td>
              <td *ngIf="line._id === EditRowId">
                <input
                  #qty
                  type="text"
                  [value]="line.qty"
                  class="form-control"
                />
              </td>

              <td
                *ngIf="line._id !== EditRowId"
                (click)="edit(line._id, line.mkp)"
              >
                {{ line.marks }}
              </td>
              <td *ngIf="line._id === EditRowId">
                <textarea
                  rows="1"
                  cols="30"
                  #marks
                  type="text"
                  [value]="line.marks"
                  class="form-control"
                ></textarea>
              </td>

              <td
                *ngIf="line._id !== EditRowId"
                (click)="edit(line._id, line.mkp)"
              >
                {{ line.date | date: "dd/MM/yyyy" }}
              </td>
              <td *ngIf="line._id === EditRowId">
                <input
                  #aaaa
                  type="date"
                  [value]="line.date3"
                  class="form-control"
                />
              </td>
              <td
                *ngIf="line._id !== EditRowId"
                (click)="edit(line._id, line.mkp)"
              >
                {{ line.shift }}
              </td>
              <td *ngIf="line._id === EditRowId">
                <input
                  #shiftA
                  type="text"
                  [value]="line.shift"
                  class="form-control"
                />
                <form>
                  <div class="multiselect">
                    <div class="selectBox" (click)="showCheckboxes()">
                      בחר הערות ושפות
                      <div id="checkboxes2">
                        <label class="lang" for="heb"
                          ><input
                            type="checkbox"
                            id="heb"
                            (change)="addLangues('heb')"
                          />עברית</label
                        >
                        <label class="lang" for="eng"
                          ><input
                            type="checkbox"
                            id="eng"
                            (change)="addLangues('eng')"
                          />אנגלית</label
                        >
                        <label class="lang" for="arab"
                          ><input
                            type="checkbox"
                            id="arab"
                            (change)="addLangues('arab')"
                          />ערבית</label
                        >
                        <label class="lang" for="rus"
                          ><input
                            type="checkbox"
                            id="rus"
                            (change)="addLangues('rus')"
                          />רוסית</label
                        >
                      </div>
                    </div>
                    <div id="checkboxes">
                      <label
                        *ngFor="let remark of remarks; index as i"
                        for="remark._id"
                        ><input
                          type="checkbox"
                          id="remark._id"
                          (change)="addRemarks(remark._id)"
                        />{{ remark.heb }}</label
                      >
                    </div>
                  </div>
                </form>
              </td>
              <td
                class="mkpClass"
                *ngIf="line._id !== EditRowId"
                (click)="edit(line._id, line.mkp)"
              >
                {{ line.mkp }}
              </td>
              <!-- <td *ngIf="line._id === EditRowId">
                <input #mkp type="text" [value]="line.mkp" class="form-control" />
              </td> -->
              <td *ngIf="line._id === EditRowId">
                <input
                  type="radio"
                  name="typeEdit"
                  #mkpA
                  value="basic"
                  [checked]="line.mkp === 'basic'"
                  (change)="handleChange('basic')"
                />Basic<br />
                <input
                  type="radio"
                  name="typeEdit"
                  #mkpA
                  value="tube"
                  [checked]="line.mkp === 'tube'"
                  (change)="handleChange('tube')"
                />Tube<br />
                <input
                  type="radio"
                  name="typeEdit"
                  #mkpA
                  value="mkp"
                  [checked]="line.mkp === 'mkp'"
                  (change)="handleChange('mkp')"
                />Mkp<br />
                <input
                  type="radio"
                  name="typeEdit"
                  #mkpA
                  value="sachet"
                  [checked]="line.mkp === 'sachet'"
                  (change)="handleChange('sachet')"
                />Sachet<br />
                <input
                  type="radio"
                  name="typeEdit"
                  #mkpA
                  value="laser"
                  [checked]="line.mkp === 'laser'"
                  (change)="handleChange('laser')"
                />Laser<br />
                <input
                  type="radio"
                  name="typeEdit"
                  #mkpA
                  value="stickers"
                  [checked]="line.mkp === 'stickers'"
                  (change)="handleChange('stickers')"
                />Stickers<br />
                <input
                  type="radio"
                  name="typeEdit"
                  #mkpA
                  value="mkp2"
                  [checked]="line.mkp === 'mkp2'"
                  (change)="handleChange('mkp2')"
                />Mkp2<br />
                <input
                  type="radio"
                  name="typeEdit"
                  #mkpA
                  value="unpacked"
                  [checked]="line.mkp === 'unpacked'"
                  (change)="handleChange('unpacked')"
                />Unpacked<br />
                <input
                  type="radio"
                  name="typeEdit"
                  #mkpA
                  value="packaging"
                  [checked]="line.mkp === 'packaging'"
                  (change)="handleChange('packaging')"
                />Packaging<br />
              </td>
              <td
                [class.read-only]="checkPermission()"
                *ngIf="line._id !== EditRowId"
              >
                <img
                  src="assets/images/an.png"
                  *ngIf="
                    line.cmptsStatus != null &&
                    line.cmptsStatus.includes('false')
                  "
                  (click)="dismissInfo(line._id)"
                  style="width: 20px"
                />
                <i
                  class="ti-trash text-danger m-r-10"
                  [class.read-only]="checkPermission()"
                  (click)="deleteLine(line._id)"
                ></i
                >&nbsp; <br />
                <p
                  id="deleteReason"
                  style="text-align: right; display: none"
                ></p>
                <!-- <i class="ti-check text-success m-r-10" (click)="setDone()"></i> -->
              </td>

              <td *ngIf="line._id !== EditRowId">
                {{ line.whatIsMissing }}
              </td>
              <td *ngIf="line._id === EditRowId">
                <select
                  class="form-control"
                  #whatIsMissing
                  type="text"
                  [value]="line.whatIsMissing"
                >
                  <option selected="true" disabled="disabled">
                    בחר חוסרים
                  </option>
                  <option value="noStickers">חסר מדבקות</option>
                  <option value="noMaterial">חסר חומר</option>
                  <option value="noComponent">חסר קומפונטט</option>
                  <option value="noLacks">אין חוסרים</option>
                </select>
              </td>
              <td class="showInTablet">
                <button
                  *ngIf="line.status == 'open'"
                  (click)="openFormDetails(line._id)"
                  class="btn btn-success"
                >
                  <b>טופס חדש</b>
                </button>
                <button
                  *ngIf="line.status != 'open'"
                  (click)="openFormDetails(line._id)"
                  class="btn btn-warning"
                >
                  <b>כניסה לטופס</b>
                </button>
              </td>
              <td class="hideInTablet">
                <div *ngIf="line.batchSpecStatus == 1" class="qc-batch">
                  <strong>Q.C BATCH</strong>
                </div>
                <div
                  (click)="checkBatchesSpec(line.batch)"
                  *ngIf="line.batchSpecStatus == 999"
                  class="qc-check"
                >
                  <strong>Check Batches!</strong>
                </div>
              </td>
              <td class="hideInTablet">
                <button
                  *ngIf="line._id !== EditRowId"
                  id="print_barcode_btn"
                  class="btn btn-info m-r-10 border border-dark"
                  type="button"
                  (click)="openPrintBarkod(content, line)"
                  [disabled]="openingPrintModal"
                  [style.cursor]="openingPrintModal ? 'not-allowed' : 'pointer'"
                >
                  Print Barcode
                </button>
                <i
                  *ngIf="
                    typeShown === 'mkp2' ||
                    typeShown === 'packaging' ||
                    typeShown === 'unpacked'
                  "
                  [class.read-only]="checkPermission()"
                  (click)="markScheduleDone(line._id)"
                  class="fa fa-check"
                ></i>
              </td>
              <td class="hideInTablet" *ngIf="line._id === EditRowId">
                <i
                  class="ti-save text-info m-r-10 click"
                  [class.read-only]="checkPermission()"
                  (click)="updateSchedule(line)"
                ></i>
                <p id="editReason" style="display: none"></p>
              </td>
            </ng-container>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

<ng-template #content let-c="close" let-d="dismiss">
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">Print Barkod</h4>
    <button
      type="button"
      class="close"
      aria-label="Close"
      (click)="c('Cross click')"
    >
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div *ngIf="!showPrintBtn" class="smallLoader p-5"></div>
  <div *ngIf="showPrintBtn" class="modal-body">
    <form
      class="form"
      [formGroup]="printScheduleFillingForm"
      (submit)="onSubmit()"
    >
      <div class="form-group row">
        <label for="orderNumber">Order Number:</label>
        <input class="form-control" type="text" formControlName="orderN" />
      </div>

      <div *ngIf="printItemBarcode == true" class="form-group row">
        <label for="itemNumber">Item Number:</label>
        <input
          class="form-control"
          type="text"
          formControlName="item"
          disabled
        />
        <button (click)="printItemBarcode = false" class="btn-success">
          Remove
        </button>
      </div>

      <div *ngIf="printCostumerBarcode == true" class="form-group row">
        <label>Customer</label>
        <input class="form-control" type="text" formControlName="costumer" />
        <button (click)="printCostumerBarcode = false" class="btn-success">
          Remove
        </button>
      </div>

      <div *ngIf="printExpBarcode == true" class="form-group row">
        <label>Exp</label>
        <input class="form-control" type="text" formControlName="exp" />
        <button (click)="printExpBarcode = false" class="btn-success">
          Remove
        </button>
      </div>

      <div class="form-group row">
        <label for="batchNumber">Batch Number</label>
        <input class="form-control" type="text" formControlName="batch" />
      </div>

      <div class="form-group row">
        <label>Pcs Carton</label>
        <input
          #pcsCartonQuantity
          class="form-control"
          type="text"
          formControlName="pcsCarton"
        />
      </div>

      <div class="form-group row">
        <label>Barcode</label>
        <input class="form-control" type="text" formControlName="barcodeK" />
      </div>
    </form>
  </div>

  <div *ngIf="showPrintBtn" class="modal-footer">
    <button
      type="button"
      class="btn btn-success"
      printSectionId="print-section"
      ngxPrint
      (click)="c('Saved')"
    >
      Print
    </button>
  </div>
</ng-template>

<div style="visibility: hidden" id="print-section">
  <table
    style="text-align: center"
    class="barcodeTbl"
    dir="ltr"
    [style.margin.px]="3"
    [style.width.px]="400"
    [style.max-height.px]="400"
    [style.font-size.px]="24"
    [style.border.px]="0"
  >
    <tr>
      <td>
        {{ printScheduleFillingForm.value.productName }}
      </td>
    </tr>
    <tr *ngIf="printItemBarcode == true">
      <td>Item Number: {{ printScheduleFillingForm.value.item }}</td>
    </tr>
    <tr>
      <td>
        {{ printScheduleFillingForm.value.volumeK }}
        {{ printScheduleFillingForm.value.pcsCarton }}
      </td>
    </tr>
    <tr>
      <td *ngIf="newBatchChange == false">
        {{ printScheduleFillingForm.value.batch }}
        <label *ngIf="printExpBarcode == true"
          >Exp: {{ printScheduleFillingForm.value.exp }}</label
        >
      </td>
      <td *ngIf="newBatchChange == true">
        {{ newBatch }}
        <label *ngIf="printExpBarcode == true">Exp: {{ expireDate }}</label>
      </td>
    </tr>
    <tr>
      <td>
        <ngx-barcode
          [bc-value]="printScheduleFillingForm.value.barcodeK"
          [bc-display-value]="true"
        ></ngx-barcode>
      </td>
    </tr>
    <tr *ngIf="printCostumerBarcode == true">
      <td>
        {{ printScheduleFillingForm.value.costumer }}
      </td>
    </tr>
  </table>
</div>

<div *ngIf="fillingReport == true" id="print-sectionReport">
  <div
    *ngIf="fillingReport == true"
    id="myModal3"
    class="modal3"
    style="
      border: 1px;
      border-radius: 5px;
      z-index: 1;
      position: absolute;
      left: 80px;
      top: 100px;
      width: max-content;
    "
  >
    <div class="modal-content" id="modelC">
      <div
        style="display: inline-block"
        id="material-header"
        class="modal-header"
      >
        <div class="row">
          <div class="col-5">
            <button
              style="border: none; background: none; font-size: 30px"
              [useExistingCss]="true"
              ngxPrint
              printSectionId="print-sectionReport"
            >
              דו"ח לו"ז
            </button>
          </div>
          <div class="col-6"></div>
          <div class="col-1">
            <span class="close" id="closeId3" (click)="fillingReport = false"
              >&times;</span
            >
          </div>
        </div>
      </div>

      <div class="container" id="material-body" class="modal-body">
        <div class="row">
          <div class="col-12">
            <ul
              style="
                list-style-type: none;
                font-size: 25px;
                border: 1px solid black;
              "
              *ngFor="let item of selectedArr"
            >
              <li><input type="checkbox" /> Line: {{ item.positionN }}</li>
              <li><input type="checkbox" /> Item: {{ item.item }}</li>
              <li>
                <input type="checkbox" /> Item Name: {{ item.productName }}
              </li>
              <li *ngIf="item.imgMain1">
                Item Image: <img [src]="item.imgMain1" style="width: 100px" />
              </li>
              <li *ngIf="item.imgMain2">
                Item Image2: <img [src]="item.imgMain2" style="width: 100px" />
              </li>
              <br /><br />
              <li><input type="checkbox" /> Barcode: {{ item.barcodeK }}</li>
              <li><input type="checkbox" /> batch: {{ item.batch }}</li>
              <li><input type="checkbox" /> Qty: {{ item.qty }}</li>
              <li><input type="checkbox" /> remarks: {{ item.marks }}</li>
              <li>
                <input type="checkbox" /> Item Tree Remarks:
                {{ item.proRemarks }}
              </li>
              <li>
                <input type="checkbox" /> Item Jumping Remarks:
                {{ item.impRemarks }}
              </li>
              <li>
                <input type="checkbox" /> Sticker Number:
                {{ item.stickerNumber }} Type: {{ item.stickerTypeK }}
              </li>
              <li>
                <input type="checkbox" /> Carton Number: {{ item.cartonNumber }}
              </li>
              <li>
                <input type="checkbox" /> Units In Carton: {{ item.PcsCarton }}
              </li>
              <br /><br />
              <li>
                <input type="checkbox" /> Box Number: {{ item.boxNumber }} Type:
                {{ item.boxTypeK }}
              </li>
              <li>
                Box Image: <img [src]="item.boxImage" style="width: 100px" />
              </li>
              <li>
                <input type="checkbox" /> Bottle Number:
                {{ item.bottleNumber }} , Position: {{ item.bottlePosition }}
              </li>
              <li>
                Bottle Image:
                <img [src]="item.bottleImage" style="width: 100px" />
              </li>
              <li>
                <input type="checkbox" /> Cap Number: {{ item.capNumber }} ,
                Position: {{ item.capPosition }}
              </li>
              <li>
                Cap Image: <img [src]="item.capImage" style="width: 100px" />
              </li>
              <li>
                <input type="checkbox" /> Seal Number: {{ item.sealNumber }} ,
                Position: {{ item.sealPosition }}
              </li>
              <li>
                <input type="checkbox" /> Seal Image:
                <img [src]="item.sealImage" style="width: 100px" />
              </li>
              <li>
                <input type="checkbox" /> Pump Number: {{ item.pumpNumber }} ,
                Position: {{ item.pumpPosition }}
              </li>
              <li>
                Pump Image: <img [src]="item.pumpImage" style="width: 100px" />
              </li>
            </ul>
          </div>
        </div>
        <div class="row">
          <div *ngFor="let item of selectedArr" class="col-12">
            {{ item.scheduleRemark }}
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<ng-template #batchSpecStatus let-c="close" let-d="dismiss">
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">
      Batches Specification Status
    </h4>
    <!--<button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">-->
    <button
      type="button"
      class="close"
      aria-label="Close"
      (click)="c('Cross click')"
    >
      <!--  <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">-->
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <table>
      <thead>
        <th>Batch</th>
        <th>Spec Status</th>
      </thead>
      <tbody>
        <tr *ngFor="let line of batchesSpecifications">
          <td>{{ line.batch }}</td>
          <td>{{ line.batchSpec }}</td>
        </tr>
      </tbody>
    </table>
  </div>
  <div>
    <h4>Specification Status:</h4>
    <br />
    <h5>1 = Approved</h5>
    <br />
    <h5>0 = Not Approved</h5>
    <br />
    <h5>2 = On Hold</h5>
    <br />
    <h5>-1 = Not Checked</h5>
  </div>
</ng-template>

<!-- Printing area not displayed -->

<div class="row" id="print-schedule-section">
  <table>
    <thead>
      <tr>
        <th colspan="11" *ngIf="fillingDate && fillingDate != ''">
          <b
            >Filling Schedule Date:
            {{ this.fillingDate | date: "dd/MM/yyyy" }}
            {{ this.myDate | date: "hh:mm" }}
          </b>
        </th>
      </tr>
      <tr>
        <th><b>P</b></th>
        <th><b>Order</b></th>
        <th><b>Item</b></th>
        <th><b>Item Important Remark</b></th>
        <th><b>Customer</b></th>
        <th><b>Name of product</b></th>
        <th><b>Batch number</b></th>
        <th><b>Package</b></th>
        <th><b>Qty</b></th>
        <th class="remarks"><b>Order Remarks </b></th>
        <th class="remarks">Schedule remark</th>
      </tr>
    </thead>

    <tbody>
      <tr
        *ngFor="let line of scheduleData"
        [style.background-color]="line.color"
      >
        <ng-container *ngIf="line !== undefined && line.mkp === typeShown">
          <td>
            {{ line.positionN }}
          </td>
          <td>
            {{ line.orderN }}
          </td>
          <td>
            {{ line.item }}
            components:
            <ul style="font-size: 15px; list-style-position: outside">
              <li
                style="list-style-type: square; margin: 0; padding: 0"
                *ngFor="let component of line.components"
              >
                {{ component.componentN }}-{{ component.type }}
              </li>
            </ul>
          </td>
          <td>
            {{ line.itemImpRemark }}
          </td>
          <td>
            {{ line.costumer | slice: 0:30 }}
          </td>
          <td>
            {{ line.productName }}
          </td>
          <td>
            {{ line.batch }}
          </td>
          <td>
            {{ line.packageP | slice: 0:20 }}
          </td>
          <td>
            <span *ngIf="line.qtyProduced">{{ line.qtyProduced }}/</span
            >{{ line.qty }}
          </td>
          <td>
            {{ line.marks }}
          </td>
          <td>
            {{ line.shift }}
          </td>
        </ng-container>
      </tr>
    </tbody>
  </table>
</div>
<div *ngIf="sameLineAlert" class="alert">
  <span dir="rtl" class="closebtn">&times;</span>
  <i class="fa fa-times" (click)="sameLineAlert = false"></i>
  <strong>הערה חשובה:</strong> שים לב: קיימת שורה עם אותם נתונים
</div>

<div
  *ngIf="componentsQtyReport == true"
  class="border border-primary text-info bg-light shadow-lg fixed-top mx-auto p-1 w-75 h-75"
  style="overflow: scroll"
>
  <div class="row mt-2 w-100" dir="rtl">
    <div class="col-1">
      <button class="btn outline-primary">
        <i (click)="componentsQtyReport = false" class="click fa fa-times"></i>
      </button>
    </div>
    <div class="col-8 text-center">
      <h1>דו"ח רכיבים נדרשים ללו"ז - {{ today | date: "dd/MM/yyyy" }}</h1>
    </div>
    <div class="col-1"></div>
  </div>
  <form [formGroup]="searchMenu">
    <div class="row w-100">
      <div class="col-1">
        <p class="font-roboto text-center text-dark">Filters:</p>
      </div>
      <div class="col-2">
        <input
          class="form-control"
          type="text"
          formControlName="componentN"
          placeholder="Component"
          (keyup)="filterByComponent()"
        />
      </div>
      <div class="col-1">
        <select
          name=""
          id=""
          class="form-control"
          formControlName="type"
          (change)="filterByType()"
        >
          <option value="" selected>All</option>
          <option value="bottle">Bottle</option>
          <option value="cap">Cap</option>
          <option value="pump">Pump</option>
          <option value="sticker">Sticker</option>
          <option value="seal">Seal</option>
          <option value="box">Box</option>
          <option value="stage/leaflet">Stage/Leaflet</option>
          <option value="carton">Catron</option>
        </select>
      </div>
      <div class="col-1">
        <button class="btn btn-outline-danger" (click)="clearMenu()">
          <i class="fas fa-eraser"></i>&nbsp;Clear
        </button>
      </div>
      <div class="col-1">
        <button class="btn btn-outline-secondary" (click)="printReport()">
          <i class="fas fa-print"></i>&nbsp;Print
        </button>
      </div>
      <div class="col-2">
        <button class="btn btn-outline-success" (click)="exportToExcel()">
          <img
            src="../../../../assets/images/excel.png"
            style="width: 25px; height: 25px"
            alt=""
          />&nbsp;Export
        </button>
      </div>
      <div class="col-1">
        <button
          style="display: none"
          #btnPrint
          [useExistingCss]="true"
          printTitle="דו''ח רכיבים נדרשים ללו''ז"
          printSectionId="print-section-report"
          ngxPrint
        >
          <i class="fas fa-print"></i>&nbsp;Print
        </button>
      </div>
    </div>
  </form>
  <div class="row mt-2 w-100" id="print-section-report">
    <div class="col-12">
      <table class="table table-striped bg-light">
        <thead class="text-info h4">
          <tr class="font-roboto">
            <th>
              <i
                class="ti-exchange-vertical"
                (click)="sortByComponent()"
                style="cursor: pointer"
              >
                <span class="font-roboto">&nbsp;&nbsp;Component</span></i
              >
            </th>
            <th>Type</th>
            <th>Pcs Per Item</th>
            <th>Quantity (Net)</th>
            <th>Quantity (Gross)</th>
            <th>Image</th>
            <th>Order Number</th>
            <th>Item Number</th>
          </tr>
        </thead>
        <tbody class="text-dark">
          <tr
            *ngFor="let component of componentsTotalQty"
            style="font-size: larger"
          >
            <td>{{ component.componentN }}</td>
            <td>{{ component.type }}</td>
            <td>{{ component.pcsPerItem }}</td>
            <td>{{ component.quantity }}</td>
            <td>{{ component.grossQty }}</td>
            <td><img [src]="component.img" class="pictureTabImg" /></td>
            <td>{{ component.orderNumber }}</td>
            <td>{{ component.itemNumber }}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
