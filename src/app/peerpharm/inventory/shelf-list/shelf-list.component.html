
<div class="container text-center shadow bg-white">
  <div class="row mt-4">
    <div class="col-12">
      <h1 style="text-shadow: 2px 2px 4px #000000;" class="text-info ">Shelf List</h1>
    </div>
  </div>

  <div class="row mt-4">
    <div class="col-1">
      <button [printStyle]="{td : {'border': '1px solid black'}, tr : {'border': 'solid 1px black'}}" style="background: none;border:none" printSectionId="print-section" ngxPrint><img src="../../../../assets/images/print.png" alt="Print" style="width: 55px;"></button>  
    </div>
  
    <div class="col-2">
      <label class="form-control">Whare House</label>
    </div>
    <div class="col-2">
      <select (change)="getShelfsByWH($event)" class="form-control">
        <option selected="true" disabled="disabled">WhareHouse</option> 
        <option value="5c0d1831d1b74a43e81e8edb">Kasem</option>
        <option value="5cf64e77e32883115c39dc56">Materials - Outside</option>
        <option value="materials">Rosh HaAyin - Materials</option>
        <option value="components">Rosh HaAyin - Components</option>
        <option value="5c31bb6f91ca6b2510349ce9">Rosh HaAyin - Products</option>
      </select>
    </div>
    <div class="col-2">
      <label class="form-control">Position</label>
    </div>
    <div class="col-1">
      <input  class="form-control" (blur)="filterByShelf($event)">
    </div>
    <div class="col-2">
      <label class="form-control">Costumer</label>
    </div>
    <div class="col-2">
      <input list="costumers" class="form-control" type="text" (change)="filterByCostumer($event)">
      <datalist id="costumers">
        <option *ngFor="let costumer of allCostumers" [value]="costumer.costumerName">{{costumer.costumerName}}</option>
      </datalist>
    </div>
  </div>

  <div id="print-section" class="row mt-4">
    <div class="col-12">
      <table class="table table-bordered table-hover">
        <thead class="bg-info text-white">
          <tr>
            <th>#</th>
            <th>Item Number</th>
            <th>Position</th>
            <th>Amount</th>
            <th>Costumer</th>
            <th>Count Date</th>
            <th>Counted Amount</th>
            <th>Signature</th>
            <!-- <th></th> -->
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let shelf of allShelfs;let i = index">
            <td>{{i+1}}</td>
            <td>{{shelf.item}}</td>
            <td>{{shelf.position}}</td>
            <td>{{shelf.total}}</td>
            <td (click)="editShelfAmount(shelf.item,shelf.position)" *ngIf="shelfItemN != shelf.item || shelfPos != shelf.position">{{shelf.costumer}}</td>
            <td *ngIf="shelfItemN == shelf.item && shelfPos == shelf.position">
              <input list="costumers" class="form-control" (change)="updateShelfCostumer(shelf)" [(ngModel)]="item.costumer">
              <datalist id="costumers">
                <option *ngFor="let costumer of allCostumers" [value]="costumer.costumerName">{{costumer.costumerName}}</option>
              </datalist>
            </td>

            <td (click)="editShelfAmount(shelf.item,shelf.position)" *ngIf="shelfItemN != shelf.item || shelfPos != shelf.position"></td>
            <td *ngIf="shelfItemN == shelf.item && shelfPos == shelf.position">
              <input type="date" class="form-control" [(ngModel)]="item.countDate">
            </td>

            <td (click)="editShelfAmount(shelf.item,shelf.position)" *ngIf="shelfItemN != shelf.item || shelfPos != shelf.position"></td>
            <td *ngIf="shelfItemN == shelf.item && shelfPos == shelf.position">
              <input type="number" class="form-control" (change)="updateShelfAmount(shelf)" [(ngModel)]="item.countedAmount">
            </td>

            <td (click)="editShelfAmount(shelf.item,shelf.position)" *ngIf="shelfItemN != shelf.item || shelfPos != shelf.position"></td>
            <td *ngIf="shelfItemN == shelf.item && shelfPos == shelf.position">
              <input type="text" class="form-control" [(ngModel)]="item.signature">
            </td>
            
            <!-- <td (click)="editShelfAmount(shelf.item,shelf.position)" *ngIf="shelfItemN != shelf.item || shelfPos != shelf.position"></td>
            <td *ngIf="shelfItemN == shelf.item && shelfPos == shelf.position"><i class="fa fa-save" (click)="updateShelfAmount(shelf)"></i></td> -->
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <div class="row mt-3">
    <div class="col-2"></div>
    <div class="col-2"></div>
    <div class="col-2">
      <label class="form-control">Material</label>
    </div>
    <div class="col-2">
      <input class="form-control" (blur)="searchForShelfs($event)">
    </div>
    <div class="col-2"></div>
    <div class="col-2"></div>
  </div>

  <div class="row mt-2">
    <div class="col-12">
      <table class="table table-bordered table-hover">
        <thead>
          <tr>
            <th>#</th>
            <th>Name</th>
            <th>Position</th>
            <th>Amount</th>
            <th>Expire Date</th>
            <th>Arrival Date</th>
            <th>Batch</th>
            <th>Supplier Batch</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let shelf of materialShelfs;let i = index">
            <td>{{i+1}}</td>
            <td>{{shelf.materialName}}</td>
            <td (click)="edit(shelf._id)" *ngIf="EditRow != shelf._id">{{shelf.position}}</td>
            <td *ngIf="EditRow == shelf._id">
            <input #shelfPosition class="form-control" [value]="shelf.position">
            </td>

            <td (click)="edit(shelf._id)" *ngIf="EditRow != shelf._id">{{shelf.amount}}</td>
            <td *ngIf="EditRow == shelf._id">
              <input #shelfAmount class="form-control" [value]="shelf.amount">
            </td>

            <td>{{shelf.expirationDate | date: 'dd/MM/yyyy'}}</td>
            <td>{{shelf.arrivalDate | date: 'dd/MM/yyyy'}}</td>

            <td>{{shelf.batchNumber}}</td>

            <td>{{shelf.supplierBatchNumber}}</td>
            <td><i *ngIf="EditRow == shelf._id" (click)="updateShelf(shelf._id)" class="fa fa-save text-success"></i></td>

          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>