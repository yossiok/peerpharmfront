<!-- {{openModal}} -->

<div class="container-fluid bg-white p-2 text-center">

  <div [class.read-only]="checkPermission()" class="row fixNoaStupidStuff">
    <div class="col-1 fixNoaStupidStuff">
      <button (click)="itemsMovementModal = true" class="btn btn-info form-control rounded-pill">F9 - הוצאה/קבלת
        סחורה</button>
    </div>
    <div class="col-1 fixNoaStupidStuff">
      <button class="btn btn-info form-control rounded-pill">F8 - הזמנות מלאי</button>
    </div>
    <div class="col-3 fixNoaStupidStuff"></div>
    <div class="col-1 fixNoaStupidStuff">
      <button class="btn btn-warning form-control rounded-pill" (click)="procurementRecommendations('minimumStock')">F7
        - בדוק המלצה
        לרכש</button>
    </div>
    <div class="col-1 fixNoaStupidStuff">
      <button class="btn btn-warning form-control rounded-pill"
        (click)="newPurchaseRecommendModal = true; getLastCustomerOrders()">F10
        בקשה לרכש חדשה</button>
    </div>
    <div class="col-3 fixNoaStupidStuff"></div>
    <div class="col-1 fixNoaStupidStuff">
      <button class="btn btn-success form-control rounded-pill" (click)="inventoryNewReqModal = true">F4 - בקשת
        מלאי</button>
    </div>
    <div class="col-1 fixNoaStupidStuff">
      <button class="btn btn-success form-control rounded-pill" (click)="newCmpt('new')">F2 - פריט חדש</button>
    </div>
  </div>

  <!--filter components-->
  <div [class.read-only]="checkPermission()" class="fixNoaStupidStuff search rounded-pill ml-10">
    <form [formGroup]="filterParams" (ngSubmit)="filterComponents()">
      <div class="row mt-5 fixNoaStupidStuff">
        <div class="col-2 fixNoaStupidStuff"></div>
        <div class="col-2 fixNoaStupidStuff">
          <label for="">Component Number</label>
          <input formControlName="componentN" #numberSearchInput type="text" class="form-control rounded-pill"
            placeholder="Search By Number">
        </div>
        <div class="col-2 fixNoaStupidStuff">
          <label for="">Component Name</label>
          <input pattern="^[a-z0-9_-]{8,15}$" formControlName="componentName" type="text"
            class="form-control rounded-pill" placeholder="Search By Name">
        </div>
        <div class="col-2 fixNoaStupidStuff">
          <label for="">Component Type</label>
          <select formControlName="componentType" class="form-control rounded-pill">
            <option value="" selected="true">בחר קטגוריה</option>
            <option value='bottle_Glass'>בקבוק זכוכית</option>
            <option value='bottle_Plastic'>בקבוק פלסטיק</option>
            <option value='jar_Glass'>צנצנת זכוכית</option>
            <option value='jar_Plastic'>צנצנת פלסטיק</option>
            <option value='cap'>פקק</option>
            <option value='cover'>מכסה</option>
            <option value='pump'>משאבה</option>
            <option value='cosmetic_pump'>משאבה קוסמטית</option>
            <option value='over_cap'>מכסה עילי</option>
            <option value='tube'>שפורפרת</option>
            <option value='colons'>קולונים</option>
            <option value='hair_life'>היירלייפ</option>
            <option value='compacts'>קומפקטים</option>
            <option value='personal_package'>אריזות אישיות</option>
            <option value='master_carton'>קרטוני מאסטר</option>
            <option value='newsletter'>עלון לצרכן</option>
            <option value='irosol_valve'>אירוסול- שסתום</option>
            <option value='irosol_bottle'>איירוסול- בקבוק</option>
            <option value='irosol_hectotor'>אירוסול- הקטאטור</option>
            <option value='irosol_bottle'>איירוסול- בקבוק</option>
            <option value='cellophane'>צלופן</option>
            <option value='sticker'>מדבקה</option>
            <option value='sachet'>סאשט</option>
            <option value='godett'>גודט</option>
            <option value='plate'>גלופה</option>
          </select>
        </div>
        <div class="col-2 fixNoaStupidStuff">
          <label for="">Category</label>
          <select formControlName="componentCategory" class="form-control rounded-pill">
            <option value="" selected="true">בחר קטגוריה</option>
            <option *ngFor="let cmptCategory of cmptCategoryList">{{cmptCategory}}</option>
          </select>
        </div>
        <div class="col-2 fixNoaStupidStuff"></div>
      </div>
      <div dir="rtl" class="row mt-5 fixNoaStupidStuff">
        <div class="col-3 fixNoaStupidStuff"></div>
        <div class="col-2 fixNoaStupidStuff">
          <div *ngIf="smallerLoader" class="smallerLoader ml-5"></div>
          <button *ngIf="!smallerLoader" (click)="getRecommendationReport()" class="btn-info form-control rounded-pill"
            type="button"><b>דו"ח
              המלצה לרכש</b>&nbsp;&nbsp;<img src="../../../../assets/images/excel.png"
              style="width: 25px; height: 25px;" alt=""></button>
        </div>
        <div class="col-2 fixNoaStupidStuff">
          <button (click)="clearSearchFields()" class="btn-secondary form-control rounded-pill"
            type="button"><b>נקה</b></button>
        </div>
        <div class="col-2 fixNoaStupidStuff">
          <button class="btn-primary form-control rounded-pill">חיפוש</button>
        </div>
        <div class="col-3 fixNoaStupidStuff"></div>
      </div>
    </form>
  </div>

  <div *ngIf="stockType == 'material'" class="row mt-10 fixNoaStupidStuff">
    <div class="col-4 fixNoaStupidStuff"></div>
    <div class="col-2 fixNoaStupidStuff">
      <select [(ngModel)]="materialFilterType" class="form-control rounded-pill">
        <option selected="true" disabled="disabled">בחר שדה לסינון</option>
        <option value="">כל החומרי גלם</option>
        <option value="location">מיקום במחסן</option>
        <option value="threatment">קבוצת סיכון</option>
        <option value="permissionDangerMaterials">היתר רעלים</option>
        <option value="function">function</option>
        <option value="stateOfMatter">מצב צבירה</option>
        <option value="inciName">INCI Name</option>
      </select>
    </div>
    <div class="col-2 fixNoaStupidStuff">
      <input *ngIf="materialFilterType != 'threatment' && materialFilterType != 'stateOfMatter'"
        [(ngModel)]="materialFilterValue" class="form-control rounded-pill">
      <select *ngIf="materialFilterType == 'threatment'" [(ngModel)]="materialFilterValue"
        class="form-control rounded-pill">
        <option value="flammableLiquid">3 - נוזל דליק</option>
        <option value="flammableSolid">4 - מוצק דליק</option>
        <option value="oxidizer">5.1 - מחמצן אי אורגני</option>
        <option value="toxic">6 - רעיל</option>
        <option value="acid">8 - חומצה</option>
        <option value="base">8 - בסיס</option>
        <option value="otherDangerMaterials">9 - חומרים מסוכנים שונים</option>
        <option value="regular">אין מספר או"מ</option>
        <option value="cooling">איחסון בקירור</option>
        <option value="blockedByType">חסום לפי סוג חומר</option>
      </select>
      <select *ngIf="materialFilterType == 'stateOfMatter'" [(ngModel)]="materialFilterValue"
        class="form-control rounded-pill">
        <option value="liquid">Liquid</option>
        <option value="solid">Solid</option>
        <option value="gell">Gell</option>
      </select>
    </div>
    <div class="col-1">
      <button (click)="filterMaterialsTable()" class="btn-info form-control rounded-pill">חפש</button>
    </div>
    <div class="col-4"></div>
  </div>

  <div *ngIf="smallLoader == true">
    <h2>{{loadingText}}</h2>
    <div style="margin-right:auto !important" class="smallLoader fixNoaStupidStuff mx-auto my-auto"></div>
  </div>
  <div style="width:100%;">


    <!-- ------------------------------------------------------ -->


    <div class="tableContainer" style="width: 100% ; padding:0px; ">

      <!-- <input #filterbyNum type="text" placeholder="Search Item Number..." (change)="filterRowsByItemNumber($event)"> -->
      <br>

      <div (click)='setType("component")' [ngStyle]="{'background-color': buttonColor,'color':fontColor}" class="navtab"
        style="cursor:pointer;box-shadow: black 0px -1px 3px inset;">Components</div>
      <div (click)='setType("product")' [ngStyle]="{'background-color': buttonColor3,'color':fontColor3}" class="navtab"
        style="cursor:pointer;box-shadow:black 0px -1px 3px inset;">Products</div>
      <div (click)='setType("material")' [ngStyle]="{'background-color': buttonColor2,'color':fontColor2}"
        class="navtab" style="cursor:pointer;box-shadow:black 0px -1px 3px inset;">Materials</div>
      <div class="export" style="cursor:pointer;">
        <img *ngIf="loadingExcel" style="width:50px"
          src="http://avacdn.com/wp-content/uploads/2018/05/motosha-spinner.gif" />
        <img src="../../../../assets/images/excel.png" alt="export to excel" style="width: 40px;"
          (click)="exportCurrTable()">
        <img src="../../../../assets/images/excel.png" alt="export to excel" class="border border-light"
          style="width: 40px;" (click)="exportItemData()">
      </div>
      <div [class.read-only]="checkPermission()" class="export" style="cursor:pointer;"
        (click)="open(printInventoryValue)">
        <button class="btn btn-primary">Value For Money</button>
      </div>

      <!-- TABLE START -->
      <div *ngIf="stockType=='component' && !smallLoader" class="tableFixHead">
        <table class='table stockTable table-fixed text-center' *ngIf="stockType=='component'">
          <thead class="text-white bg-info">
            <tr style="text-align: center;">
              <th style="width:3%;"></th>
              <th style="width:6%;"><b>מספר פריט</b></th>
              <th style="width:5%;"><b>מק"ט פריט-ספק</b></th>
              <th style="width:5%;"><b>ספק</b></th>
              <th style="width:5%;"><b></b></th>
              <th style="width:10%"><b>שם</b></th>
              <th style="width:5%;"><b>סוג</b></th>
              <th style="width:5%;"><b>כמות מוקצת</b></th>
              <th style="width:5%;"><b>כמות</b></th>
              <th style="width:5%;"><b>תמונה</b></th>
              <th style="width:12%;"><b>צפי הגעה הזמנת רכש</b></th>
              <th style="width:3%;"></th>
              <th style="width:3%;"></th>
            </tr>
          </thead>
          <tbody id="table_body" class="componentTable">
            <tr *ngFor="let component of components; let i = index">
              <td style="width:3%;">{{i+1}}</td>
              <td style="width:6%;" class="compNum" (click)="openData(component.componentN)"> {{component.componentN}}
              </td>
              <td style="width:5%; word-break: normal;">{{component.componentNs}}</td>
              <td style="width:5%; word-break: normal;">{{component.suplierN}}</td>
              <td style="width:5%; word-break: normal;">{{component.suplierName}}</td>
              <td style="width:10%;">{{component.componentName}}</td>
              <td style="width:5%; word-break: normal;">{{component.componentType}}</td>
              <td *ngIf="component.openOrders" style="width:5%; cursor: pointer;border-right: 2px solid black;"
                (click)="openAllocatedOrders(component)" [ngClass]="calcIfLowThenMin(component)">
                {{component.alloAmount}}
                <img src="../../../../assets/images/search_plus_blue.png" alt="watch quantities"
                  style="width: 40px; margin-left: 15px; cursor: pointer; float: right;">
              </td>
              <td *ngIf="!component.openOrders">
                <p>טוען הקצאות..</p>
                <div class="smallerLoader"></div>
              </td>
              <td style="width:5%;cursor: pointer;" (click)="getCmptAmounts(component.componentN, component._id)">
                {{component.amount }}
                <img src="../../../../assets/images/search_plus_blue.png" alt="watch quantities"
                  style="width: 40px; margin-left: 15px; cursor: pointer; float: right;">
              </td>
              <td style="width:5%; text-align: center;">
                <img [src]="component.img" style='width:50px ; cursor: pointer;' (click)="openImg(component.img)">
              </td>

              <td>
                <!-- <button class="btn btn-success" *ngIf="!component.showPurch" (click)="getItemPurchases(component)">טען
                  הזמנות פתוחות</button> -->
                <div>
                  <img src="../../../../assets/images/refreshData.png" class="float-right small" alt="get user name"
                    (click)="getItemPurchases(component)">
                  <span *ngIf="component.purchaseOrders.length == 0">אין הזמנות פתוחות לפריט</span>
                  <table *ngIf="component.purchaseOrders.length > 0" style="zoom:0.7">
                    <thead class="text-white">
                      <tr>
                        <th class="text-white">PO #</th>
                        <th class="text-white">PO Date</th>
                        <th class="text-white">PO Arrival Date</th>
                        <th class="text-white">PO Amount</th>
                        <th class="text-white">PO Delivered</th>
                        <th class="text-white">Supplier</th>
                      </tr>
                    </thead>
                    <tbody>

                      <ng-container *ngFor="let purchase of component.purchaseOrders">
                        <ng-container *ngFor="let item of purchase.stockitems">
                          <tr *ngIf="item.number == component.componentN">
                            <td>{{purchase.orderNumber}}</td>
                            <td>{{purchase.creationDate | date: 'dd/MM/yyyy'}}</td>
                            <td>{{purchase.arrivalDate | date: 'dd/MM/yyyy'}}</td>
                            <td>{{item.quantity}}</td>
                            <td>{{purchase.arrivedAmount}}</td>
                            <td>{{purchase.supplierNumber}} - {{purchase.supplierName}}</td>
                          </tr>
                        </ng-container>
                      </ng-container>
                    </tbody>
                  </table>
                </div>


              </td>


              <td style="width:3%;">
                <!-- <img *ngIf="stockAdmin" (click)="deleteStockItemValidation(component.componentN)"
                  src="../../../../assets/images/deleteBtn.png" alt="delete stock item"
                  style="width: 60px ; cursor: pointer; "> -->
                <img (click)="deleteComponent(component._id)" *ngIf="showDeleteBtn" style="width:30px"
                  src="../../../../assets/images/deleteBtn.png">

              </td>
            </tr>
          </tbody>

        </table>

      </div>

      <app-expected-arrivals *ngIf="openProcurementModal" [componentData]='resCmpt'
        (outPutItemsExpectedData)="getNewExpectedArrivalsData($event)"></app-expected-arrivals>


      <table class='table productTable Table table-fixed' style="width:100%"
        *ngIf="stockType=='product' && !smallLoader">
        <thead class='text-white bg-success'>
          <tr>

            <th style="width:6%;"></th>
            <th style="width:10%;"><b>מספר פריט</b></th>
            <!-- <th style="><b>מק"ט פריט/ספק</b></th> -->
            <th style="width:25%;"><b>שם</b></th>
            <!-- <th style="><b>סוג</b></th> -->
            <th style="width:9%;"><b>כמות מוקצת</b></th>
            <th style="width:9%;"><b>כמות</b></th>
            <th style="width:9%;"></th>

            <th style="width:9;"><b>תמונה</b></th>
            <!-- <th style="><b>הזמנת רכש</b></th>
              <th style="><b>כמות להזמנת רכש</b></th> -->
            <th style="width:7%;"></th>
          </tr>

        </thead>



        <tbody id="table_body" class="productTable">
          <tr *ngFor="let component of components; let i = index">
            <td style="width:6%">{{i+1}}</td>
            <td style="width:10%" class="compNum">
              <a target="_blank" routerLink="/peerpharm/items/itemDetails/{{component.componentN}}">
                {{component.componentN}}
              </a>
            </td>

            <!-- <td>{{component.componentNS}}</td> -->
            <td style="width:25%;">{{component.componentName}}</td>
            <!-- <td>{{component.componentType}}</td> -->

            <td style="width:9%;border-right: 2px solid black;">{{component.productAlloAmount}} <img
                (click)="openAllocatedProducts(component.componentN)"
                src="../../../../assets/images/search_plus_blue.png" alt="watch quantities"
                style="width: 40px; margin-left: 15px; cursor: pointer; float: right;"></td>
            <td style="width:9%;">{{component.amount}}</td>
            <td style="width:9%;"><button [style.cursor]="callingForCmptAmounts ? 'not-allowed' : 'pointer'"
                [disabled]="callingForCmptAmounts" class="btn btn-info"
                (click)="getCmptAmounts(component.componentN, component._id)">צפיה בכמויות</button></td>
            <td style="width:9%;">
              <div *ngIf="component.allocAmount!=undefined || component.allocAmount!=null">{{component.allocAmount}}
              </div>
            </td>
            <td style="width:9%;"><img [src]=component.img style='width:50px ; cursor: pointer;'
                (click)="openImg(component.img)"></td>
            <!-- <td><button *ngIf="component.procurementSent==true" class="btn btn-warning" (click)="updateProcurment(component._id,component.componentN,'false')">מחק</button>{{component.procurementAmount}}</td>
              <td><div>
                <input #procurmentInput type="number" (keyup)="inputProcurment($event)" /><span> <button class="btn btn-success"
                  (click)="updateProcurment(component._id,component.componentN,'true')">עדכן</button></span>
                
              </div>
            </td> -->

            <!-- <td style="width:7%;">
              <img (click)="deleteStockItemValidation(component.componentN)" src="../../../../assets/images/deleteBtn.png"
                alt="delete stock item" style="width: 60px ; cursor: pointer; ">
            </td> -->
          </tr>
        </tbody>

      </table>

    </div>

    <!-- TABLE END -->


    <table class='table stockTable table-fixed' *ngIf="stockType=='material' && !smallLoader">
      <thead class='bg-warning text-white'>
        <tr style="text-align: center">

          <th style="width:5%;"></th>
          <th style="width:10%;"><b>מספר פריט</b></th>
          <th style="width:15%;"><b>שם פריט</b></th>
          <th style="width:15%;"><b>בעייתי?</b></th>
          <th style="width:9%;"><b>כמות מוקצת</b></th>
          <th style="width:9%;"><b>כמות</b></th>
          <th>צפי הגעה המלצות רכש</th>
          <th></th>
        </tr>

      </thead>

      <tbody id="table_body" class="materialsTable">
        <tr *ngFor="let material of components ; let i = index">

          <td style="width:5%">{{i+1}}</td>
          <td style="width:10%" class="compNum">
            <fieldset>
              <div (click)="openDataMaterial(material.componentN)" style="float:none;">{{material.componentN}}</div>
            </fieldset>
          </td>

          <td [ngClass]="dangerColor(material.threatment)" style="width:15%">
            <div style="float:none;">{{material.componentName}}</div>
          </td>
          <td>
            <span *ngIf="material.isProblematic">
              <img class="reportImg" src="../../../../assets/images/alert3.gif" alt="">
            </span>
          </td>

          <td style="border-right: 2px solid black;"></td>
          <td style="width:5%;cursor: pointer;" (click)="getCmptAmounts(material.componentN, material._id)">

            {{material.amount | number:'1.2-2'}}
            <img src="../../../../assets/images/search_plus_blue.png" alt="watch quantities"
              style="width: 40px; margin-left: 15px; cursor: pointer; float: right;">

          </td>

          <td></td>
          <td>
            <img (click)="deleteComponent(material._id)" *ngIf="showDeleteBtn" style="width:30px"
              src="../../../../assets/images/deleteBtn.png">
          </td>

        </tr>
      </tbody>
    </table>



    <div class="modal fade" id="supplierModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle"
      aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLongTitle">Modal title</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            ...
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            <button type="button" class="btn btn-primary">Save changes</button>
          </div>
        </div>
      </div>
    </div>





    <div style="top:20px;" class="container bg-light rounded fixed-top shadow mx-auto my-auto border border-success"
      *ngIf="openModal == true && stockType=='component'">
      <mat-tab-group mat-align-tabs="center">
        <mat-tab label="Component Details">
          <div class="container modal-inner">
            <div class="row text-center fixNoaStupidStuff">
              <div class="col-4 fixNoaStupidStuff text-right">
                <!-- <button class="btn btn-success form-control" (click)="switchModalView()">{{itemmoveBtnTitle}}</button> -->
              </div>
              <div class="col-4 fixNoaStupidStuff">
                <h2 class="text-success" id='div_h3'>{{openModalHeader}}</h2><br>
              </div>
              <div class="col-4 fixNoaStupidStuff">
                <span class="close text-success" id="closeId2"
                  (click)="openModal=false;newItem='';lastOrdersOfItem = []">&times;</span>
              </div>
            </div>

            <div class="row text-center fixNoaStupidStuff">
              <div class="col-1"></div>

              <div class="col-8">
                <input class="form-control" type="text" [(ngModel)]="resCmpt.componentName">
              </div>
              <div class="col-2">
                <label class="form-control">שם פריט</label>
              </div>
              <div class="col-1"></div>
            </div>

            <div dir="rtl" class="row text-center fixNoaStupidStuff">
              <div class="col-4 fixNoaStupidStuff">
                <h5 class="text-success">פרטי פריט</h5>
              </div>
              <div class="col-1 fixNoaStupidStuff">
                <h5 class="text-success">מהדורה</h5>
              </div>
              <div class="col-3 fixNoaStupidStuff">
                <h5 class="text-success">פרטי ספק</h5>
              </div>
              <div class="col-4 fixNoaStupidStuff">
                <h5 class="text-success">פרטי מלאי</h5>
              </div>
            </div>
            <div dir="rtl" class="row text-center fixNoaStupidStuff">
              <div class="col-2 fixNoaStupidStuff">
                <label class="form-control">מספר פריט</label>

                <label class="form-control">שם קומקס</label>
                <label class="form-control">פריט חלופי</label>
                <label class="form-control">מחיר אחרון (שקלים)</label>
                <!-- <label class="form-control">מחיר העמסה (שקלים)</label> -->
              </div>
              <div class="col-2 fixNoaStupidStuff">
                <input (change)="checkIfItemExist($event)" class="form-control" type='text'
                  [(ngModel)]="resCmpt.componentN">
                <input class="form-control" type="text" [(ngModel)]="resCmpt.comaxName">
                <input class="form-control" type="text" [(ngModel)]="resCmpt.alternativeComponent">
                <input class="form-control" type="number" disabled [(ngModel)]="resCmpt.price" maxlength="6" max="6">
                <!-- <input class="form-control" type="text" [(ngModel)]="resCmpt.price">
                <input class="form-control" type="number" [(ngModel)]="resCmpt.shippingPrice"> -->

              </div>
              <div class="col-1 fixNoaStupidStuff">
                <input type="number" disabled class="small-input form-control d-inline "
                  [(ngModel)]="resCmpt.versionNumber">
                <i class="fas fa-plus mr-2 text-success" ngbTooltip="שדרג מהדורה"
                  (click)="open(editVersionDetails)"></i>
              </div>
              <div class="col-2 fixNoaStupidStuff">
                <label class="form-control">מספר ספק</label>
                <label class="form-control">מק"ט ספק</label>
                <label class="form-control">מחיר ספק</label>
              </div>
              <div class="col-2 fixNoaStupidStuff">
                <input class="form-control" list="suppliers" type='text' (change)="fillSupplierDetails()"
                  [(ngModel)]="resCmpt.suplierN">
                <datalist id="suppliers">
                  <option *ngFor="let supplier of allSuppliers" value="{{supplier.suplierName}}">
                    {{supplier.suplierNumber}}
                  </option>
                </datalist>
                <input class="form-control" type='text' [(ngModel)]="resCmpt.componentNs">
                <input class="form-control" type='number' disabled [(ngModel)]="resCmpt.price">
              </div>
              <div class="col-2 fixNoaStupidStuff">
                <label class="form-control">מלאי מינימום</label>
                <label class="form-control">כמות מינימלית להזמנה</label>
              </div>
              <div class="col-1 fixNoaStupidStuff">
                <input class="form-control" type='number' [(ngModel)]="resCmpt.minimumStock">
                <input class="form-control" type='number' [(ngModel)]="resCmpt.minimumPurchaseAmount">
              </div>
            </div>
            <!-- <div dir="rtl" class="row text-center fixNoaStupidStuff">
              <div class="col-2 fixNoaStupidStuff">
              </div>
              <div class="col-2 fixNoaStupidStuff">
              </div>
            </div> -->

            <div dir="rtl" class="row text-center fixNoaStupidStuff">
              <div class="col-4 fixNoaStupidStuff">
                <h5 class="text-success">פרטים נוספים</h5>
              </div>
              <div class="col-4 fixNoaStupidStuff">
                <h5 class="text-success">הערות</h5>
              </div>
              <div class="col-4 fixNoaStupidStuff">
                <h5 class="text-success">תמונה</h5>
              </div>
            </div>

            <div dir="rtl" class="row text-center fixNoaStupidStuff">
              <div class="col-2 fixNoaStupidStuff">
                <label class="form-control">קטגוריה</label>
                <label class="form-control">מותג</label>
                <label class="form-control">משקל/סוג</label>
                <label class="form-control">יח' מידה</label>
                <label class="form-control">כמות מל'</label>
                <label class="form-control">על חשבון</label>
                <!-- <label class="form-control">רשימת לקוחות</label> -->
              </div>
              <div class="col-2 fixNoaStupidStuff">
                <select class="form-control" [(ngModel)]="resCmpt.componentType">
                  <option value='bottle_Glass'>בקבוק זכוכית</option>
                  <option value='bottle_Plastic'>בקבוק פלסטיק</option>
                  <option value='jar_Glass'>צנצנת זכוכית</option>
                  <option value='jar_Plastic'>צנצנת פלסטיק</option>
                  <option value='cap'>פקק</option>
                  <option value='cover'>מכסה</option>
                  <option value='pump'>משאבה</option>
                  <option value='cosmetic_pump'>משאבה קוסמטית</option>
                  <option value='over_cap'>מכסה עילי</option>
                  <option value='tube'>שפורפרת</option>
                  <option value='colons'>קולונים</option>
                  <option value='hair_life'>היירלייפ</option>
                  <option value='compacts'>קומפקטים</option>
                  <option value='personal_package'>אריזות אישיות</option>
                  <option value='master_carton'>קרטוני מאסטר</option>
                  <option value='newsletter'>עלון לצרכן</option>
                  <option value='irosol_valve'>אירוסול- שסתום</option>
                  <option value='irosol_bottle'>איירוסול- בקבוק</option>
                  <option value='irosol_hectotor'>אירוסול- הקטאטור</option>
                  <option value='irosol_bottle'>איירוסול- בקבוק</option>
                  <option value='cellophane'>צלופן</option>
                  <option value='sticker'>מדבקה</option>
                  <option value='sachet'>סאשט</option>
                  <option value='godett'>גודט</option>
                  <option value='plate'>גלופה</option>
                  <option value='other'>אחר</option>
                </select>

                <select class="form-control" [(ngModel)]="resCmpt.componentCategory">
                  <!-- <select #filterByCategory class="form-control" (change)="filterRowsByCmptTypeanCategory($event , 'category')"> -->
                  <option value=""></option>
                  <option *ngFor="let cmptCategory of cmptCategoryList">{{cmptCategory}}</option>
                </select>




                <select class="form-control" [(ngModel)]="resCmpt.packageType">
                  <option value='paperCarton'>נייר/קרטון</option>
                  <option value='drinkCarton'>קרטוניות משקה</option>
                  <option value='transperentGlass'>זכוכית שקופה</option>
                  <option value='colorGlass'>זכוכית צבעונית</option>
                  <option value='pet'>PET</option>
                  <option value='hdpe'>HDPE</option>
                  <option value='ldpe'>LDPE</option>
                  <option value='pp'>PP</option>
                  <option value='ps'>PS</option>
                  <option value='otherPlastic'>פלסטיק אחר</option>
                  <option value='metal'>מתכת</option>
                  <option value='wood'>עץ</option>
                  <option value='otherMaterial'>חומר אחר</option>
                </select>

                <select class="form-control" [(ngModel)]="resCmpt.measurement">
                  <option value="kilogram">kilogram</option>
                  <option value="liter">liter</option>
                  <option value="meter">meter</option>
                  <option value="ml">ml</option>
                  <option value="unit">Unit</option>
                  <option value="ton">טון</option>
                  <option value="unit">יחידה</option>
                  <option value="box">קופסא</option>
                </select>

                <input class="form-control" type="text" [(ngModel)]="resCmpt.actualMlCapacity">
                <select class="form-control" (change)="checkWhoPays($event)" [(ngModel)]="resCmpt.whoPays">
                  <option value="peerpharm">פארפארם</option>
                  <option value="customers">לקוח/לקוחות</option>
                </select><i (click)="customersModal = true" class="form-control fa fa-plus text-success "></i>
                <!-- <select class="form-control">
                        <option *ngFor="let customer of resCmpt.payingCustomersList" value="customer">{{customer}}</option>
                  </select> -->
              </div>
              <div class="col-2 fixNoaStupidStuff">
                <label class="form-control">הערה</label>
                <label class="form-control mt-5">הערה קופצת</label>

              </div>
              <div class="col-2 fixNoaStupidStuff">
                <textarea rows="2" cols="20" class="form-control" type='text' [(ngModel)]="resCmpt.remarks"></textarea>
                <textarea rows="2" cols="20" class="form-control mt-4" type='text'
                  [(ngModel)]="resCmpt.jumpRemark"></textarea>
              </div>

              <div class="col-2 fixNoaStupidStuff">
                <button [disabled]="gettingProducts" [style.cursor]="gettingProducts ? 'not-allowed' : 'pointer'"
                  (click)="getProductsWithItem()">הצג מוצרים שמכילים את הפריט</button>
              </div>

              <div class="col-2 fixNoaStupidStuff modal-inner border" *ngIf="resCmpt.connectedProducts">
                <div *ngFor="let product of resCmpt.connectedProducts">
                  <h5>{{product.itemNumber}}</h5>
                  <h5>{{product.name}}</h5>
                  <h5>{{product.subName}}</h5>
                  <h5>{{product.discriptionK}}</h5>
                </div>
              </div>

              <div class="col-4 fixNoaStupidStuff">
                <img *ngIf="resCmpt.img!=''" [src]="resCmpt.img" style="max-height: 250px;"
                  class="hoverImg w-25 h-100 border border-success" alt="Item main image please wait ...">
                <p *ngIf="resCmpt.img==''"><b> -No Image- </b></p>
                <input class="form-control" type='file' id="input_itemImgID" (change)='uploadImg($event)'
                  style='display:block'>
                <input class="form-control" type='text' [(ngModel)]="tempHiddenImgSrc" id='tempHiddenImgSrc'
                  style='display:none'>
              </div>
            </div>
            <div class="row fixNoaStupidStuff text-center">
              <div class="col-6 fixNoaStupidStuff">
                <button class="btn btn-success form-control" id="newCbtn" (click)="writeNewComponent()"
                  *ngIf="newItem=='new'">הקם מוצר
                </button>
              </div>
              <div class="col-6 fixNoaStupidStuff">
                <div *ngIf="allowUserEditItem">
                  <button class="btn btn-success form-control" id="updateDataBtn" (click)="editStockItemDetails()"
                    *ngIf="newItem!='new'">עדכן מידע
                  </button>
                </div>
              </div>
            </div>
          </div>
        </mat-tab>
        <mat-tab label="Component Suppliers Details">
          <div class="container modal-inner">

            <div style="padding: 0rem;" class="row text-center fixNoaStupidStuff">
              <div class="col-1 fixNoaStupidStuff text-right">
                <!-- <button class="btn btn-success form-control" (click)="switchModalView()">{{itemmoveBtnTitle}}</button> -->
              </div>
              <div class="col-10 fixNoaStupidStuff">
                <h4 class="text-success">ספקים</h4>
              </div>
              <div class="col-1 fixNoaStupidStuff">
                <span class="close text-success" id="closeId2"
                  (click)="openModal=false;newItem='';lastOrdersOfItem = []">&times;</span>
              </div>
            </div>

            <div dir='rtl' class="row border border-success border-bottom-0 fixNoaStupidStuff text-center">
              <h5>הוסף ספק</h5>
              <div class="col-1 fixNoaStupidStuff"></div>
              <div class="col-2 fixNoaStupidStuff">
                <label class="form-control">ספק</label>
                <label class="form-control">יצרן</label>
                <label class="form-control">מספר פריט ספק</label>
                <label class="form-control">שם פריט ספק</label>
                <label class="form-control">סוג אריזה</label>
              </div>
              <div class="col-3 fixNoaStupidStuff">
                <input list="suppliers" class="form-control" [(ngModel)]="supplier.supplierName">
                <datalist id="suppliers">
                  <option *ngFor="let supplier of allSuppliers" value="{{supplier.suplierName}}">
                    {{supplier.suplierNumber}}
                  </option>
                </datalist>
                <input type="text" class="form-control" [(ngModel)]="supplier.manufacturer">
                <input [(ngModel)]="supplier.alternativeMaterial" class="form-control" type='text'>
                <input [(ngModel)]="supplier.alterName" class="form-control" type='text'>
                <input list="groups" [(ngModel)]="supplier.subGroup" class="form-control">
                <datalist id="groups">
                  <option value="Cube">קובייה</option>
                  <option value="barrel">חבית</option>
                  <option value="small barrel">חביונית</option>
                  <option value="packaging/cardboard">אריזות/קרטון</option>
                  <option value="plastic barrel">חבית פלסטיק</option>
                  <option value="jerrican">ג'ריקן</option>
                  <option value="bag">שק</option>
                  <option value="bottle barrel">דלי בקבוק</option>
                </datalist>

              </div>
              <div class="col-2 fixNoaStupidStuff">
                <label class="form-control">מחיר</label>
                <label class="form-control">מטבע</label>
                <label class="form-control"> מחיר העמסה (מטבע קניה)</label>
                <label class="form-control">מטבע לאחר טעינה</label>
                <label class="form-control">משקל יחידה</label>
              </div>
              <div class="col-3 fixNoaStupidStuff">
                <input [(ngModel)]="supplier.price" type="text" class="form-control">
                <input list="coins" [(ngModel)]="supplier.coin" class="form-control">
                <datalist id="coins">
                  <option value="USD">USD</option>
                  <option value="ILS">ILS</option>
                  <option value="GBP">GBP</option>
                  <option value="EUR">EUR</option>
                  <option value="JPY">JPY</option>
                </datalist>
                <input [(ngModel)]="supplier.shippingPrice" type="number" class="form-control" />
                <input list="coinsLoading" [(ngModel)]="supplier.coinLoading" class="form-control">
                <datalist id="coinsLoading">
                  <option value="USD">USD</option>
                  <option value="ILS">ILS</option>
                  <option value="GBP">GBP</option>
                  <option value="EUR">EUR</option>
                  <option value="JPY">JPY</option>
                </datalist>
                <input [(ngModel)]="supplier.packageWeight" type="text" class="form-control" />
              </div>
              <div class="col-1 fixNoaStupidStuff"></div>
            </div>

            <div dir='rtl' class="row border border-success border-top-0 text-center fixNoaStupidStuff">
              <div class="col-12">
                <button (click)="addSupplierToComponent()" class="btn btn-success form-control">הוסף ספק</button>
              </div>
            </div>
            <div class="row mt-4"></div>
            <h4>רשימת ספקים לפריט</h4>
            <div dir='rtl' class="row text-center fixNoaStupidStuff">
              <div class="col-12">
                <table class="table table-hover">
                  <thead class="bg-success text-white">
                    <tr>
                      <th></th>
                      <th></th>
                      <th>ספק</th>
                      <th>יצרן</th>
                      <th>שם פריט</th>
                      <th>מספר פריט</th>
                      <th>מחיר</th>
                      <th>מטבע</th>
                      <th>משקל</th>
                      <th>מחיר העמסה (מטבע קניה)</th>
                      <th>מטבע לפני טעינה</th>
                      <th></th>
                      <th></th>
                    </tr>
                  </thead>
                  <tbody>
                    <ng-container *ngFor="let supplier of resCmpt.alternativeSuppliers;let i = index">
                      <tr [ngClass]="mainSupplier(supplier.isMain)">

                        <td (click)="edit(i)"><i placement="bottom" ngbTooltip="ערוך פרטי ספק"
                            class="click fa fa-pencil-alt"></i></td>
                        <td>
                          <span *ngIf="supplier.isMain">ספק ראשי!</span>
                          <button *ngIf="!supplier.isMain" placement="bottom"
                            ngbTooltip="הגדר את הספק כספק הראשי של הפריט" (click)="makeAsMainSupplier(i)"
                            class="btn btn-success">הגדר כספק ראשי</button>
                        </td>
                        <td>{{supplier.supplierName}}</td>
                        <!-- <td *ngIf="rowNumber == i">
                          <input [value]="supplier.supplierName" list="suppliers" class="form-control" #supplierName>
                          <datalist id="suppliers">
                            <option *ngFor="let supplier of allSuppliers" value="{{supplier.suplierName}}">
                              {{supplier.suplierName}}</option>
                          </datalist>
                        </td> -->

                        <!-- <td *ngIf="rowNumber != supplier.supplierName" >
                          {{supplier.supplierName}}</td>
                        <td *ngIf="rowNumber == supplier.supplierName">
                          <input type="text" [value]="supplier.supplierName" class="form-control" #supplierName>
                        </td> -->

                        <td *ngIf="rowNumber != i">
                          {{supplier.manufacturer}}</td>
                        <td *ngIf="rowNumber == i">
                          <input type="text" [(ngModel)]="supplier.manufacturer" class="form-control" #manufacturer>
                        </td>

                        <td *ngIf="rowNumber != i">
                          {{supplier.alterName}}</td>
                        <td *ngIf="rowNumber == i">
                          <input type="text" [(ngModel)]="supplier.alterName" class="form-control" #alterName>
                        </td>

                        <td *ngIf="rowNumber != i">
                          {{supplier.alternativeMaterial}}</td>
                        <td *ngIf="rowNumber == i">
                          <input type="text" [(ngModel)]="supplier.alternativeMaterial" class="form-control"
                            #alternativeMaterial>
                        </td>

                        <td *ngIf="rowNumber != i">
                          {{supplier.price}}</td>
                        <td *ngIf="rowNumber == i">
                          <input type="text" [(ngModel)]="supplier.price" class="form-control" #price>
                        </td>

                        <td *ngIf="rowNumber != i">
                          {{supplier.coin}}</td>
                        <td *ngIf="rowNumber == i">
                          <input type="text" [(ngModel)]="supplier.coin" class="form-control" #coin>
                        </td>

                        <td *ngIf="rowNumber != i">
                          {{supplier.packageWeight}}</td>
                        <td *ngIf="rowNumber == i">
                          <input type="text" [(ngModel)]="supplier.packageWeight" class="form-control" #packageWeight>
                        </td>

                        <td *ngIf="rowNumber != i">
                          {{supplier.priceLoading}}</td>
                        <td *ngIf="rowNumber == i">
                          <input type="text" [(ngModel)]="supplier.priceLoading" class="form-control" #priceLoading>
                        </td>

                        <td *ngIf="rowNumber != i">
                          <span *ngIf="supplier.shippingPrice"> {{supplier.shippingPrice | currency: 'ILS'}}</span>
                        </td>
                        <td *ngIf="rowNumber == i">
                          <input type="text" [(ngModel)]="supplier.coinLoading" class="form-control" #coinLoading>
                        </td>
                        <td><i placement="bottom" ngbTooltip="מחק מרשימת הספקים"
                            (click)="deleteSupplier(i,resCmpt.componentN)" class="fa fa-times text-danger"></i></td>
                        <td><i *ngIf="rowNumber == i" placement="bottom" ngbTooltip="שמור" (click)="rowNumber = -1"
                            class="fa fa-save"></i></td>
                      </tr>

                    </ng-container>

                  </tbody>
                </table>
              </div>
            </div>

            <!-- <div *ngIf="updateSupplier == true" class="row text-center fixNoaStupidStuff">
              <div class="col-5 fixNoaStupidStuff">

              </div>
              <div class="col-2 fixNoaStupidStuff">
                <button (click)="updateSupplierDetails(true)" class="btn btn-success form-control">שמור</button>
              </div>
              <div class="col-5 fixNoaStupidStuff">

              </div>

            </div> -->

            <div class="row text-center fixNoaStupidStuff">
              <div class="col-3 fixNoaStupidStuff"></div>
              <div class="col-3 fixNoaStupidStuff">
                <span *ngIf="allowUserEditItem">
                  <button class="btn btn-success form-control" id="updateDataBtn" (click)="editStockItemDetails()"
                    *ngIf="newItem!='new'">עדכן מידע
                  </button>
                </span>
              </div>
              <div class="col-3 fixNoaStupidStuff">
                <button class="btn btn-success form-control" id="newCbtn" (click)="clearFields()">Clear</button>
              </div>
              <div class="col-3 fixNoaStupidStuff"></div>
            </div>

          </div>
        </mat-tab>
        <mat-tab label="Item Movements">
          <div class="container modal-inner">

            <div class="row fixNoaStupidStuff text-center p-2">
              <div class="col-1 fixNoaStupidStuff">
                <img class="w-50 h-100" (click)="switchModalView(resCmpt.componentN)"
                  src="../../../../assets/images/refreshData.png">
              </div>
              <div class="col-10 fixNoaStupidStuff text-center">
                <h3 class="text-success">Item Movements</h3>
              </div>
              <div class="col-1 fixNoaStupidStuff">
                <span class="close text-success" id="closeId2"
                  (click)="openModal=false;newItem='';lastOrdersOfItem = []">&times;</span>
              </div>
            </div>

            <div class="row fixNoaStupidStuff text-center">
              <div class="col-4"></div>
              <div class="col-2">
                <label class="form-control"><b>{{lastYearOutAmount}}</b></label>
              </div>
              <div class="col-2">
                <label class="form-control">הוצאות שנה אחרונה</label>
              </div>
              <div class="col-4"></div>
            </div>

            <div class="row fixNoaStupidStuff text-center p-2">
              <div class="col-12 fixNoaStupidStuff">
                <div style="overflow:scroll;height:500px;width:100%">
                  <table class="table table-striped table-hover">
                    <thead class="bg-success text-white">
                      <tr>
                        <th>Amount</th>
                        <th>In Stock</th>
                        <th>Movement Type</th>
                        <th>Date</th>
                        <th>Shelf</th>
                        <th>WhareHouse</th>
                      </tr>
                    </thead>
                    <div class="fixNoaStupidStuff row text-center" *ngIf="itemMovements.length==0">
                      <div class="col-12 text-center">
                        <h4>No Movements for Item.</h4>
                      </div>
                    </div>
                    <tbody>
                      <ng-container *ngFor="let itemMovement of itemMovements">
                        <tr *ngIf="itemMovement.WH_originName != 'Filling'">
                          <td>{{itemMovement.amount}}</td>
                          <td>{{itemMovement.destShelfQntBefore}}</td>
                          <td>{{itemMovement.movementType}}</td>
                          <td>{{itemMovement.movementDate | date: 'dd/MM/yyyy'}}</td>
                          <td>{{itemMovement.shell_position_in_whareHouse_Origin}}</td>
                          <td>{{itemMovement.WH_originName}}</td>
                        </tr>
                      </ng-container>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </mat-tab>

        <!--component-->
        <mat-tab *ngIf="isSuperAdmin" label="Item Purchase History">
          <span class="close text-success" id="closeId2"
            (click)="openModal=false;newItem='';lastOrdersOfItem = []">&times;</span>
          <div class="row">
            <label>Number of orders: </label> &nbsp;
            <input type="text" #numOfOrders />
            <div class="col-1"></div>
            <button (click)="getLastOrdersItem(numOfOrders.value, 'component')">Watch History</button>
          </div>
          <div class="container modal-inner">
            <div class="smallLoader" *ngIf="fetchingOrders"></div>
            <div *ngIf="lastOrdersOfItem.length > 0" class="row fixNoaStupidStuff text-center p-2">
              <div style="overflow:scroll;height:500px;width:100%">
                <h3>Purchase History for Item {{resCmpt.number}}</h3>
                <table class="table table-striped table-hover">
                  <thead class="bg-success text-white">
                    <tr>
                      <th>#</th>
                      <th>Order Number</th>
                      <th>Supplier</th>
                      <th>Status</th>
                      <th>Order Date</th>
                      <th>Arrival Date</th>
                      <th>Arrived Amount</th>
                      <th></th>
                      <th>Ordered Amount</th>
                      <th>Item Price (Foreign)</th>
                      <th>Item Price (NIS)</th>
                    </tr>
                  </thead>
                  <tbody>
                    <ng-container *ngFor="let lastorderitem of lastOrdersOfItem; let i = index">
                      <tr>
                        <td>{{i+1}}</td>
                        <td>{{lastorderitem.orderNumber}}</td>
                        <td>{{lastorderitem.supplierName}}</td>
                        <td>{{lastorderitem.status}}</td>
                        <td>{{lastorderitem.orderDate | date: 'dd/MM/yyyy'}}</td>
                        <td><span *ngIf="lastorderitem.arrivalDate">{{lastorderitem.arrivalDate | date:
                            'dd/MM/yyyy'}}</span></td>
                        <td>{{lastorderitem.arrivedAmount}}</td>
                        <td>/</td>
                        <td>{{lastorderitem.quantity}}</td>
                        <td>{{lastorderitem.price | currency: lastorderitem.coin}}</td>
                        <td>{{lastorderitem.localPrice | currency: 'ILS'}}</td>
                      </tr>
                    </ng-container>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </mat-tab>

        <mat-tab *ngIf="isSuperAdmin" label="Pricing">

          <span class="close text-success" id="closeId2"
            (click)="openModal=false;newItem='';lastOrdersOfItem = []">&times;
          </span>

          <div class="fixNoaStupidStuff" dir="rtl">
            <div class="fixNoaStupidStuff row mt-4">
              <div class="fixNoaStupidStuff col-4">
                <h5>מחיר רכש אחרון</h5>
                <p>{{resCmpt.price | currency: resCmpt.coin}}</p>
              </div>
              <div class="col-4">
                <h5>מחיר ידני</h5>
                <p>{{resCmpt.manualPrice | currency: resCmpt.manualCoin}}</p>
              </div>
              <div class="col-2">
                <button (click)="open(updateManualPrice)">עדכן מחיר ידני</button>
              </div>
            </div>
          </div>

          <div dir="rtl" class="fixNoaStupidStuff row mt-4">
            <h2>היסטוריית מחירים</h2>
          </div>
          <div dir="rtl" class="row fixNoaStupidStuff mt-2">

            <div class="col-3">
              <p>סוגי עדכונים: </p>
            </div>
            <div class="col-3">
              <div class="yellow">עדכון ידני</div>
            </div>
            <div class="col-3">
              <div class="cornflowerblue">עדכון מערכת</div>
            </div>

            <table dir="rtl" class="table table-hover">
              <thead>
                <tr>
                  <th>#</th>
                  <th>תאריך</th>
                  <th>מחיר</th>
                  <th>סיבת עדכון</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let update of resCmpt.priceUpdates.reverse(); let i=index"
                  [style.background]="update.type == 'manual' ? 'yellow' : 'cornflowerblue'">
                  <td>{{i+1}}</td>
                  <td>{{update.date | date:'dd/MM/yy'}}</td>
                  <td>{{update.price | currency: update.coin}}</td>
                  <td *ngIf="update.type == 'manual'">ידני - ע"י {{update.user}}</td>
                  <td *ngIf="update.type == 'auto'">סגירת הזמנת רכש מס' {{update.purchase}}</td>
                  <td *ngIf="update.type == 'datafix'">תיקון מחירים גורף {{update.purchase}}</td>
                </tr>
              </tbody>
            </table>

          </div>

        </mat-tab>

        <mat-tab label="Version History">

          <span class="close text-success" id="closeId2"
            (click)="openModal=false;newItem='';lastOrdersOfItem = []">&times;
          </span>

          <div dir="rtl" class="fixNoaStupidStuff row mt-4">
            <h2>היסטוריית מהדורות לפריט {{resCmpt.componentN}}</h2>
          </div>
          <div dir="rtl" class="row fixNoaStupidStuff mt-2">

            <table dir="rtl" class="table table-hover">
              <thead>
                <tr>
                  <th>מס' מהדורה</th>
                  <th>תאריך העדכון</th>
                  <th>בוצע ע"י..</th>
                  <th>סיבת העדכון</th>
                  <th>תמונה</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let version of resCmpt.versionHistory">
                  <td>{{version.versionNumber}}</td>
                  <td>{{version.date | date:'dd/MM/yy'}}</td>
                  <td>{{version.user}}</td>
                  <td>{{version.description}}</td>
                  <td>
                    <img [src]="version.image" alt="Image not updated..">
                  </td>
                </tr>
              </tbody>
            </table>

          </div>

        </mat-tab>


      </mat-tab-group>
    </div>







    <div *ngIf="openModal==true && stockType=='product'" id="myModal2" class="modal2" style='border:1px; border-radius:5px;z-index: 1;position: fixed; left:185px;top:130px; box-shadow: 0px 0px 39px 8px rgba(0,0,0,0.3); 
    height: 50vh;'>

      <!-- Modal content -->
      <div class="modal-content" style='width:700px; height: 50vh; background: rgb(165, 185, 250);' id='modelC'>
        <div class="modal-header">
          <span class="close" id="closeId2" (click)="openModal=false;newItem='';lastOrdersOfItem = []">&times;</span>
          <!-- <img src="peerpharm.png"  width='140px' align='left'> -->
          <h2 id='div_h3'>{{openModalHeader}}</h2><br>
        </div>
        <div class="modal-body flex-container"
          style="overflow-y:scroll; overflow-x:hidden; height: 500px; padding-left: 0px">
          <div *ngIf="showItemDetails">
            <table id='detailsTable'>
              <tbody id='detailsTbody'>
                <tr style="box-shadow: 0px 0px 0px">
                  <th>מספר פריט</th>
                  <td><input type='text' [(ngModel)]="productToFind">
                    <img (click)="searchProduct()" src="../../../../assets/images/search.png" alt=""
                      style="padding-right: 10px; width: 50px; cursor: pointer;">
                  </td>
                </tr>
                <tr>
                  <th>שם פריט</th>
                  <td>
                    <textarea rows='4' cols='30' [(ngModel)]="resCmpt.componentName" style='width:80%'
                      id='input_componentName'></textarea>
                  </td>
                </tr>
                <tr>
                  <th>סוג פריט</th>
                  <td>
                    <input type="text" [(ngModel)]="resCmpt.componentType">
                  </td>
                </tr>
                <tr>
                  <th>תמונה</th>
                  <td>
                    <img *ngIf="resCmpt.img!=''" [src]="resCmpt.img" style="min-width: 200px;"
                      alt="Item main image please wait ...">
                    <p *ngIf="resCmpt.img==''"><b> -No Image- </b></p>
                  </td>
                </tr>

              </tbody>
            </table>
          </div>

        </div>
        <div class="modal-footer">
          <button class="btn btn-success" id="newCbtn" (click)="writeNewComponent()" *ngIf="newItemBtn=='new'">הקם
            מוצר</button>
        </div>
      </div>

    </div>
















    <div *ngIf="openImgModal==true && currModalImgSrc!=''" id="myImgModal" class="modal2"
      style='border:1px; border-radius:5px;z-index: 1;position: fixed; left:100px;top:130px; box-shadow: 0px 0px 39px 8px rgba(0,0,0,0.3);'>

      <!-- Modal content -->
      <div class="modal-content" style='width:700px' id='modelD'>
        <div class="modal-header">
          <span class="close" id="closeId2"
            (click)="ImgModal=false ; currModalImgSrc=''; lastOrdersOfItem = [] ">&times;</span>
        </div>
        <div class="modal-body" style="overflow-y:scroll; overflow-x:hidden; height: 500px; padding-left: 0px">
          <img [src]="currModalImgSrc" width="100%">
        </div>
        <div class="modal-footer">
        </div>
      </div>

    </div>
















    <!-- ************************************************************************** -->


    <!-- ************************************************************************** -->






    <div style="margin-right:auto !important; " *ngIf="openAmountsModal==true" #invAmounts
      class="container bg-light text-center rounded shadow p-2 fixed-top mx-auto h-75 border border-success modal-inner invAmounts fixNoaStupidStuff">
      <div class="row fixNoaStupidStuff">
        <div class="col-1 fixNoaStupidStuff"></div>
        <div class="col-10 fixNoaStupidStuff">
          <h2 class="text-success">כמויות במלאי - {{resCmpt.componentN}}</h2>
        </div>
        <div class="col-1 fixNoaStupidStuff">
          <i class="fa fa-times text-success" (click)="openAmountsModal = false"></i>
        </div>
      </div>

      <hr class="mt-0 mb-0">

      <div class="row fixNoaStupidStuff">
        <div class="col-12 fixNoaStupidStuff">
          <div *ngIf="itemAmountsWh.length == 0">
            <h4>לא קיים במלאי</h4>
          </div>
          <div class="text-center" *ngFor="let whName of itemAmountsWh">
            <div style="width:210px;zoom:0.9" class="container bg-white shadow fr justify-content-end">
              <h4>{{whName}}</h4>
              <table id='amountsTable' class="table table-hover fr">
                <thead class="text-white bg-success">
                  <tr>
                    <th style="padding:5px">מדף</th>
                    <th style="padding:5px">כמות</th>
                  </tr>
                </thead>
                <tbody id='amountsInWhTbody'>
                  <tr *ngFor="let shelfAmount of itemAmountsData">
                    <td *ngIf="shelfAmount.whName==whName">{{shelfAmount.ps}}</td>
                    <td *ngIf="shelfAmount.whName==whName">{{shelfAmount.sumShelfAmounts | number}}</td>
                    <!-- <td *ngIf="shelfAmount.whName==whName">{{shelfAmount.batchNumArr}}</td> -->
                  </tr>
                </tbody>
              </table>

            </div>
          </div>
        </div>
      </div>

      <hr class="mt-0 mb-0">

      <div dir="rtl" class="row mt-5 w-100">
        <div class="col-3">
          <button [ngClass]="dir == 'in' ? 'btn-success' : 'btn-outline-success'" (click)="dirSet('in')"
            class='btn form-control'>קבלת סחורה</button>
        </div>
        <div class="col-3">
          <button [ngClass]="dir == 'shelfChange' ? 'btn-success' : 'btn-outline-success'"
            (click)="dirSet('shelfChange')" class='btn form-control'>שינוי מדף</button>
        </div>
        <div class="col-3">
          <button [ngClass]="dir == 'out' ? 'btn-success' : 'btn-outline-success'" (click)="dirSet('out')"
            class='btn form-control'>הוצאת סחורה</button>
        </div>
        <div class="col-3"></div>
      </div>

      <div [style.width]="'1094px'" class="m-2 p-4 border border-black" *ngIf="dir=='in'">
        <app-inv-arrivals [itemNumber]="resCmpt.componentN" [allWhareHouses]="whareHouses"></app-inv-arrivals>
      </div>

      <div [style.width]="'1094px'" class="m-2 p-4 border border-primary bg-secondary text-white"
        *ngIf="dir=='shelfChange'">
        <app-shelf-change [itemNumber]="resCmpt.componentN" [allWhareHouses]="whareHouses"></app-shelf-change>
      </div>

      <div [style.width]="'1094px'" class="m-2 p-4 border border-primary bg-warning" *ngIf="dir=='out'">
        <app-checkout [itemNumber]="resCmpt.componentN" [allWhareHouses]="whareHouses"></app-checkout>
      </div>





      <div *ngIf="false" class="row fixNoaStupidStuff">
        <div class="container text-center fr addItemshelf fixNoaStupidStuff">

          <div class="row fixNoaStupidStuff">
            <div class="col-12 fixNoaStupidStuff">
              <h3 class="text-success">שינוי כמויות</h3>
            </div>
          </div>

          <div class="row fixNoaStupidStuff">
            <div class="col-4 fixNoaStupidStuff"></div>
            <div class="col-2 fixNoaStupidStuff">
              <label class="form-control">WhareHouse</label>
            </div>
            <div class="col-2 fixNoaStupidStuff">
              <select class="form-control" *ngIf="stockType=='product'" [(ngModel)]="newItemShelfWH"
                (change)="searchItemShelfs()">
                <option value="" selected>בחר מחסן</option>
                <ng-container *ngFor="let wh of whareHouses;">
                  <option *ngIf="wh.name!='Rosh HaAyin' && wh.name!='Kasem'" [value]="wh._id">{{wh.name}}</option>
                </ng-container>
              </select>

              <select class="form-control" *ngIf="stockType=='component' || stockType=='material'"
                [(ngModel)]="newItemShelfWH" (change)="searchItemShelfs()">
                <option value="" selected>בחר מחסן</option>
                <ng-container *ngFor="let wh of whareHouses;">
                  <option *ngIf="wh.name!='Rosh HaAyin products'" [value]="wh._id">{{wh.name}}</option>
                </ng-container>
              </select>
            </div>
            <div class="col-4 fixNoaStupidStuff"></div>
          </div>


          <div class="row fixNoaStupidStuff justify-content-end">
            <div class="col-12 fixNoaStupidStuff">
              <ul class="nav nav-tabs justify-content-end">
                <!-- <li class="nav-item">
                  <a class="nav-link" style="cursor:pointer;" (click)="dirSet('withdrawForPallet')"
                    [ngStyle]="{'background-color': amountForPalletBtnColor}">הוצאת סחורה למשטח</a>
                </li> -->
                <li class="nav-item">
                  <a class="nav-link" style="cursor:pointer;" (click)="dirSet('shelfChange')"
                    [ngStyle]="{'background-color': sehlfChangeNavBtnColor}">העברת סחורה למדף אחר</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" style="cursor:pointer;" (click)="dirSet('')"
                    [ngStyle]="{'background-color': amountChangeNavBtnColor}">הוצאת/קבלת סחורה</a>
                </li>
              </ul>
            </div>

          </div>

          <div class="row fixNoaStupidStuff justify-content-end" *ngIf="amountChangeDir=='shelfChange'">

            <div class="col-2 fixNoaStupidStuff"></div>
            <div class="col-2 fixNoaStupidStuff">
              <button class="btn btn-success" (click)="updateItemStockShelfChange('shelfChange')">בצע
                העברה</button>
            </div>
            <div class="col-2 fixNoaStupidStuff">
              <input class="form-control" type="text" placeholder="מדף חדש" [(ngModel)]="destShelf" />
            </div>
            <div class="col-2 fixNoaStupidStuff">
              <input class="form-control" type="number" placeholder="כמות" [(ngModel)]="newItemShelfQnt">
            </div>
            <div class="col-2 fixNoaStupidStuff">
              <input class="form-control" type="text" placeholder="מדף נוכחי" [(ngModel)]="newItemShelfPosition" />
            </div>
            <div class="col-2 fixNoaStupidStuff"></div>


          </div>
          <!-- <div class="row fixNoaStupidStuff justify-content-end" *ngIf="amountChangeDir=='withdrawForPallet'">

            <div class="col-2 fixNoaStupidStuff"></div>
            <div class="col-2 fixNoaStupidStuff">
              <button class="btn btn-success" (click)="createNewQAPallet()">הקם
                משטח</button>
            </div>
            <div class="col-2 fixNoaStupidStuff">
              <input list="costumers" class="form-control" type="text" placeholder="לקוח"
                [(ngModel)]="newQApallet.customerName" />
              <datalist id="costumers">
                <option *ngFor="let customer of allCustomers" [value]="customer.costumerName">{{customer.costumerName}}
                </option>
              </datalist>
            </div>
            <div class="col-2 fixNoaStupidStuff">
              <input class="form-control" type="number" placeholder="כמות קומות" [(ngModel)]="newQApallet.floorNumber">
            </div>
            <div class="col-2 fixNoaStupidStuff">
              <input class="form-control" type="number" placeholder="מס' קרטונים"
                [(ngModel)]="newQApallet.kartonQuantity" />
            </div>
            <div class="col-2 fixNoaStupidStuff">
              <input class="form-control" type="text" placeholder="מדף" [(ngModel)]="newQApallet.shelf" />
            </div>
            <div class="col-2 fixNoaStupidStuff">
              <input class="form-control" type="number" placeholder="כמות בקרטון"
                [(ngModel)]="newQApallet.unitsInKarton" />
            </div>
            <div class="col-2 fixNoaStupidStuff">
              <input class="form-control" type="text" placeholder="הזמנה" [(ngModel)]="newQApallet.orderNumber" />
            </div>
            <div class="col-2 fixNoaStupidStuff">
              <input class="form-control" type="number" placeholder="קרטון חלקי"
                [(ngModel)]="newQApallet.unitsQuantityPartKarton" />
            </div>
            <div class="col-2 fixNoaStupidStuff">
              <input class="form-control" type="number" placeholder="קומה אחרונה"
                [(ngModel)]="newQApallet.lastFloorQuantity">
            </div>


          </div> -->

          <div class="fixNoaStupidStuff row justify-content-end" *ngIf="amountChangeDir==''">
            <div class="col-2 fixNoaStupidStuff">
              <button class="form-control btn btn-success" (click)="updateItemStock('in')">קבלת סחורה</button>
              <button class="form-control btn btn-danger" (click)="updateItemStock('out')">הוצאת סחורה</button>
            </div>
            <div class="col-2 fixNoaStupidStuff">
              <input *ngIf="stockType=='component' || stockType =='material'" class="form-control" type="text"
                placeholder="תעודת משלוח" [(ngModel)]="relatedOrderNum" />
            </div>
            <div class="col-2 fixNoaStupidStuff">
              <input class="form-control" type="text" placeholder="מדף" [(ngModel)]="newItemShelfPosition" />
            </div>
            <div class="col-2 fixNoaStupidStuff">
              <input class="form-control" type="number" placeholder="כמות" [(ngModel)]="newItemShelfQnt">
            </div>
            <div class="col-2 fixNoaStupidStuff">
              <select (change)="showBatchExpDate($event)" *ngIf="stockType=='product'" class="form-control" type="text"
                placeholder="אצווה" [(ngModel)]="newItemShelfBatchNumber">
                <option value="" selected>Batch</option>
                <option *ngFor="let batch of ItemBatchArr" [value]="batch.batchNumber">{{batch.batchNumber}}</option>

              </select>
            </div>
            <div class="col-2">

            </div>

            <!-- <div>
              <label>Exp Date: {{expirationBatchDate}}</label>
            </div> -->
          </div>

          <div class="fr row justify-content-end">
            <div class="col-sm-12">
              <label class="fr text-success">הפריט נמצא על המדפים</label>&nbsp;<br>
            </div>
            <ng-container *ngFor="let itemShelf of currItemShelfs">
              <div class="col-sm-3 bg-white rounded border border-success" (click)="loadShelfToInput(itemShelf, $event)"
                style="margin-left:5px; cursor:pointer; padding: 3px; ">
                <span><u>{{itemShelf.position}}</u>: <b>{{itemShelf.amount}}</b> Units </span>&nbsp;<br>
                <span *ngIf="itemShelf.arrivalDate!='undefined' && itemShelf.itemType=='product' ">Batch:
                  {{itemShelf.batchNumber }}</span>&nbsp;<br>
                <span *ngIf="itemShelf.itemType=='material'"><u>Exp Date:</u>: <b>{{itemShelf.expirationDate | date:
                    'dd/MM/yyyy'}}</b> Units </span>&nbsp;<br>
                <span *ngIf="itemShelf.itemType=='material'">Arrival Date: {{itemShelf.arrivalDate | date: 'dd/MM/yyyy'
                  }}</span>&nbsp;<br>
                <!--  <span *ngIf="itemShelf.itemType!='component' && itemShelf.expirationDate!='undefined'">expiration date: {{itemShelf.expirationDate}}</span>&nbsp;       -->
              </div>
            </ng-container>

          </div>

        </div>
      </div>

    </div>





  </div>


  <div class="container bg-light rounded shadow fixed-top mx-auto my-auto border border-success"
    *ngIf="openModal == true && stockType=='material'">
    <mat-tab-group mat-align-tabs="center">
      <mat-tab label="Material Details">
        <div class="container fixNoaStupidStuff p-2 modal-inner">
          <div style="padding: 0rem;" class="row text-center fixNoaStupidStuff">
            <div style="padding: 0rem;" class="col-1 fixNoaStupidStuff text-right">
              <!-- <button class="btn btn-success form-control" (click)="switchModalView()">{{itemmoveBtnTitle}}</button> -->
            </div>
            <div style="padding: 0rem;" class="col-10 fixNoaStupidStuff">
              <h2 style="padding: 0rem;" class="text-success" id='div_h3'>{{openModalHeader}}</h2><br>
            </div>
            <div style="padding: 0rem;" class="col-1 fixNoaStupidStuff">
              <span class="close text-success" id="closeId2"
                (click)="openModal=false;newItem='';lastOrdersOfItem = []">&times;</span>
            </div>
          </div>

          <div dir="rtl" style="padding: 0rem;" class="row text-center fixNoaStupidStuff">
            <div style="padding: 0rem;" class="col-12 fixNoaStupidStuff">
              <h5 style="padding: 0rem;" class="text-success">פרטים כלליים</h5>
            </div>
            <!-- <div class="col-8 fixNoaStupidStuff">
            <h5 class="text-success">מחסן/מחלקת בישול</h5>
          </div> -->

          </div>
          <div style="padding: 0rem;" class="row text-center fixNoaStupidStuff">
            <div class="col-2 fixNoaStupidStuff"><label class="form-control">Item Number</label></div>
            <div class="col-2 fixNoaStupidStuff">
              <input class="form-control" (change)="checkIfExist($event)" [(ngModel)]="resMaterial.componentN">
            </div>
            <div class="col-2 fixNoaStupidStuff"><label class="form-control">Item Name</label></div>
            <div class="col-2 fixNoaStupidStuff">
              <input class="form-control" (change)="checkIfExist($event)" [(ngModel)]="resMaterial.componentName">
            </div>
            <!-- <div class="col-2 fixNoaStupidStuff"><label class="form-control">Last Price (NIS)</label></div>
            <div class="col-2 fixNoaStupidStuff">
              <input class="form-control" [(ngModel)]="resMaterial.price">
            </div>
            <div class="col-2 fixNoaStupidStuff"><label class="form-control">Shipping (NIS)</label></div>
            <div class="col-2 fixNoaStupidStuff">
              <input type="number" class="form-control" [(ngModel)]="resMaterial.shippingPrice">
            </div> -->
            <div class="col-2 fixNoaStupidStuff"><label class="form-control">Last Price (NIS)</label></div>
            <div class="col-2 fixNoaStupidStuff">
              <input type="number" class="form-control" disabled [(ngModel)]="resMaterial.price">
            </div>
          </div>
          <div class="row fixNoaStupidStuff">
            <div class="col-3">
              <label class="form-control">Supplier Item Number</label>
            </div>
            <div class="col-2">
              <input class="form-control" [(ngModel)]="resMaterial.componentNs">
            </div>
          </div>

          <div dir="rtl" style="padding: 0rem;" class="row fixNoaStupidStuff text-center">
            <div class="col-1"></div>
            <div class="col-2 fixNoaStupidStuff">
              <label class="form-control">INCI Name</label>
              <label class="form-control">Month Till Exp</label>
              <label class="form-control">CAS Number</label>
              <label class="form-control">Function</label>
              <label class="form-control">מצב צבירה</label>
              <label style="font-size:13px" class="form-control">חומרים מסוכנים בפירוק</label>
            </div>
            <div class="col-3 fixNoaStupidStuff">
              <input class="form-control" (change)="checkIfInciNameExist($event)" [(ngModel)]="resMaterial.inciName"
                type='text'>
              <input class="form-control" [(ngModel)]="resMaterial.monthTillExp" type="number" />
              <input class="form-control" [(ngModel)]="resMaterial.casNumber" type='text'>
              <input class="form-control" [(ngModel)]="resMaterial.function" type='text'>
              <input list="som" class="form-control" [(ngModel)]="resMaterial.stateOfMatter" type='text'>
              <datalist id="som">
                <option value="liquid">Liquid</option>
                <option value="solid">Solid</option>
                <option value="gell">Gell</option>
              </datalist>
              <input class="form-control" [(ngModel)]="resMaterial.dangerMaterials" type='text'>
            </div>

            <div style="height:210px;overflow-y: scroll;" class="col-5">
              <h4>הרכב</h4>
              <table style="font-size: 15px;">
                <tbody>
                  <tr>
                    <td>
                      <input placeholder="composition" [(ngModel)]="compositionName" class='form-control'>
                    </td>
                    <td>
                      <input placeholder="%" [(ngModel)]="compositionPercentage" class="form-control">
                    </td>
                    <td>
                      <input placeholder="function" [(ngModel)]="compostionFunction" class="form-control">
                    </td>
                    <td>
                      <input placeholder="CAS" [(ngModel)]="compositionCAS" class="form-control">
                    </td>
                    <td>
                      <button class="btn btn-success form-control"><i (click)="addComposition()"
                          class="fa fa-plus"></i></button>
                    </td>
                  </tr>
                  <tr *ngFor="let comp of resMaterial.composition">
                    <td>{{comp.compName}}</td>
                    <td>{{comp.compPercentage}}</td>
                    <td>{{comp.compFunction}}</td>
                    <td>{{comp.compCAS}}</td>
                    <td><i (click)="deleteFromComposition(resMaterial._id,comp.compName)"
                        class="fa fa-times text-danger"></i></td>
                  </tr>
                </tbody>
              </table>
              <!-- <table style="font-size: 9px;" class="table table-hover table-striped">
                <tbody>
                  
                </tbody>
              </table> -->
            </div>

          </div>
          <div class="row fixNoaStupidStuff">
            <div class="col-10 fixNoaStupidStuff">
              <input class="form-control" [(ngModel)]="resMaterial.riskSentence" type='text'>
            </div>
            <div class="col-2 fixNoaStupidStuff">
              <label class="form-control">משפטי סיכון</label>
            </div>
          </div>

          <div class="row fixNoaStupidStuff mt-3">

            <div class="col-2">
              <label class="form-control m-2">COA Master</label>
              <label class="form-control m-2">MSDS</label>
            </div>
            <div class="col-2">
              <button class="btn btn-success form-control m-2" ngbTooltip="Upload COA Master"
                (click)="coaMasterInput.click()"><i class="fa fa-upload" aria-hidden="true"></i></button>
              <button class="btn btn-success form-control m-2" ngbTooltip="Upload MSDS" (click)="msdsInput.click()"><i
                  class="fa fa-upload" aria-hidden="true"></i></button>
            </div>
            <div class="col-1">
              <a [ngbTooltip]="resMaterial.coaMaster ? 'Download COA Master' : 'No COA Master. Upload one.'"
                [href]="resMaterial.coaMaster">
                <img style="height: 30px; width:30px; margin-top: 5px" src="../../../../assets/images/pdf.png"
                  alt="PDF" />
              </a>
              <input class="form-control" #coaMasterInput style="display:none" type="file"
                (change)="uploadCoaMaster($event)">
              <br>
              <a [ngbTooltip]="resMaterial.msds ? 'Download MSDS' : 'No MSDS. Upload one.'" [href]="resMaterial.msds"
                class="mt-2">
                <img style="height: 30px; width:30px; margin-top: 25px" src="../../../../assets/images/pdf.png"
                  alt="PDF" />
              </a>
              <input class="form-control" #msdsInput style="display:none" type="file" (change)="uploadMsds($event)">
            </div>
            <div class="col-2 fixNoaStupidStuff">
              <label class="form-control">Formule Remark</label>
            </div>
            <div class="col-3 fixNoaStupidStuff">
              <input type="text" [(ngModel)]="resMaterial.remarks" class="form-control">
            </div>
          </div>

          <div class="row text-center fixNoaStupidStuff">
            <div class="col-4 fixNoaStupidStuff">
              <button class="btn btn-success form-control" id="newCbtn" (click)="writeNewMaterial()">הקם
                מוצר</button>
            </div>
            <div class="col-4 fixNoaStupidStuff">
              <div *ngIf="allowUserEditItem">
                <button class="btn btn-success form-control" id="updateDataBtn" (click)="editMaterialItemDetails()"
                  *ngIf="newItem!='new'">עדכן
                  מידע</button>
              </div>
            </div>
            <div class="col-4 fixNoaStupidStuff">
              <button class="btn btn-success form-control" id="newCbtn" (click)="clearFields()">Clear</button>
            </div>
          </div>
        </div>
      </mat-tab>
      <mat-tab label="Storage/Cooking">
        <div class="container-fluid modal-inner">
          <div dir="rtl" style="padding: 0rem;" class="row text-center fixNoaStupidStuff">

            <div class="col-4 fixNoaStupidStuff">
              <span class="close" id="closeId2"
                (click)="openModal=false;newItem='';lastOrdersOfItem = []">&times;</span>
            </div>
            <div class="col-4 fixNoaStupidStuff">
              <h5 class="text-success">מחסן/מחלקת בישול</h5>
            </div>
            <div class="col-4 fixNoaStupidStuff">

            </div>

          </div>
          <div dir="rtl" style="padding: 0rem;" class="row fixNoaStupidStuff text-center">

            <div class="col-1"></div>
            <div class="col-2 fixNoaStupidStuff">
              <label class="form-control">קבוצת סיכון</label>
              <label class="form-control">מספר או"מ</label>
              <label class="form-control">קוד חירום</label>
              <label class="form-control">טיפול בחירום</label>
              <label style="font-size: 13px;" class="form-control">כמות מותרת באחסון</label>
              <label class="form-control">היתר רעלים</label>
            </div>
            <div class="col-3 fixNoaStupidStuff">
              <select class="form-control" [(ngModel)]="resMaterial.threatment">

                <option value="flammableLiquid">3 - נוזל דליק</option>
                <option value="flammableSolid">4 - מוצק דליק</option>
                <option value="oxidizer">5.1 - מחמצן אי אורגני</option>
                <option value="toxic">6 - רעיל</option>
                <option value="acid">8 - חומצה</option>
                <option value="base">8 - בסיס</option>
                <option value="otherDangerMaterials">9 - חומרים מסוכנים שונים</option>
                <option value="regular">אין מספר או"מ</option>
                <option value="cooling">איחסון בקירור</option>
                <option value="blockedByType">חסום לפי סוג חומר</option>
              </select>

              <input [(ngModel)]="resMaterial.umNumber" type="text" class="form-control" />
              <input [(ngModel)]="resMaterial.imerCode" type="text" class="form-control" />
              <input [(ngModel)]="resMaterial.imerTreatment" type="text" class="form-control" />
              <input [(ngModel)]="resMaterial.allowQtyInStock" type="text" class="form-control" />
              <input [(ngModel)]="resMaterial.permissionDangerMaterials" type="checkbox" style="width:12px"
                class="form-control" />
            </div>
            <div class="col-2 fixNoaStupidStuff">
              <label class="form-control">מיקום במחסן</label>
              <label class="form-control">כמות במלאי</label>
              <label class="form-control">כמות פג תוקף</label>

              <label class="form-control">טמפ' אחסון</label>
              <label class="form-control">הוראות אחסון</label>

            </div>
            <div class="col-3 fixNoaStupidStuff">
              <input class="form-control" list="locations" [(ngModel)]="resMaterial.location"
                (change)="getAllMaterialLocations($event)" type="text">
              <datalist id="locations">
                <option *ngFor="let material of materialLocations" [value]="material.location">
                  {{material.location}}</option>
              </datalist>

              <input [(ngModel)]="resMaterial.quantityInStock" type="text" class="form-control" />
              <input [(ngModel)]="resMaterial.expiredQty" type="text" class="form-control" />


              <input [(ngModel)]="resMaterial.storageTemp" type="text" class="form-control" />
              <input [(ngModel)]="resMaterial.storageDirections" type="text" class="form-control" />

            </div>
            <div class="col-1"></div>
          </div>

          <div class="row text-center fixNoaStupidStuff">
            <div class="col-4 fixNoaStupidStuff">
              <button class="btn btn-success form-control" id="newCbtn" (click)="writeNewMaterial()">הקם
                מוצר</button>
            </div>
            <div class="col-4 fixNoaStupidStuff">
              <div *ngIf="allowUserEditItem">
                <button class="btn btn-success form-control" id="updateDataBtn" (click)="editMaterialItemDetails()"
                  *ngIf="newItem!='new'">עדכן
                  מידע</button>
              </div>
            </div>
            <div class="col-4 fixNoaStupidStuff">
              <button class="btn btn-success form-control" id="newCbtn" (click)="clearFields()">Clear</button>
            </div>
          </div>

        </div>
      </mat-tab>
      <mat-tab label="Material Suppliers Details">
        <div class="container modal-inner">

          <div style="padding: 0rem;" class="row text-center fixNoaStupidStuff">
            <div class="col-1 fixNoaStupidStuff text-right">
              <!-- <button class="btn btn-success form-control" (click)="switchModalView()">{{itemmoveBtnTitle}}</button> -->
            </div>
            <div class="col-10 fixNoaStupidStuff">
              <h4 class="text-success">ספקים</h4>
            </div>
            <div class="col-1 fixNoaStupidStuff">
              <span class="close text-success" id="closeId2"
                (click)="openModal=false;newItem='';lastOrdersOfItem = []">&times;</span>
            </div>
          </div>

          <h2>הוסף ספק</h2>
          <div dir='rtl' class="row border border-success border-bottom-0 fixNoaStupidStuff text-center">
            <div class="col-1 fixNoaStupidStuff"></div>
            <div class="col-2 fixNoaStupidStuff">
              <label class="form-control">ספק</label>
              <label class="form-control">יצרן</label>
              <label class="form-control">מספר פריט ספק</label>
              <label class="form-control">שם פריט ספק</label>
              <label class="form-control">סוג אריזה</label>

            </div>
            <div class="col-3 fixNoaStupidStuff">

              <!-- <input list="suppliers" class="form-control" [(ngModel)]="supplier.supplierName">
              <datalist id="suppliers">
                <option *ngFor="let supplier of allSuppliers" value="{{supplier.suplierName}}">
                  {{supplier.suplierNumber}}
                </option>
              </datalist> -->

              <input list="suppliers" class="form-control" [(ngModel)]="supplier.supplierName">
              <datalist id="suppliers">
                <option *ngFor="let supplier of allSuppliers" value="{{supplier.suplierName}}">
                  {{supplier.suplierNumber}}</option>
              </datalist>
              <input type="text" class="form-control" [(ngModel)]="supplier.manufacturer">
              <input [(ngModel)]="supplier.alternativeMaterial" class="form-control" type='text'>
              <input [(ngModel)]="supplier.alterName" class="form-control" type='text'>
              <input list="groups" [(ngModel)]="supplier.subGroup" class="form-control">
              <datalist id="groups">
                <option value="Cube">קובייה</option>
                <option value="barrel">חבית</option>
                <option value="small barrel">חביונית</option>
                <option value="packaging/cardboard">אריזות/קרטון</option>
                <option value="plastic barrel">חבית פלסטיק</option>
                <option value="jerrican">ג'ריקן</option>
                <option value="bag">שק</option>
                <option value="bottle barrel">דלי בקבוק</option>
              </datalist>

            </div>
            <div class="col-2 fixNoaStupidStuff">
              <label class="form-control">מחיר</label>
              <label class="form-control">מטבע</label>
              <label class="form-control">מחיר העמסה</label>
              <label class="form-control">מטבע לאחר טעינה</label>
              <label class="form-control">משקל יחידה</label>
              <label class="form-control">יחידת מידה</label>
            </div>
            <div class="col-3 fixNoaStupidStuff">
              <input [(ngModel)]="supplier.price" type="text" class="form-control">
              <input list="coins" [(ngModel)]="supplier.coin" class="form-control">
              <datalist id="coins">
                <option value="USD">USD</option>
                <option value="ILS">ILS</option>
                <option value="GBP">GBP</option>
                <option value="EUR">EUR</option>
                <option value="JPY">JPY</option>
              </datalist>
              <input [(ngModel)]="supplier.priceLoading" type="text" class="form-control" />
              <input list="coinsLoading" [(ngModel)]="supplier.coinLoading" class="form-control">
              <datalist id="coinsLoading">
                <option value="usd">USD</option>
                <option value="ILS">ILS</option>
                <option value="GBP">GBP</option>
                <option value="EUR">EUR</option>
                <option value="JPY">JPY</option>
              </datalist>
              <input [(ngModel)]="supplier.packageWeight" type="text" class="form-control" />
              <input list="measurement" [(ngModel)]="resMaterial.unitOfMeasure" class="form-control">
              <datalist id="measurement">
                <option value="kilogram">קילוגרם</option>
                <option value="pcs">יחידות</option>
                <option value="liter">ליטר</option>
              </datalist>
            </div>
            <div class="col-1 fixNoaStupidStuff"></div>
          </div>

          <div dir='rtl' class="row border border-success border-top-0 text-center fixNoaStupidStuff">
            <div class="col-12">
              <button (click)="addSupplierToMaterial()" class="btn btn-success form-control">הוסף ספק</button>
            </div>
          </div>
          <h2>רשימת ספקים</h2>
          <div dir='rtl' class="row text-center fixNoaStupidStuff">
            <div class="col-12">
              <table class="table table-hover">
                <thead class="bg-success text-white">
                  <tr>
                    <th></th>
                    <th></th>
                    <th>ספק</th>
                    <th>יצרן</th>
                    <th>שם פריט ספק</th>
                    <th>מק"ט ספק</th>
                    <th>מחיר</th>
                    <!-- <th></th> -->
                    <th>מטבע</th>
                    <th>משקל</th>
                    <th>סוג אריזה</th>
                    <!-- <th>זמן הגעה משוער</th> -->
                    <th>מחיר העמסה</th>
                    <!--  <th>מחיר לפני טעינה</th> -->
                    <th></th>
                    <th></th>
                  </tr>
                </thead>
                <tbody>

                  <ng-container *ngFor="let supplier of resMaterial.alternativeSuppliers;let i = index">

                    <tr [ngClass]="mainSupplier(supplier.isMain)">

                      <td>
                        <button *ngIf="!supplier.isMain" (click)="makeAsMainSupplier(i)" class="btn btn-success">הגדר
                          כספק ראשי</button>
                        <span *ngIf="supplier.isMain">ספק ראשי!</span>
                      </td>

                      <td><i class="fa fa-pencil-alt" placement="bottom" ngbTooltip="ערוך פרטי ספק"
                          (click)="edit(i)"></i></td>

                      <td>
                        {{supplier.supplierName}}</td>
                      <!-- <td *ngIf="rowNumber == i">

                        <input [value]="supplier.supplierName" list="suppliers" class="form-control" #supplierName>
                        <datalist id="suppliers">
                          <option *ngFor="let supplier of allSuppliers" value="{{supplier.suplierName}}">
                            {{supplier.suplierName}}</option>
                        </datalist>
                      </td> -->

                      <td *ngIf="rowNumber != i">
                        {{supplier.manufacturer}}</td>
                      <td *ngIf="rowNumber == i">
                        <input type="text" [(ngModel)]="supplier.manufacturer" class="form-control" #manufacturer>
                      </td>

                      <td *ngIf="rowNumber != i">
                        {{supplier.alterName}}</td>
                      <td *ngIf="rowNumber == i">
                        <input type="text" [(ngModel)]="supplier.alterName" class="form-control" #alterName>
                      </td>

                      <td *ngIf="rowNumber != i">
                        {{supplier.alternativeMaterial}}</td>
                      <td *ngIf="rowNumber == i">
                        <input type="text" [(ngModel)]="supplier.alternativeMaterial" class="form-control"
                          #alternativeMaterial>
                      </td>

                      <td *ngIf="rowNumber != i">
                        {{supplier.price}}</td>
                      <td *ngIf="rowNumber == i">
                        <input type="text" [(ngModel)]="supplier.price" class="form-control" #price>
                      </td>

                      <!-- <td><button (click)="getSupplierPriceHistory(i)" (click)="open(supplierPriceHistory)">היסטוריית
                          מחירים</button></td> -->

                      <td *ngIf="rowNumber != i">
                        {{supplier.coin}}</td>
                      <td *ngIf="rowNumber == i">
                        <select [(ngModel)]="supplier.coin" #coin>
                          <option value="ILS">ILS</option>
                          <option value="USD">USD</option>
                          <option value="EUR">EUR</option>
                          <option value="GBP">GBP</option>
                          <option value="JPY">JPY</option>
                        </select>
                        <!-- <input type="text" > -->
                      </td>

                      <td *ngIf="rowNumber != i">
                        {{supplier.packageWeight}}</td>
                      <td *ngIf="rowNumber == i">
                        <input type="text" [(ngModel)]="supplier.packageWeight" class="form-control" #packageWeight>
                      </td>

                      <td *ngIf="rowNumber != i">
                        {{supplier.subGroup}}</td>
                      <td *ngIf="rowNumber == i">
                        <input type="text" [(ngModel)]="supplier.subGroup" class="form-control" #subGroup>
                      </td>
                      <!-- 
                      <td *ngIf="rowNumber != i">
                        {{supplier.expectedArrival}}</td>
                      <td *ngIf="rowNumber == i">
                        <input type="text" [(ngModel)]="supplier.expectedArrival" class="form-control" #expectedArrival>
                      </td> -->

                      <td *ngIf="rowNumber != i">
                        {{supplier.shippingPrice | currency: 'ILS'}}</td>
                      <td *ngIf="rowNumber == i">
                        <input type="number" [(ngModel)]="supplier.shippingPrice" class="form-control" #priceLoading>
                      </td>

                      <!-- <td *ngIf="rowNumber != i">
                        {{supplier.coinLoading}}</td>
                      <td *ngIf="rowNumber == i">
                        <input type="text" [value]="supplier.coinLoading" class="form-control" #coinLoading>
                      </td> -->
                      <td *ngIf="rowNumber == i"><i placement="bottom" ngbTooltip="שמירה" class="fa fa-save"
                          (click)="rowNumber = -1"></i></td>
                      <td><i placement="bottom" ngbTooltip="מחק מרשימת הספקים"
                          (click)="deleteSupplier(i,resMaterial.componentN)" class="fa fa-times text-danger"></i>
                      </td>

                    </tr>

                  </ng-container>

                </tbody>
              </table>
            </div>
          </div>

          <div *ngIf="updateSupplier == true" class="row text-center fixNoaStupidStuff">
            <div class="col-5 fixNoaStupidStuff">

            </div>
            <div class="col-2 fixNoaStupidStuff">
              <button (click)="updateSupplierDetails(true)" class="btn btn-success form-control">שמור</button>
            </div>
            <div class="col-5 fixNoaStupidStuff">

            </div>

          </div>

          <div class="row text-center fixNoaStupidStuff">
            <div class="col-3 fixNoaStupidStuff">

            </div>
            <div class="col-3 fixNoaStupidStuff">
              <div *ngIf="allowUserEditItem">
                <button class="btn btn-success form-control" id="updateDataBtn" (click)="editMaterialItemDetails()"
                  *ngIf="newItem!='new'">עדכן
                  מידע</button>
              </div>
            </div>
            <div class="col-3 fixNoaStupidStuff">
              <button class="btn btn-success form-control" id="newCbtn" (click)="clearFields()">Clear</button>
            </div>
            <div class="col-3 fixNoaStupidStuff">

            </div>
          </div>

        </div>
      </mat-tab>





      <mat-tab *ngIf="isSuperAdmin" label="Pricing">

        <span class="close text-success" id="closeId2"
          (click)="openModal=false;newItem='';lastOrdersOfItem = []">&times;
        </span>

        <div class="fixNoaStupidStuff" dir="rtl">
          <div class="fixNoaStupidStuff row mt-4">
            <div class="fixNoaStupidStuff col-4">
              <h5>מחיר רכש אחרון</h5>
              <p>{{resMaterial.price | currency: resMaterial.coin}}</p>
            </div>
            <div class="col-4">
              <h5>מחיר ידני</h5>
              <p>{{resMaterial.manualPrice | currency: resMaterial.manualCoin}}</p>
            </div>
            <div class="col-2">
              <button (click)="open(updateManualPrice)">עדכן מחיר ידני</button>
            </div>
          </div>
        </div>

        <div dir="rtl" class="fixNoaStupidStuff row mt-4">
          <h2>היסטוריית מחירים</h2>
        </div>
        <div dir="rtl" class="row fixNoaStupidStuff mt-2">

          <div class="col-3">
            <div class="yellow">עדכון ידני</div>
          </div>
          <div class="col-3">
            <div class="cornflowerblue">עדכון מערכת</div>
          </div>

          <table dir="rtl" class="table table-hover">
            <thead>
              <tr>
                <th>#</th>
                <th>תאריך</th>
                <th>מחיר</th>
                <th>סיבת עדכון</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let update of resMaterial.priceUpdates.reverse(); let i=index"
                [style.background]="update.type == 'manual' ? 'yellow' : 'cornflowerblue'">
                <td>{{i+1}}</td>
                <td>{{update.date | date: 'dd/MM/yy'}}</td>
                <td>{{update.price | currency: update.coin}}</td>
                <td *ngIf="update.type == 'manual'">ידני - ע"י {{update.user}}</td>
                <td *ngIf="update.type == 'auto'">הזמנת רכש מס' {{update.purchase}}</td>
                <td *ngIf="update.type == 'datafix'">תיקון מחירים גורף {{update.purchase}}</td>
              </tr>
            </tbody>
          </table>

        </div>

      </mat-tab>




      <mat-tab label="Material Arrivals">
        <div class="container-fluid text-center modal-inner">
          <div class="row fixNoaStupidStuff">
            <div class="col-4 fixNoaStupidStuff"></div>
            <div class="col-4 fixNoaStupidStuff">
              <h3 class="text-success">הגעות חומרי גלם</h3>
            </div>
            <div class="col-4 fixNoaStupidStuff">
              <span class="close text-success" id="closeId2"
                (click)="openModal=false;newItem='';lastOrdersOfItem = []">&times;</span>
            </div>
          </div>

          <div class="row fixNoaStupidStuff">
            <div class="col-12 fixNoaStupidStuff">
              <h5 class="text-danger">Since 01.01.2019 - 01.01.2020 we ordered {{totalQuantity}}</h5>
            </div>
          </div>

          <div class="row fixNoaStupidStuff mt-2">
            <div style="height:500px" class="col-12 fixNoaStupidStuff">
              <table class="table table-hover table-striped">
                <thead class="text-white bg-success">
                  <tr>
                    <th>ספק</th>
                    <th>הזמנה</th>
                    <th>אצווה</th>
                    <th>כמות</th>
                    <th>תאריך תפוגה</th>
                    <th>תאריך הגעה</th>
                    <th>שם חומר</th>
                  </tr>
                </thead>
                <tbody style="overflow-y: scroll;">
                  <tr *ngFor="let arrival of materialArrivals">
                    <td>{{arrival.supplierName}}</td>
                    <td>{{arrival.cmxOrderN}}</td>
                    <td>{{arrival.lotNumber}}</td>
                    <td>{{arrival.totalQnt}}</td>
                    <td>{{arrival.expiryDate | date: 'dd/MM/yyyy'}}</td>
                    <td>{{arrival.arrivalDate | date: 'dd/MM/yyyy'}}</td>
                    <td>{{arrival.materialName}}</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>

        </div>
      </mat-tab>

      <!--material-->
      <mat-tab *ngIf="isSuperAdmin" label="Item Purchase History">
        <span class="close text-success" id="closeId2"
          (click)="openModal=false;newItem='';lastOrdersOfItem = []">&times;</span>
        <div class="row">
          <label>Number of orders: </label> &nbsp;
          <input type="text" #numOfOrders />
          <div class="col-1"></div>
          <button (click)="getLastOrdersItem(numOfOrders.value, 'material')">Watch History</button>
        </div>
        <div class="container modal-inner">
          <div class="smallLoader" *ngIf="fetchingOrders"></div>
          <div *ngIf="lastOrdersOfItem.length > 0" class="row fixNoaStupidStuff text-center p-2">
            <div style="overflow:scroll;height:500px;width:100%">
              <h3>Purchase History for Item {{lastOrdersOfItem[0].number}}</h3>
              <table class="table table-striped table-hover">
                <thead class="bg-success text-white">
                  <tr>
                    <th>#</th>
                    <th>Order Number</th>
                    <th>Supplier</th>
                    <th>Status</th>
                    <th>Order Date</th>
                    <th>Arrival Date</th>
                    <th>Arrived Amount</th>
                    <th></th>
                    <th>Ordered Amount</th>
                    <th>Item Price (Foreign)</th>
                    <th>Item Price (NIS)</th>
                  </tr>
                </thead>
                <tbody>
                  <ng-container *ngFor="let lastorderitem of lastOrdersOfItem; let i = index">
                    <tr>
                      <td>{{i+1}}</td>
                      <td>{{lastorderitem.orderNumber}}</td>
                      <td>{{lastorderitem.supplierName}}</td>
                      <td>{{lastorderitem.status}}</td>
                      <td>{{lastorderitem.orderDate | date: 'dd/MM/yyyy'}}</td>
                      <td><span *ngIf="lastorderitem.arrivalDate">{{lastorderitem.arrivalDate | date:
                          'dd/MM/yyyy'}}</span></td>
                      <td>{{lastorderitem.arrivedAmount}}</td>
                      <td>/</td>
                      <td>{{lastorderitem.quantity}}</td>
                      <td>{{lastorderitem.price | currency: lastorderitem.coin}}</td>
                      <td>{{lastorderitem.localPrice | currency: 'ILS'}}</td>
                    </tr>
                  </ng-container>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </mat-tab>


      <mat-tab label="Purchase Details">
        <div class="row fixNoaStupidStuff text-center modal-inner">
          <div class="col-1 fixNoaStupidStuff ">

          </div>
          <div class="col-10 fixNoaStupidStuff ">
            <h4 class="text-success">רכש</h4>
          </div>
          <div class="col-1 fixNoaStupidStuff ">
            <span class="close text-success" id="closeId2"
              (click)="openModal=false;newItem='';lastOrdersOfItem = []">&times;</span>
          </div>
        </div>
        <div class="row fixNoaStupidStuff text-center">
          <div class="col-12 fixNoaStupidStuff">
            <table class="table table-hover table-striped">
              <thead class="bg-success text-white">
                <tr>
                  <th>Order Number</th>
                  <th>Order Amount</th>
                  <th>Arrival Details</th>

                </tr>
              </thead>
              <tbody>
                <ng-container>
                  <tr *ngFor="let material of materialPurchases">
                    <td>{{material.orderNumber}}</td>
                    <td>{{material.supplierAmount}}</td>

                    <td>
                      <table *ngIf="material.arrivals">
                        <tr *ngFor="let arrival of material.arrivals">
                          <td>Date: {{arrival.arrivalDate | date: 'dd/MM/yyyy'}}</td>
                          <td>Amount: {{arrival.arrivedAmount}}</td>
                        </tr>
                      </table>
                    </td>

                  </tr>
                </ng-container>
              </tbody>
            </table>
          </div>
        </div>
      </mat-tab>



    </mat-tab-group>
  </div>


  <div style="height:0px !important" *ngIf="openOrderAmountsModal==true" id="myModal3" class="modal3"
    style='border:1px; border-radius:5px;z-index: 1;position: fixed; left:400px;top:130px;'>

    <!-- Modal content -->
    <div style="width:800px !important" class="modal-content" id='modelC'>
      <div style="width:800px !important;" id="material-header" class="modal-header">
        <span class="close" id="closeId3" (click)="openOrderAmountsModal=false;">&times;</span>
        <h2 style="text-align: center">{{openModalHeader}}</h2><br>
      </div>
      <div style="height: auto !important;width:800px !important;overflow:scroll" class="container" id="material-body"
        class="modal-body">
        <div class="smallLoader" *ngIf="alloAmountsLoading"></div>
        <table *ngIf="!alloAmountsLoading" style="background:white;" class="table table-hover">
          <thead>
            <tr>
              <th scope="col">#</th>
              <th scope="col">Order Number</th>
              <th scope="col">Order Stage</th>
              <th scope="col">Allocated Amount</th>
              <th scope="col">Order Date</th>
              <th scope="col">Delivery Date</th>
              <th scope="col">Customer</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let order of allocatedOrders;let i=index">
              <td>{{i+1}}</td>
              <td>{{order.orderNumber}}</td>
              <td>{{order.stage}}</td>
              <td>{{order.allocatedAmount}}</td>
              <td>{{order.orderDate}}</td>
              <td>{{order.deliveryDate}}</td>
              <td>{{order.costumer}}</td>
            </tr>
          </tbody>
        </table>

      </div>

    </div>
  </div>

  <div style="height:0px !important" *ngIf="openProductAmountModal==true" id="myModal3" class="modal3"
    style='border:1px; border-radius:5px;z-index: 1;position: fixed; left:400px;top:130px;'>

    <!-- Modal content -->
    <div style="width:800px !important" class="modal-content" id='modelC'>
      <div style="width:800px !important;" id="material-header" class="modal-header">
        <span class="close" id="closeId3" (click)="openProductAmountModal=false;">&times;</span>
        <h2 style="text-align: center">{{openModalHeader}}</h2><br>
      </div>
      <div style="height: auto !important;width:800px !important;overflow:scroll" class="container" id="material-body"
        class="modal-body">
        <table style="background:white;" class="table table-hover">
          <thead>
            <tr>
              <th scope="col">#</th>
              <th scope="col">Orders</th>
              <th scope="col">Allocated Amount</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let order of allocatedProducts;let i=index">
              <td>{{i+1}}</td>
              <td>{{order.orderNumber}}</td>
              <td>{{order.allocatedQuantity}}</td>
            </tr>
          </tbody>
        </table>

      </div>


    </div>
  </div>


  <div *ngIf="newPurchaseRecommendModal"
    class="m-5 border border-info bg-white shadow-lg rounded mx-auto my-auto text-center fixed-top p-5">
    <form [formGroup]="newPurchaseRecommendation" class="modal-inner">
      <div class="row mt-2 fixNoaStupidStuff">
        <div class="col-1 fixNoaStupidStuff"></div>
        <div class="col-3 fixNoaStupidStuff"></div>
        <div class="col-4 fixNoaStupidStuff">
          <h2 class="text-info">בקשת רכש חדשה</h2>
        </div>
        <div class="col-3 fixNoaStupidStuff"></div>
        <div class="col-1 fixNoaStupidStuff">
          <i class="fa fa-times" (click)="newPurchaseRecommendModal = false"></i>
        </div>
      </div>

      <span class="float-left"> * Required field</span>

      <div class="row mt-2 fixNoaStupidStuff">
        <div class="col-3">
          <label class="text-info">Date</label>
          <span class="hot-red float-left">*</span>
          <input formControlName="date" class="form-control rounded-pill" type="date" required>
        </div>
        <div class="col-3">
          <label class="text-info">My Email</label>
          <span class="hot-red float-left">*</span>
          <input formControlName="mail" class="form-control rounded-pill" type="text" required>
        </div>
        <div class="col-5">
          <label class="text-info">Remarks</label>
          <input type="text" formControlName="remarks" placeholder="Remarks" class="form-control rounded-pill">
        </div>
      </div>


      <hr>

      <div class="row mt-2 fixNoaStupidStuff">
        <div class="col-4 fixNoaStupidStuff"></div>
        <div class="col-4 fixNoaStupidStuff">
          <h5>Add Item</h5>
        </div>
        <div class="col-4 fixNoaStupidStuff"></div>
      </div>

      <div class="row mt-1 fixNoaStupidStuff">
        <div class="col-1 fixNoaStupidStuff">
          <span class="hot-red float-left">*</span>
          <label class="text-info">Type</label>
          <select formControlName="type" class="form-control rounded-pill" required>
            <option selected="true" disabled="disabled">Choose Type</option>
            <option value="component">Component</option>
            <option value="material">Material</option>
          </select>
        </div>

        <div class="col-1 fixNoaStupidStuff">
          <span class="hot-red float-left">*</span>
          <label class="text-info">Item Number</label>
          <input (focusout)="getStockItemByNumber($event)" [ngModelOptions]="{standalone: true}"
            [(ngModel)]="recommendStockItem.number" class="form-control rounded-pill" type="text"
            placeholder="StockItem Number" required>
        </div>
        <div [ngModelOptions]="{standalone: true}" class="col-3 fixNoaStupidStuff">
          <span class="hot-red float-left">*</span>
          <label class="text-info">Item Name</label>
          <input [ngModelOptions]="{standalone: true}" [(ngModel)]="recommendStockItem.name"
            class="form-control rounded-pill" type="text" placeholder="StockItem Name" required>
        </div>

        <div class="col-1 fixNoaStupidStuff">
          <span class="hot-red float-left">*</span>
          <label class="text-info">Amount</label>
          <input [ngModelOptions]="{standalone: true}" [(ngModel)]="recommendStockItem.quantity"
            class="form-control rounded-pill" type="number" placeholder="amount" (focusout)="itemAmountsData = []"
            required>
        </div>
        <div class="col-1 fixNoaStupidStuff">
          <span class="hot-red float-left">*</span>
          <label class="text-info">Measurement</label>
          <select [ngModelOptions]="{standalone: true}" [(ngModel)]="recommendStockItem.measurement"
            class="form-control rounded-pill" required>
            <option value="kg">kg</option>
            <option value="liter">liter</option>
            <option value="meter">meter</option>
            <option value="ml">ml</option>
            <option value="unit">Unit</option>
            <option value="ton">טון</option>
            <option value="unit">יחידה</option>
            <option value="box">קופסא</option>
          </select>
        </div>
        <div class="col-1">
          <label class="text-info">Customer Order</label>
          <select [ngModelOptions]="{standalone: true}" [(ngModel)]="recommendStockItem.customerOrder"
            class="form-control rounded-pill" required>
            <option value="stock">Stock</option>
            <option *ngFor="let order of lastCustomerOrders" [value]="order.orderNumber">{{order.orderNumber}}</option>
          </select>
        </div>
      </div>

      <div *ngIf="itemAmountsData && itemAmountsData.length > 0" class="col-12">
        <table id='amountsTable' class="table table-striped">
          <thead>
            <tr>
              <th scope="col">כמות</th>
              <th scope="col">מדף</th>
            </tr>
          </thead>
          <tbody id='amountsInWhTbody'>
            <tr *ngFor="let shelfAmount of itemAmountsData">
              <th scope="row">{{shelfAmount.sumShelfAmounts | number}}</th>
              <th scope="row">{{shelfAmount.ps}}</th>
              <!-- <td *ngIf="shelfAmount.whName==whName">{{shelfAmount.batchNumArr}}</td> -->
            </tr>
          </tbody>
        </table>
      </div>


      <div class="row mt-1 fixNoaStupidStuff">
        <div class="col-4"></div>
        <div class="col-4">
          <button (click)="addStockItemToRecommend()" class="btn btn-info form-control rounded-pill">
            <i class="fa fa-plus"></i>
          </button>
        </div>
        <div class="col-4"></div>
      </div>

      <div id="print-section" class="row mt-2 fixNoaStupidStuff">
        <div class="col-12">
          <table class="table table-hover table-striped">
            <thead>
              <tr>
                <th class="text-info">StockItem Number</th>
                <th class="text-info">StockItem Name</th>
                <th class="text-info">Quantity</th>
                <th class="text-info">Measurement</th>
                <th class="text-info">Customer Order</th>
                <th class="text-info"></th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let stockitem of this.newPurchaseRecommendation.controls.stockitems.value; let i = index">
                <td>{{stockitem.number}}</td>
                <td>{{stockitem.name}}</td>
                <td>{{stockitem.quantity}}</td>
                <td>{{stockitem.measurement}}</td>
                <td>{{stockitem.customerOrder}}</td>
                <td><i placement="bottom" ngbTooltip="Delete Item" (click)="deleteFromRecommendation(i)"
                    class="fa fa-times text-danger"></i></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>


      <div class="row mt-2 fixNoaStupidStuff">
        <div class="col-5 fixNoaStupidStuff"></div>
        <div class="col-2 fixNoaStupidStuff">
          <button (click)="sendRecommandation()" class="btn-success rounded-pill form-control">שלח</button>
        </div>
        <div class="col-2 fixNoaStupidStuff">
          <button printSectionId="print-section" ngxPrint class="btn-success rounded-pill form-control">הדפסה</button>
        </div>
        <div class="col-5 fixNoaStupidStuff"></div>
      </div>
    </form>
  </div>




  <div *ngIf="stockType=='cartons'" class="tableFixHead">
    <table class='table stockTable table-fixed' *ngIf="stockType=='cartons'">
      <thead style="background: rgb(69, 69, 202);z-index: 9999;" class='tableHeader text-white'>
        <tr style="text-align: center;">

          <th></th>
          <th>מספר פריט</th>
          <th>מק"ט פריט ספק</th>
          <th>שם</th>
          <th>כמות</th>
          <th>תמונה</th>
          <th></th>
          <th>צפי הגעה הזמנת רכש</th>
        </tr>

      </thead>


      <tbody id="table_body" class="componentTable">
        <tr *ngFor="let carton of components;let i = index"
          style="box-shadow: inset 1px -1px 2px 0px black; margin-top: 1px;">
          <td>{{i+1}}</td>
          <td>{{carton.componentN}}</td>
          <td>{{carton.componentNs}}</td>
          <td>{{carton.componentName}}</td>
          <td></td>
          <td><img [src]=carton.img></td>
          <td><button (click)="purchaseRecommend(carton)" class="btn-success">המלצה לרכש</button></td>
          <td></td>

        </tr>
      </tbody>
    </table>

  </div>

  <div *ngIf="inventoryNewReqModal == true" style="z-index: 9999;top:50px !important"
    class="fixNoaStupidStuff mx-auto my-auto text-center fixed-top p-4">
    <div class="row">
      <div class="col-10"></div>
      <div class="col-2">
        <i class="fa fa-times text-info" (click)="inventoryNewReqModal = false"></i>
      </div>
    </div>
    <app-inventory-new-request></app-inventory-new-request>
  </div>


  <div *ngIf="invRequestsModal == true"
    style="z-index: 9999;top:0px !important;height: auto;border:2px 2px 2px blue;width: 50%;right:0px !important"
    class="fixNoaStupidStuff border border-info bg-white container fixed-top mx-auto my-auto text-center p-1">
    <app-inventory-requests></app-inventory-requests>
  </div>

  <div *ngIf="itemsMovementModal == true" style="z-index: 9999;top:0px !important;height: auto;border:2px 2px 2px blue;"
    class="fixNoaStupidStuff border border-info bg-white container-fluid fixed-top text-center p-1">

    <div class="row fixNoaStupidStuff">
      <div class="col-12 fixNoaStupidStuff">
        <h1 class="text-info">קבלה / העברת סחורה</h1>
      </div>
    </div>

    <div class="row fixNoaStupidStuff">
      <div class="col-3 fixNoaStupidStuff"></div>
      <div class="col-3 fixNoaStupidStuff">
        <label class="form-control">Type</label>
      </div>
      <div class="col-3 fixNoaStupidStuff">
        <select [(ngModel)]="recieveItemType" class="form-control">
          <option selected="true" disabled="disabled">בחר סוג</option>
          <option value="component">Component</option>
          <option value="material">Material</option>
        </select>
      </div>
      <div class="col-3 fixNoaStupidStuff"></div>
    </div>

    <div *ngIf="recieveItemType == 'material'" class="row fixNoaStupidStuff">
      <app-material-arrival style="width:100%"></app-material-arrival>
    </div>
    <div *ngIf="recieveItemType == 'component'" class="row fixNoaStupidStuff">
      <app-wharehouse style="width:100%"></app-wharehouse>
    </div>

  </div>


  <div *ngIf="customersModal == true" style="z-index: 9999;"
    class="container border border-info fixNoaStupidStuff bg-white shadow-lg rounded mx-auto my-auto text-center fixed-top p-4">
    <div class="row fixNoaStupidStuff">
      <div class="col-4 fixNoaStupidStuff"></div>
      <div class="col-4 fixNoaStupidStuff">
        <h3 class="text-info">רשימת לקוחות</h3>
      </div>
      <div class="col-4 fixNoaStupidStuff">
        <i (click)="customersModal = false;" class="text-info fa fa-times"></i>
      </div>
    </div>

    <div class="row mt-4 fixNoaStupidStuff">
      <div class="col-4 fixNoaStupidStuff"></div>
      <div class="col-4 fixNoaStupidStuff">
        <input list="customers" (change)="addCustomerToPayingList($event)">
        <datalist id="customers">
          <option *ngFor="let customer of allCustomers" [value]="customer.costumerName">{{customer.costumerId}}</option>
        </datalist>


      </div>
      <div class="col-4 fixNoaStupidStuff"></div>
    </div>
  </div>

  <div *ngIf="stockType=='sticker'" class="tableFixHead">
    <table class='table stockTable table-fixed' *ngIf="stockType=='sticker'">
      <thead style="background: rgb(69, 69, 202);z-index: 9999;" class='tableHeader text-white'>
        <tr style="text-align: center;">

          <th></th>
          <th>מספר פריט</th>
          <th>מק"ט פריט ספק</th>
          <th>שם</th>
          <th>כמות</th>
          <th>תמונה</th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th>צפי הגעה הזמנת רכש</th>
        </tr>

      </thead>


      <tbody id="table_body" class="componentTable">
        <tr *ngFor="let sticker of components;let i = index"
          style="box-shadow: inset 1px -1px 2px 0px black; margin-top: 1px;">
          <td>{{i+1}}</td>
          <td>{{sticker.componentN}}</td>
          <td>{{sticker.componentNs}}</td>
          <td>{{sticker.componentName}}</td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td><img [src]=sticker.img></td>
          <td><button (click)="purchaseRecommend(sticker)" class="btn-success">המלצה לרכש</button></td>
          <td></td>

        </tr>
      </tbody>
    </table>

  </div>
</div>

<ng-template #updateManualPrice let-modal>
  <div dir="rtl" class="fixNoaStupidStuff modal-header">
    <h4 class="modal-title" id="modal-basic-title">עדכן מחיר ידני לפריט</h4>
    <button type="button" class="float-left" aria-label="Close" (click)="modal.dismiss('Cross click')">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div dir="rtl" class="fixNoaStupidStuff modal-body">
    <div class="fixNoaStupidStuff row mt-2">
      <div class="col-3">
        <label>מחיר נוכחי:</label>
        <p *ngIf="resMaterial.componentN != ''" class="form-control"> {{resMaterial.manualPrice | currency:
          resMaterial.manualCoin}}</p>
        <p *ngIf="resCmpt.componentN != ''" class="form-control"> {{resCmpt.manualPrice | currency: resCmpt.manualCoin}}
        </p>
        <label>מחיר רכש אחרון:</label>
        <p *ngIf="resMaterial.componentN != ''" class="form-control">{{resMaterial.price | currency: resMaterial.coin}}
        </p>
        <p *ngIf="resCmpt.componentN != ''" class="form-control">{{resCmpt.price | currency: resCmpt.manualCoin}}</p>
      </div>
    </div>

    <div class="fixNoaStupidStuff row mt-2">
      <div class="fixNoaStupidStuff col-3">
        <label>מחיר חדש:</label>
        <input *ngIf="resMaterial.componentN != ''" (keyup)="checkUpdatePriceValidity('m')" class="form-control"
          type="number" [(ngModel)]="resMaterial.manualPrice">
        <input *ngIf="resCmpt.componentN != ''" (keyup)="checkUpdatePriceValidity('c')" class="form-control"
          type="number" [(ngModel)]="resCmpt.manualPrice">
      </div>
      <div class="fixNoaStupidStuff col-3">
        <label>מטבע:</label>
        <select *ngIf="resMaterial.componentN != ''" [(ngModel)]="resMaterial.manualCoin" class="form-control"
          (change)="checkUpdatePriceValidity('m')">
          <option value="ILS">ILS</option>
          <option value="USD">USD</option>
          <option value="EUR">EUR</option>
          <option value="GBP">GBP</option>
        </select>
        <select *ngIf="resCmpt.componentN != ''" [(ngModel)]="resCmpt.manualCoin"
          (change)="checkUpdatePriceValidity('c')" class="form-control">
          <option value="ILS">ILS</option>
          <option value="USD">USD</option>
          <option value="EUR">EUR</option>
          <option value="GBP">GBP</option>
        </select>
      </div>
    </div>
    <div class="fixNoaStupidStuff row mt-2">
      <button *ngIf="resMaterial.componentN != ''" (click)="editMaterialItemDetails()" (click)="addToPriceHistory('m')"
        (click)="modal.dismiss('Cross click')" [disabled]="!allowPriceUpdate" ngbTooltip="יש לעדכן מטבע"
        [style.cursor]="allowPriceUpdate ? 'pointer' : 'not-allowed'">
        שמור
      </button>
      <button *ngIf="resCmpt.componentN != ''" (click)="editStockItemDetails()" (click)="modal.dismiss('Cross click')"
        (click)="addToPriceHistory('c')" [disabled]="!allowPriceUpdate" ngbTooltip="יש לעדכן מטבע"
        [style.cursor]="allowPriceUpdate ? 'pointer' : 'not-allowed'">
        שמור
      </button>
    </div>
  </div>
  <div class="modal-footer">
  </div>
</ng-template>

<ng-template #editVersionDetails let-modal>

  <div dir="rtl" class="fixNoaStupidStuff modal-header">
    <h4 class="modal-title" id="modal-basic-title">שדרוג מהדורה לפריט {{resCmpt.componentN}}</h4>
    <button type="button" class="float-left" aria-label="Close" (click)="modal.dismiss('Cross click')">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div dir="rtl" class="fixNoaStupidStuff modal-body">

    <form [formGroup]="editVersionForm" (ngSubmit)="updateComponentVersion()">
      <div class="fixNoaStupidStuff row mt-2">
        <div class="form-group">
          <label>תאריך</label>
          <input class="form-control" type="date" value="{{ today | date:'yyyy-MM-dd' }}" disabled
            formControlName="date">
        </div>
        <div class="form-group">
          <label>מספר מהדורה</label>
          <input class="form-control" disabled type="number" formControlName="versionNumber">
        </div>
        <br>
        <div class="row form-group">
          <label>תאור השינוי </label>
          <p>(מדוע משדרגים את המהדורה?)</p>
          <textarea class="form-control" formControlName="description" cols="30" rows="10"></textarea>
        </div>
        <div class="form-group">
          <label>העלה תמונה עדכנית</label>
          <img *ngIf="resCmpt.img!=''" [src]="resCmpt.img" style="max-height: 250px;"
            class="hoverImg w-25 h-100 border border-success" alt="Item main image please wait ...">
          <p *ngIf="resCmpt.img==''"><b> -No Image- </b></p>
          <input class="form-control" type='file' id="input_itemImgID" (change)='uploadImg($event)'
            style='display:block'>
          <!-- <input class="form-control" type="file"> -->
        </div>
      </div>

      <div class="fixNoaStupidStuff row mt-2">
        <button type="submit" class="btn btn-primary" (click)="modal.dismiss('Cross click')">
          שדרג מהדורה
        </button>
      </div>
    </form>


  </div>

  <div class="modal-footer">
  </div>

</ng-template>














<ng-template #supplierPriceHistory>


  <div class="fixNoaStupidStuff modal-header">
    <h4 class="modal-title" id="modal-basic-title">היסטוריית מחירים עבור ספק ופריט</h4>
    <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div dir="rtl" class="fixNoaStupidStuff modal-body">

    <table class="table table-hover">

      <thead>
        <tr>
          <th>תאריך</th>
          <th>מס' הזמנת רכש</th>
          <th>מזמין</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let purchase of supPurchases">
          <td></td>
          <td></td>
          <td></td>
        </tr>
      </tbody>

    </table>


  </div>

  <div class="modal-footer">
  </div>

</ng-template>




















<ng-template #printInventoryValue let-modal>
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">Print Component Value For Money</h4>
    <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <table class='table stockTable table-fixed'>
      <thead style="background: rgb(69, 69, 202);z-index: 9999;" class='tableHeader text-white'>
        <tr style="text-align: center;">
          <th>#</th>
          <th>מספר פריט</th>
          <th>מחיר</th>
          <th>כמות במלאי</th>
          <th>ערך</th>
        </tr>
      </thead>
      <tbody id="table_body" class="componentTable">
        <tr style="box-shadow: inset 1px -1px 2px 0px black; margin-top: 1px;"
          *ngFor="let component of components; let i = index; ">
          <ng-container *ngIf="component.itemType == 'component'">
            <td>{{i+1}}</td>
            <td>{{component.componentN}}</td>
            <td>
              <span *ngIf="component.alternativeSuppliers[0]">
                {{ component.alternativeSuppliers[0].price }}
              </span>
              <span *ngIf="component.alternativeSuppliers[1]">
                {{ component.alternativeSuppliers[1].price }}
              </span>
              <span *ngIf="component.alternativeSuppliers[2]">
                {{ component.alternativeSuppliers[2].price }}
              </span>
            </td>
            <td>{{component.amount}}</td>
            <td>
              <span *ngIf="component.alternativeSuppliers[0] && component.alternativeSuppliers[0].price">
                {{component.alternativeSuppliers[0].price*component.amount || 0 }}
              </span>
              <span *ngIf="component.alternativeSuppliers[1] && component.alternativeSuppliers[1].price">
                {{component.alternativeSuppliers[1].price*component.amount || 0 }}
              </span>
              <span *ngIf="component.alternativeSuppliers[2] && component.alternativeSuppliers[2].price">
                {{component.alternativeSuppliers[2].price*component.amount || 0}}
              </span>
            </td>
          </ng-container>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td>סה"כ כללי: {{totalComponentsValue}}</td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="modal-footer">
  </div>
</ng-template>