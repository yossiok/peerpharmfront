<div class="row mt-4">
  <div class="col-3"></div>
  <div class="col-2 text-center">
    <h3 [ngClass]="setColors('title1')" (click)="setFormView('itemDetails')" class="text-center mx-auto p-2">
      Item
      Details</h3>
  </div>

  <div class="col-2 text-center">
    <h3 [ngClass]="setColors('title2')" (click)="setFormView('movements')" class="text-center mx-auto p-2">
      Item Movements</h3>
  </div>

  <div class="col-2 text-center">
    <h3 [ngClass]="setColors('title3')" (click)="setFormView('sales')" class="text-center mx-auto p-2">
      Outgoing
    </h3>
  </div>
  <div class="col-3"></div>
</div>


<!-- Item Details Form-->
<form *ngIf="showDetailsForm" [formGroup]="itemDetailsForm" (ngSubmit)="getItemData()">
  <div class="row border border-success rounded p-4 w-50 form-group mx-auto">
    <div class="col-2">
      <label>
        Enter number,
      </label>
      <input type="text" #itemNumber formControlName="itemNumber" class="form-control">
    </div>
    <div class="col-2">
      <label class="d-block">
        or find by name.
      </label>
      <input class="d-inline form-control" type="text" #name>
      <button class="d-inline" type="button" (click)="getNames(name)">Find</button>
      <select class="form-control" #nameSelect (change)="setItemDetailsNumber($event)">
        <option *ngFor="let itemName of itemNames" [value]="itemName.componentN">{{itemName.componentName}}</option>
      </select>
    </div>
    <div class="col-1">
      <button type="submit" class="btn btn-success">Go.</button>
    </div>
    <div class="col-1">
      <button type="button" class="btn btn-secondary" (click)="item = undefined">Clear</button>
    </div>

  </div>
</form>



<!--Item Movements Form-->

<form *ngIf="showMovementsForm" [formGroup]="itemMovementForm" (ngSubmit)="fetchMovements()">
  <div class="row border border-secondary rounded p-4 w-75 form-group mx-auto">
    <div class="col-1">
      <label>
        item type
      </label>
      <select formControlName="itemType" class="form-control">
        <option value="all">all</option>
        <option value="component">component</option>
        <option value="material">material</option>
        <option value="product">product</option>
      </select>
    </div>
    <div *ngIf="itemMovementForm.value.itemType == 'component'" class="col-2">
      <label>
        component type
      </label>
      <select formControlName="componentType" class="form-control">
        <option value="skip">Filter by Items</option>
        <option value='bottle_Glass'>בקבוק זכוכית</option>
        <option value='bottle_Plastic'>בקבוק פלסטיק</option>
        <option value='jar_Glass'>צנצנת זכוכית</option>
        <option value='jar_Plastic'>צנצנת פלסטיק</option>
        <option value='cap'>פקק</option>
        <option value='cover'>מכסה</option>
        <option value='pump'>משאבה</option>
        <option value='cosmetic_pump'>משאבה קוסמטית</option>
        <option value='over_cap'>מכסה עילי</option>
        <option value='tube'>שפורפרת</option>
        <option value='colons'>קולונים</option>
        <option value='hair_life'>היירלייפ</option>
        <option value='compacts'>קומפקטים</option>
        <option value='personal_package'>אריזות אישיות</option>
        <option value='master_carton'>קרטוני מאסטר</option>
        <option value='newsletter'>עלון לצרכן</option>
        <option value='irosol_valve'>אירוסול- שסתום</option>
        <option value='irosol_bottle'>איירוסול- בקבוק</option>
        <option value='irosol_hectotor'>אירוסול- הקטאטור</option>
        <option value='irosol_bottle'>איירוסול- בקבוק</option>
        <option value='cellophane'>צלופן</option>
        <option value='sticker'>מדבקה</option>
        <option value='sachet'>סאשט</option>
      </select>
    </div>
    <div class="col-2">
      <label>
        item numbers
      </label>
      <ng-container *ngFor="let item of itemMovementForm.value.itemNumbers; let i = index">
        <input (change)="setItemNumber(i, $event)" [value]="itemMovementForm.value.itemNumbers[i]" class="form-control"
          type="text">
        <button type="button" (click)="itemMovementForm.value.itemNumbers.push('')">+</button>
        <button *ngIf="i > 0" type="button" (click)="itemMovementForm.value.itemNumbers.pop()">-</button>
      </ng-container>
    </div>

    <div class="col-2">
      <label>from</label>
      <input formControlName="fromDate" class="form-control" type="date">
    </div>
    <div class="col-2">
      <label>to</label>
      <input formControlName="toDate" class="form-control" type="date">
    </div>
    <div class="col-1">
      <label>
        movement type
      </label>
      <select formControlName="movementType" class="form-control">
        <option value="all">all</option>
        <option value="in">in</option>
        <option value="out">out</option>
        <option value="production">production</option>
        <option value="shelfChange">Shelf Change</option>
      </select>
    </div>
    <div class="col-2">
      <label>
        amounts
      </label>
      <input formControlName="amount" class="form-control" type="number">
      <select formControlName="amountDir" class="form-control">
        <option value="higherThan">Higher than</option>
        <option value="lowerThan">Lower than</option>
      </select>
    </div>
    <div class="col-1">
      <button type="submit" class="btn btn-info">Go.</button>
    </div>
    <div class="col-1">
      <button type="button" class="btn btn-secondary" (click)="resetMovements()">Clear</button>
    </div>
  </div>
</form>


<!--Sold Products-->
<form *ngIf="showSalesForm" [formGroup]="productsSoldForm" (ngSubmit)="fetchProducts">
  <div class="row border border-warning rounded p-4 w-75 form-group mx-auto">
    <!-- <h4 class="text-warning">Coming soon...</h4> -->

    <div class="col-2">
      <label>Product Number</label>
      <input formControlName="productNumber" class="form-control" type="number">
    </div>
    <div class="col-2">
      <label>from</label>
      <input formControlName="fromDate" class="form-control" type="date">
    </div>
    <div class="col-2">
      <label>to</label>
      <input formControlName="toDate" class="form-control" type="date">
    </div>
    <div class="col-2">
      <label>
        amounts
      </label>
      <input formControlName="amount" class="form-control" type="number">
      <select formControlName="amountDir" class="form-control">
        <option value="higherThan">Higher than</option>
        <option value="lowerThan">Lower than</option>
      </select>
    </div>
    <div class="col-1">
      <button type="submit" class="btn btn-warning">Go.</button>
    </div>
    <div class="col-1">
      <button type="button" class="btn btn-secondary" (click)="resetMovements()">Clear</button>
    </div>
  </div>


</form>



<div class="row mt-2"></div>


<!--Item Details-->
<div *ngIf="item" class="bg-light">

  <!--General Details-->
  <div *ngIf="item.itemType!='material'" class="w-50 float-right modal-inner">

    <!--Name-->
    <div class=" row text-center">
      <div class="col-1"></div>
      <div class="col-8">
        <input class="form-control" type="text" [(ngModel)]="item.componentName">
      </div>
      <div class="col-2">
        <label class="form-control">שם פריט</label>
      </div>
      <div class="col-1"></div>
    </div>

    <div dir="rtl" class="row text-center ">
      <div class="col-4 ">
        <h5>פרטי פריט</h5>
      </div>
      <div class="col-4 ">
        <h5>פרטי ספק</h5>
      </div>
      <div class="col-4">
        <h5>פרטי מלאי</h5>
      </div>
    </div>

    <div dir="rtl" class="row text-center">
      <div class="col-2">
        <label class="form-control">מספר פריט</label>
        <label class="form-control">שם קומקס</label>
        <label class="form-control">פריט חלופי</label>
        <label class="form-control">מחיר אחרון (שקלים)</label>
        <label class="form-control">מחיר העמסה (שקלים)</label>
      </div>
      <div class="col-2">
        <input disabled (change)="checkIfItemExist($event)" class="form-control" type='text'
          [(ngModel)]="item.componentN">
        <input class="form-control mt-2" type="text" [(ngModel)]="item.comaxName">
        <input class="form-control mt-2" type="text" [(ngModel)]="item.alternativeComponent">
        <input class="form-control mt-2" type="text" [(ngModel)]="item.price">
        <input class="form-control mt-2" type="number" [(ngModel)]="item.shippingPrice">
      </div>
      <div class="col-2">
        <label class="form-control">מספר ספק</label>
        <label class="form-control">מק"ט ספק</label>
        <label class="form-control">מחיר ספק</label>
      </div>
      <div class="col-2">
        <input class="form-control" list="suppliers" type='text' (change)="fillSupplierDetails()"
          [(ngModel)]="item.suplierN">
        <datalist id="suppliers">
          <option *ngFor="let supplier of allSuppliers" value="{{supplier.suplierName}}">
            {{supplier.suplierNumber}}
          </option>
        </datalist>
        <input class="form-control mt-2" type='text' [(ngModel)]="item.componentNs">
        <input class="form-control mt-2" type='text' [(ngModel)]="item.price">
      </div>
      <div class="col-2">
        <label class="form-control">מלאי מינימום</label>
        <label class="form-control">כמות מינימלית להזמנה</label>
      </div>
      <div class="col-2">
        <input class="form-control" type='number' [(ngModel)]="item.minimumStock">
        <input class="form-control mt-2" type='number' [(ngModel)]="item.minimumPurchaseAmount">
      </div>
    </div>

    <div dir="rtl" class="row text-center">
      <div class="col-4">
        <h5>פרטים נוספים</h5>
      </div>
      <div class="col-4">
        <h5>הערות</h5>
      </div>
      <div class="col-4">
        <h5>תמונה</h5>
      </div>
    </div>

    <div dir="rtl" class="row text-center">

      <div class="col-2">
        <label class="form-control">קטגוריה</label>
        <label class="form-control">קטגוריה 2</label>
        <label class="form-control">קטגוריה 3</label>
        <label class="form-control">חומר</label>
        <label class="form-control">חומר 2</label>
        <label class="form-control">מותג</label>
        <label class="form-control">משקל/סוג</label>
        <label class="form-control">יח' מידה</label>
        <label class="form-control">כמות מל'</label>
        <label class="form-control">על חשבון</label>
        <label class="form-control">רשימת לקוחות</label>
      </div>

      <div class="col-2">
        <select class="form-control" [(ngModel)]="item.componentType">
          <option value=""></option>
          <option *ngFor="let cmptType of cmptTypes2">{{cmptType}}</option>
        </select>

        <select class="form-control mt-2" [(ngModel)]="item.componentType2">
          <option value=""></option>
          <option *ngFor="let cmptType of cmptTypes2">{{cmptType}}</option>
        </select>

        <select class="form-control mt-2" [(ngModel)]="item.componentType3">
          <option value=""></option>
          <option *ngFor="let cmptType of cmptTypes3">{{cmptType}}</option>
        </select>

        <select class="form-control mt-2" [(ngModel)]="item.componentMaterial">
          <option value=""></option>
          <option *ngFor="let cmptMaterial of cmptMaterials">{{cmptMaterial}}</option>
        </select>

        <select class="form-control mt-2" [(ngModel)]="item.componentMaterial2">
          <option value=""></option>
          <option *ngFor="let cmptMaterial of cmptMaterials2">{{cmptMaterial}}</option>
        </select>

        <select class="form-control mt-2" [(ngModel)]="item.componentCategory">
          <option value=""></option>
          <option *ngFor="let cmptCategory of cmptCategoryList">{{cmptCategory}}</option>
        </select>

        <select class="form-control mt-2" [(ngModel)]="item.packageType">
          <option value='paperCarton'>נייר/קרטון</option>
          <option value='drinkCarton'>קרטוניות משקה</option>
          <option value='transperentGlass'>זכוכית שקופה</option>
          <option value='colorGlass'>זכוכית צבעונית</option>
          <option value='pet'>PET</option>
          <option value='hdpe'>HDPE</option>
          <option value='ldpe'>LDPE</option>
          <option value='pp'>PP</option>
          <option value='ps'>PS</option>
          <option value='otherPlastic'>פלסטיק אחר</option>
          <option value='metal'>מתכת</option>
          <option value='wood'>עץ</option>
          <option value='otherMaterial'>חומר אחר</option>
        </select>

        <select class="form-control mt-2" [(ngModel)]="item.measurement">
          <option value="kilogram">kilogram</option>
          <option value="liter">liter</option>
          <option value="meter">meter</option>
          <option value="ml">ml</option>
          <option value="unit">Unit</option>
          <option value="ton">טון</option>
          <option value="unit">יחידה</option>
          <option value="box">קופסא</option>
        </select>

        <input class="form-control mt-2" type="text" [(ngModel)]="item.actualMlCapacity">
        <select class="form-control mt-2" [(ngModel)]="item.whoPays">
          <option value="peerpharm">פארפארם</option>
          <option value="customers">לקוח/לקוחות</option>
        </select>
      </div>

      <div class="col-2">
        <label class="form-control">הערה</label>
        <label class="form-control mt-5">הערה קופצת</label>

        <label class="form-control mt-4"> חומר בעייתי?</label>
        <input type="checkbox" class="problematic" [disabled]="!allowedProblematicEdit" [(ngModel)]="item.isProblematic"
          [ngModelOptions]="{standalone: true}">
        <label class="form-control mt-4">בעייתיות:</label>
        <select class="form-control" [(ngModel)]="item.problem">
          <option value="פג תוקף קצר">פג תוקף קצר</option>
          <option value="פריט ייבוא / זמן אספקה">פריט ייבוא / זמן אספקה</option>
          <option value="כמויות מינימום">כמויות מינימום</option>
          <option value="אחר">אחר</option>
        </select>


      </div>
      <div class="col-2">
        <textarea rows="2" cols="20" class="form-control" type='text' [(ngModel)]="item.remarks"></textarea>
        <textarea rows="2" cols="20" class="form-control mt-4" type='text' [(ngModel)]="item.jumpRemark"></textarea>

      </div>

    </div>

    <!-- <div class="row mt-2">
      <div class="col-2">
        <button [disabled]="gettingProducts" [style.cursor]="gettingProducts ? 'not-allowed' : 'pointer'"
          (click)="getProductsWithItem()">הצג מוצרים שמכילים את הפריט</button>
      </div>

      <div class="col-2 border" *ngIf="item.connectedProducts">
        <div *ngFor="let product of item.connectedProducts">
          <h5>{{product.itemNumber}}</h5>
          <h5>{{product.name}}</h5>
          <h5>{{product.subName}}</h5>
          <h5>{{product.discriptionK}}</h5>
        </div>
      </div>
    </div> -->
  </div>

  <div *ngIf="item.itemType=='material'" class="container float-right p-2 modal-inner">
    <div style="padding: 0rem;" class="row text-center">
      <div style="padding: 0rem;" class="col-1 text-right">
        <!-- <button class="btn btn-success form-control" (click)="switchModalView()">{{itemmoveBtnTitle}}</button> -->
      </div>
      <div style="padding: 0rem;" class="col-10">
        <h2 style="padding: 0rem;" class="text-success" id='div_h3'>{{openModalHeader}}</h2><br>
      </div>
      <div style="padding: 0rem;" class="col-1">
        <span class="close text-success" id="closeId2"
          (click)="openModal=false;newItem='';lastOrdersOfItem = []">&times;</span>
      </div>
    </div>

    <div dir="rtl" style="padding: 0rem;" class="row text-center">
      <div style="padding: 0rem;" class="col-12">
        <h5 style="padding: 0rem;" class="text-success">פרטים כלליים</h5>
      </div>
      <!-- <div class="col-8">
      <h5 class="text-success">מחסן/מחלקת בישול</h5>
    </div> -->

    </div>
    <div style="padding: 0rem;" class="row text-center">
      <div class="col-2"><label class="form-control">Item Number</label></div>
      <div class="col-2">
        <input class="form-control" (change)="checkIfExist($event)" [(ngModel)]="item.componentN">
      </div>
      <div class="col-2"><label class="form-control">Item Name</label></div>
      <div class="col-2">
        <input class="form-control" (change)="checkIfExist($event)" [(ngModel)]="item.componentName">
      </div>
      <!-- <div class="col-2"><label class="form-control">Last Price (NIS)</label></div>
      <div class="col-2">
        <input class="form-control" [(ngModel)]="item.price">
      </div>
      <div class="col-2"><label class="form-control">Shipping (NIS)</label></div>
      <div class="col-2">
        <input type="number" class="form-control" [(ngModel)]="item.shippingPrice">
      </div> -->
      <div class="col-2"><label class="form-control">Last Price (NIS)</label></div>
      <div class="col-2">
        <input type="number" class="form-control" disabled [(ngModel)]="item.price">
      </div>
    </div>
    <div class="row">
      <div class="col-3">
        <label class="form-control">Supplier Item Number</label>
      </div>
      <div class="col-2">
        <input class="form-control" [(ngModel)]="item.componentNs">
      </div>
    </div>

    <div dir="rtl" style="padding: 0rem;" class="row text-center">
      <div class="col-1"></div>
      <div class="col-2">
        <label class="form-control">INCI Name</label>
        <label class="form-control">Month Till Exp</label>
        <label class="form-control">CAS Number</label>
        <label class="form-control">Function</label>
        <label class="form-control">מצב צבירה</label>
        <label style="font-size:13px" class="form-control">חומרים מסוכנים בפירוק</label>
      </div>
      <div class="col-3">
        <input class="form-control" (change)="checkIfInciNameExist($event)" [(ngModel)]="item.inciName" type='text'>
        <input class="form-control" [(ngModel)]="item.monthTillExp" type="number" />
        <input class="form-control" [(ngModel)]="item.casNumber" type='text'>
        <input class="form-control" [(ngModel)]="item.function" type='text'>
        <input list="som" class="form-control" [(ngModel)]="item.stateOfMatter" type='text'>
        <datalist id="som">
          <option value="liquid">Liquid</option>
          <option value="solid">Solid</option>
          <option value="gell">Gell</option>
        </datalist>
        <input class="form-control" [(ngModel)]="item.dangerMaterials" type='text'>
      </div>

      <div class="2">
        <!-- <label class="form-control">COA</label>
      <label class="form-control">MSDS</label>
      <label class="form-control">הערות</label> -->
        <button class="btn btn-success form-control"><i (click)="addComposition()" class="fa fa-plus"></i></button>
        <label class="form-control">הרכב</label>
      </div>
      <div style="height:210px;overflow-y: scroll;" class="col-3">
        <input [(ngModel)]="compositionName" class='form-control'>
        <table style="font-size: 9px;" class="table table-hover table-striped">
          <tbody>
            <tr *ngFor="let comp of item.composition">
              <td>{{comp.compName}}</td>
              <td>{{comp.compPercentage}}</td>
              <td><i (click)="deleteFromComposition(item._id,comp.compName)" class="fa fa-times text-danger"></i>
              </td>

            </tr>
          </tbody>
        </table>
        <!-- <button class="btn btn-success form-control" (click)="coaMasterInput.click()"><i class="fa fa-upload"
            aria-hidden="true"></i></button>
        <button class="btn btn-success form-control" (click)="msdsInput.click()"><i class="fa fa-upload"
            aria-hidden="true"></i></button>

        <textarea [(ngModel)]="item.remarks" class="form-control mt-2" rows="6" cols="20"></textarea> -->

      </div>

      <div class="col-1">
        <input placeholder="%" [(ngModel)]="compositionPercentage" class="form-control">
      </div>
    </div>
    <div class="row">
      <div class="col-10">
        <input class="form-control" [(ngModel)]="item.riskSentence" type='text'>

      </div>
      <div class="col-2">
        <label class="form-control">משפטי סיכון</label>
      </div>
    </div>

    <div class="row mt-3">

      <div class="col-2">
        <label class="form-control">COA Master</label>
        <label class="form-control">MSDS</label>
      </div>
      <div class="col-2">
        <button class="btn btn-success form-control" (click)="coaMasterInput.click()"><i class="fa fa-upload"
            aria-hidden="true"></i></button>
        <button class="btn btn-success form-control" (click)="upload"><i class="fa fa-upload"
            aria-hidden="true"></i></button>
      </div>
      <div class="col-3">

        <img style="height: 30px; width:30px;" src="../../../../assets/images/pdf.png" alt="PDF" />
        <input class="form-control" #coaMasterInput style="display:none" type="file" (change)="uploadCoaMaster($event)">


        <img style="height: 30px; width:30px;" src="../../../../assets/images/pdf.png" alt="PDF" />
        <input class="form-control" #msdsInput style="display:none" type="file" (change)="uploadMsds($event)">
      </div>
      <div class="col-2">
        <label class="form-control">Formule Remark</label>
      </div>
      <div class="col-3">
        <input type="text" [(ngModel)]="item.remarks" class="form-control">
      </div>
    </div>

    <div class="row text-center">
      <div class="col-4">
        <button class="btn btn-success form-control" id="newCbtn" (click)="writeNewMaterial()">הקם
          מוצר</button>
      </div>
      <div class="col-4">
        <div *ngIf="allowUserEditItem">
          <button class="btn btn-success form-control" id="updateDataBtn" (click)="editMaterialItemDetails()"
            *ngIf="newItem!='new'">עדכן
            מידע</button>
        </div>
      </div>
      <div class="col-4">
        <button class="btn btn-success form-control" id="newCbtn" (click)="clearFields()">Clear</button>
      </div>
    </div>
  </div>

  <!--Purchase History-->
  <div class="w-50 modal-inner float-right">

    <div class="row mt-4">
      <h2>Purchase History</h2>
    </div>
    <div class="row mt-4">
    </div>
    <div>
      <div class="smallLoader" *ngIf="fetchingOrders"></div>
      <div *ngIf="lastOrdersOfItem.length > 0" class="row text-center p-2">
        <h3>Purchase History for Item {{item.number}}</h3>
        <table class="table table-striped table-hover">
          <thead class="bg-success text-white">
            <tr>
              <th>#</th>
              <th>Order Number</th>
              <th>Supplier</th>
              <th>Status</th>
              <th>Order Date</th>
              <th>Arrival Date</th>
              <th>Arrived Amount</th>
              <th></th>
              <th>Ordered Amount</th>
              <th>Item Price (Foreign)</th>
              <th>Item Price (NIS)</th>
            </tr>
          </thead>
          <tbody>
            <ng-container *ngFor="let lastorderitem of lastOrdersOfItem; let i = index">
              <tr>
                <td>{{i+1}}</td>
                <td>{{lastorderitem.orderNumber}}</td>
                <td>{{lastorderitem.supplierName}}</td>
                <td>{{lastorderitem.status}}</td>
                <td>{{lastorderitem.orderDate | date: 'dd/MM/yyyy'}}</td>
                <td><span *ngIf="lastorderitem.arrivalDate">{{lastorderitem.arrivalDate | date:
                    'dd/MM/yyyy'}}</span></td>
                <td>{{lastorderitem.arrivedAmount}}</td>
                <td>/</td>
                <td>{{lastorderitem.quantity}}</td>
                <td>{{lastorderitem.price | currency: lastorderitem.coin}}</td>
                <td>{{lastorderitem.localPrice | currency: 'ILS'}}</td>
              </tr>
            </ng-container>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!--Pricing-->
  <div *ngIf="screenPermission < 4" class="float-right w-50 modal-inner-smaller">

    <div class="" dir="rtl">
      <div class=" row mt-4">
        <div class=" col-4">
          <h5>מחיר רכש אחרון</h5>
          <p>{{item.price | currency: item.coin}}</p>
        </div>
        <div class="col-4">
          <h5>מחיר ידני</h5>
          <p>{{item.manualPrice | currency: item.manualCoin}}</p>
        </div>
        <div class="col-2">
          <button (click)="open(updateManualPrice)">עדכן מחיר ידני</button>
        </div>
      </div>
    </div>

    <div dir="rtl" class=" row mt-4">
      <h2>היסטוריית מחירים</h2>
    </div>
    <div dir="rtl" class="row  mt-2">

      <div class="col-3">
        <p>סוגי עדכונים: </p>
      </div>
      <div class="col-3">
        <div class="yellow">עדכון ידני</div>
      </div>
      <div class="col-3">
        <div class="cornflowerblue">עדכון מערכת</div>
      </div>

      <table dir="rtl" class="table table-hover">
        <thead>
          <tr>
            <th>#</th>
            <th>תאריך</th>
            <th>מחיר</th>
            <th>סיבת עדכון</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let update of item.priceUpdates.reverse(); let i=index"
            [style.background]="update.type == 'manual' ? 'yellow' : 'cornflowerblue'">
            <td>{{i+1}}</td>
            <td>{{update.date | date:'dd/MM/yy'}}</td>
            <td>{{update.price | currency: update.coin}}</td>
            <td *ngIf="update.type == 'manual'">ידני - ע"י {{update.user}}</td>
            <td *ngIf="update.type == 'auto'">סגירת הזמנת רכש מס' {{update.purchase}}</td>
          </tr>
        </tbody>
      </table>

    </div>
  </div>

  <!--Storage / Cooking (for materials)-->
  <div *ngIf="item.itemType=='material'" class="float-right modal-inner-smaller w-50">
    <div dir="rtl" style="padding: 0rem;" class="row text-center ">


      <div class="col-4 ">
        <h5 class="text-success">מחסן/מחלקת בישול</h5>
      </div>
      <div class="col-4 ">

      </div>

    </div>
    <div dir="rtl" style="padding: 0rem;" class="row  text-center">

      <div class="col-1"></div>
      <div class="col-2 ">
        <label class="form-control">קבוצת סיכון</label>
        <label class="form-control">מספר או"מ</label>
        <label class="form-control">קוד חירום</label>
        <label class="form-control">טיפול בחירום</label>
        <label style="font-size: 13px;" class="form-control">כמות מותרת באחסון</label>
        <label class="form-control">היתר רעלים</label>
      </div>
      <div class="col-3 ">
        <select class="form-control" [(ngModel)]="resMaterial.threatment">

          <option value="flammableLiquid">3 - נוזל דליק</option>
          <option value="flammableSolid">4 - מוצק דליק</option>
          <option value="oxidizer">5.1 - מחמצן אי אורגני</option>
          <option value="toxic">6 - רעיל</option>
          <option value="acid">8 - חומצה</option>
          <option value="base">8 - בסיס</option>
          <option value="otherDangerMaterials">9 - חומרים מסוכנים שונים</option>
          <option value="regular">אין מספר או"מ</option>
          <option value="cooling">איחסון בקירור</option>
          <option value="blockedByType">חסום לפי סוג חומר</option>
        </select>

        <input [(ngModel)]="item.umNumber" type="text" class="form-control" />
        <input [(ngModel)]="item.imerCode" type="text" class="form-control" />
        <input [(ngModel)]="item.imerTreatment" type="text" class="form-control" />
        <input [(ngModel)]="item.allowQtyInStock" type="text" class="form-control" />
        <input [(ngModel)]="item.permissionDangerMaterials" type="checkbox" style="width:12px" class="form-control" />
      </div>
      <div class="col-2 ">
        <label class="form-control">מיקום במחסן</label>
        <label class="form-control">כמות במלאי</label>
        <label class="form-control">כמות פג תוקף</label>

        <label class="form-control">טמפ' אחסון</label>
        <label class="form-control">הוראות אחסון</label>

      </div>
      <div class="col-3 ">
        <input class="form-control" list="locations" [(ngModel)]="item.location"
          (change)="getAllMaterialLocations($event)" type="text">
        <datalist id="locations">
          <option *ngFor="let material of materialLocations" [value]="material.location">
            {{material.location}}</option>
        </datalist>

        <input [(ngModel)]="item.quantityInStock" type="text" class="form-control" />
        <input [(ngModel)]="item.expiredQty" type="text" class="form-control" />


        <input [(ngModel)]="item.storageTemp" type="text" class="form-control" />
        <input [(ngModel)]="item.storageDirections" type="text" class="form-control" />

      </div>
      <div class="col-1"></div>
    </div>
  </div>

  <div class="row text-center p-5 container mx-auto">
    <!-- <div class="col-4 ">
      <label for="">Choose Item Type</label>
      <select #itemTypeInput name="" id="">
        <option value="">Choose Item Type</option>
        <option value="component">component</option>
        <option value="material">material</option>
        <option value="product">product</option>
      </select>
      <button [disabled]="!itemTypeInput" class="btn btn-success form-control" id="newCbtn"
        (click)="writeNewStockItem()">הקם
        מוצר</button>
    </div> -->
    <div class="col-3"></div>
    <div class="col-3">
      <div *ngIf="allowUserEditItem">
        <button class="btn btn-success form-control h3" id="updateDataBtn" (click)="editMaterialItemDetails()">
          Save Item Details
        </button>
      </div>
    </div>
    <div class="col-3">
      <button class="btn btn-secondary form-control h3" id="newCbtn" (click)="clearFields()">
        Clear All Details
      </button>
    </div>
    <div class="col-3"></div>
  </div>

</div>






<div class="row mt-2">
</div>

<!--Item Movements-->
<div *ngIf="itemMovements" class="row mt-4 w-75 mx-auto">
  <table class="table table-hover">
    <thead class="text-info text-center">
      <tr>
        <th class="click text-center" (click)="sortBy('itemMovements', 'movementDate')">Date</th>
        <th class="click text-center" (click)="sortBy('itemMovements', 'movementType')">movement type</th>
        <th class="click text-center" (click)="sortBy('itemMovements', 'item')">item</th>
        <th></th>
        <th class="click text-center" (click)="sortBy('itemMovements', 'WH_originName')">whare house</th>
        <th class="click text-center" (click)="sortBy('itemMovements', 'amount')">in</th>
        <th class="click text-center" (click)="sortBy('itemMovements', 'amount')">out</th>
        <th class="click text-center" (click)="sortBy('itemMovements', 'amount')">production</th>
        <th class="click text-center" (click)="sortBy('itemMovements', 'amount')">shelf change</th>
        <th class="text-center">user</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let movement of itemMovements">
        <td class="click click-td text-center" (click)="filter('movementDate', movement.movementDate)">
          {{movement.movementDate | date: 'dd/MM/yy'}}
        </td>
        <td class="click click-td text-center" (click)="filter('movementType', movement.movementType)">
          {{movement.movementType}}
        </td>
        <td class="click click-td text-center" (click)="filter('item', movement.item)">
          {{movement.item}}
        </td>
        <td class="click click-td text-center">{{movement.inventory_doc[0].componentName}}</td>
        <td class="click click-td text-center" (click)="filter('WH_originName', movement.WH_originName)">
          {{movement.WH_originName}}
        </td>
        <td class="click click-td text-center" (click)="filter('amount', movement.amount)">
          <span *ngIf="movement.movementType == 'in'">{{movement.amount}}</span>
        </td>
        <td class="click click-td text-center" (click)="filter('amount', movement.amount)">
          <span *ngIf="movement.movementType == 'out'">{{movement.amount}}</span>
        </td>
        <td class="click click-td text-center" (click)="filter('amount', movement.amount)">
          <span *ngIf="movement.movementType == 'production'">{{movement.amount}}</span>
        </td>
        <td class="click click-td text-center" (click)="filter('amount', movement.amount)">
          <span *ngIf="movement.movementType == 'shelfChange'">{{movement.amount}}</span>
        </td>
        <td class="click click-td text-center" (click)="filter('userName', movement.userName)">
          {{movement.userName}}
        </td>
      </tr>
    </tbody>
  </table>
</div>

<!--Products Sold-->
<div>

</div>


<ng-template #updateManualPrice let-modal>
  <div dir="rtl" class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">עדכן מחיר ידני לפריט</h4>
    <button type="button" class="float-left" aria-label="Close" (click)="modal.dismiss('Cross click')">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div dir="rtl" class=" modal-body">
    <div class=" row mt-2">
      <div class="col-3">
        <label>מחיר נוכחי:</label>
        <p class="form-control"> {{item.manualPrice | currency:
          item.manualCoin}}</p>
        <label>מחיר רכש אחרון:</label>
        <p class="form-control">{{resMaterial.price | currency: resMaterial.coin}}
        </p>
        <p *ngIf="resCmpt.componentN != ''" class="form-control">{{resCmpt.price | currency: resCmpt.manualCoin}}</p>
      </div>
    </div>

    <div class=" row mt-2">
      <div class=" col-3">
        <label>מחיר חדש:</label>
        <input (keyup)="checkUpdatePriceValidity()" class="form-control" type="number" [(ngModel)]="item.manualPrice">
      </div>
      <div class=" col-3">
        <label>מטבע:</label>
        <select [(ngModel)]="item.manualCoin" class="form-control" (change)="checkUpdatePriceValidity()">
          <option value="ILS">ILS</option>
          <option value="USD">USD</option>
          <option value="EUR">EUR</option>
          <option value="GBP">GBP</option>
        </select>
      </div>
    </div>
    <div class=" row mt-2">
      <button (click)="editStockItemDetails()" (click)="addToPriceHistory()" (click)="modal.dismiss('Cross click')"
        [disabled]="!allowPriceUpdate" ngbTooltip="יש לעדכן מטבע"
        [style.cursor]="allowPriceUpdate ? 'pointer' : 'not-allowed'">
        שמור
      </button>
    </div>
  </div>
  <div class="modal-footer">
  </div>
</ng-template>